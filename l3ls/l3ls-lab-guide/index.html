
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../overview/">
      
      
        <link rel="next" href="../../cicd-basics/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.38+insiders-4.53.13">
    
    
      
        <title>Lab Guide - Arista CI Workshops</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.fd1ad6e4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CFira+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Fira Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.material.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#initial-deployment-day-0" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Arista CI Workshops" class="md-header__button md-logo" aria-label="Arista CI Workshops" data-md-component="logo">
      
  <img src="../../assets/images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Arista CI Workshops
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab Guide
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/aristanetworks/avd-workshops" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Workshops on GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Arista CI Workshops" class="md-nav__button md-logo" aria-label="Arista CI Workshops" data-md-component="logo">
      
  <img src="../../assets/images/logo.png" alt="logo">

    </a>
    Arista CI Workshops
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aristanetworks/avd-workshops" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Workshops on GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Fundamentals
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Fundamentals
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Git
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vscode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    VS Code
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../jinja-yaml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Jinja/YAML
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ansible/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Ansible
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Arista CI
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Arista CI
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    AVD L2LS
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    AVD L2LS
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../l2ls/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../l2ls/l2ls-lab-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Lab Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    AVD L3LS EVPN/VXLAN
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    AVD L3LS EVPN/VXLAN
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    
  
    Lab Guide
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    
  
    Lab Guide
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#avd-lab-guide-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        AVD Lab Guide Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-prepare-lab-environment" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1 - Prepare Lab Environment
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-build-and-deploy-dual-data-center-l3ls-network" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2 - Build and Deploy Dual Data Center L3LS Network
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-site-1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3 - Site 1
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-site-2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4 - Site 2
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-connect-sites-to-dci-network" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 5 - Connect Sites to DCI Network
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-enable-evpn-gateway-functionality" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 6 - Enable EVPN Gateway Functionality
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#final-fabric-test" class="md-nav__link">
    <span class="md-ellipsis">
      
        Final Fabric Test
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cicd-basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    CI/CD Basics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Automated Network Validation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Automated Network Validation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../validation/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../validation/anta_validate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    ANTA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../validation/avd_validate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    AVD Validate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#avd-lab-guide-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        AVD Lab Guide Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-prepare-lab-environment" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1 - Prepare Lab Environment
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-build-and-deploy-dual-data-center-l3ls-network" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2 - Build and Deploy Dual Data Center L3LS Network
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-site-1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3 - Site 1
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-site-2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4 - Site 2
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-connect-sites-to-dci-network" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 5 - Connect Sites to DCI Network
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-enable-evpn-gateway-functionality" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 6 - Enable EVPN Gateway Functionality
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#final-fabric-test" class="md-nav__link">
    <span class="md-ellipsis">
      
        Final Fabric Test
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/aristanetworks/avd-workshops/blob/main/workshops/l3ls/l3ls-lab-guide.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="initial-deployment-day-0"><strong>Initial Deployment - Day 0</strong><a class="headerlink" href="#initial-deployment-day-0" title="Permanent link">&para;</a></h1>
<h2 id="avd-lab-guide-overview">AVD Lab Guide Overview<a class="headerlink" href="#avd-lab-guide-overview" title="Permanent link">&para;</a></h2>
<p>The AVD Lab Guide is a follow-along set of instructions to deploy a dual data center L3LS EVPN VXLAN fabric design. The data model overview and details can be found <a href="../overview/">here</a>. In the following steps, we will explore updating the data models to add services, ports, and DCI links to our fabrics and test traffic between sites.</p>
<p>In this example, the ATD lab is used to create the L3LS Dual Data Center topology below. The DCI Network cloud (orange area) is pre-provisioned and is comprised of the core nodes in the ATD topology. Our focus will be creating the L3LS AVD data models to build and deploy configurations for Site 1 and Site 2 (blue areas) and connect them to the DCI Network.</p>
<p><a class="glightbox" href="../../assets/images/l3ls_dualdc_topo.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Dual DC Topology" src="../../assets/images/l3ls_dualdc_topo.png" /></a></p>
<h3 id="host-addresses">Host Addresses<a class="headerlink" href="#host-addresses" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th style="text-align: center;">Host</th>
<th style="text-align: center;">IP Address</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">s1-host1</td>
<td style="text-align: center;">10.10.10.100</td>
</tr>
<tr>
<td style="text-align: center;">s1-host2</td>
<td style="text-align: center;">10.20.20.100</td>
</tr>
<tr>
<td style="text-align: center;">s2-host1</td>
<td style="text-align: center;">10.10.10.200</td>
</tr>
<tr>
<td style="text-align: center;">s2-host2</td>
<td style="text-align: center;">10.20.20.200</td>
</tr>
</tbody>
</table>
<h2 id="step-1-prepare-lab-environment"><strong>Step 1 - Prepare Lab Environment</strong><a class="headerlink" href="#step-1-prepare-lab-environment" title="Permanent link">&para;</a></h2>
<h3 id="access-the-atd-lab">Access the ATD Lab<a class="headerlink" href="#access-the-atd-lab" title="Permanent link">&para;</a></h3>
<p>Connect to your ATD Lab and start the Programmability IDE. Next, create a new Terminal.</p>
<h3 id="fork-and-clone-branch-to-atd-lab">Fork and Clone branch to ATD Lab<a class="headerlink" href="#fork-and-clone-branch-to-atd-lab" title="Permanent link">&para;</a></h3>
<p>An ATD Dual Data Center L3LS data model is posted on <a href="https://github.com/aristanetworks/ci-workshops-avd">GitHub</a>.</p>
<ul>
<li>Fork this <strong><a href="https://github.com/aristanetworks/ci-workshops-avd">repository</a></strong> to your own GitHub account.</li>
<li>Next, clone your forked repo to your ATD lab instance.</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">cd</span><span class="w"> </span>/home/coder/project/labfiles
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>git<span class="w"> </span>clone<span class="w"> </span>&lt;your<span class="w"> </span>copied<span class="w"> </span>URL&gt;
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nb">cd</span><span class="w"> </span>ci-workshops-avd
</code></pre></div>
<p>Configure your global Git settings.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>user.name<span class="w"> </span><span class="s2">&quot;FirstName LastName&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>user.email<span class="w"> </span><span class="s2">&quot;name@example.com&quot;</span>
</code></pre></div>
<h3 id="update-avd">Update AVD<a class="headerlink" href="#update-avd" title="Permanent link">&para;</a></h3>
<p>AVD has been pre-installed in your lab environment. However, it may be on an older version (in some cases a newer version). The following steps will update AVD and modules to the valid versions for the lab.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>pip3<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>global.break-system-packages<span class="w"> </span><span class="nb">true</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>pip3<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>global.disable-pip-version-check<span class="w"> </span><span class="nb">true</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>pip3<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;pyavd[ansible-collection]==4.10.0&quot;</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>ansible-galaxy<span class="w"> </span>collection<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.yml
</code></pre></div>
<details class="warning" open="open">
<summary>Important</summary>
<p>You must run these commands when you start your lab or a new shell (terminal).</p>
</details>
<h3 id="change-to-lab-working-directory">Change To Lab Working Directory<a class="headerlink" href="#change-to-lab-working-directory" title="Permanent link">&para;</a></h3>
<p>Now that AVD is updated, lets move into the appropriate directory so we can access the files necessary for this L3LS Lab!</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nb">cd</span><span class="w"> </span>labs/L3LS_EVPN
</code></pre></div>
<h3 id="setup-lab-password-environment-variable">Setup Lab Password Environment Variable<a class="headerlink" href="#setup-lab-password-environment-variable" title="Permanent link">&para;</a></h3>
<p>Each lab comes with a unique password. We set an environment variable called <code>LABPASSPHRASE</code> with the following command. The variable is later used to generate local user passwords and connect to our switches to push configs.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">LABPASSPHRASE</span><span class="o">=</span><span class="sb">`</span>cat<span class="w"> </span>/home/coder/.config/code-server/config.yaml<span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;password:&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $2}&#39;</span><span class="sb">`</span>
</code></pre></div>
<p>You can view the password is set. This is the same password displayed when you click the link to access your lab.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nb">echo</span><span class="w"> </span><span class="nv">$LABPASSPHRASE</span>
</code></pre></div>
<details class="warning" open="open">
<summary>IMPORTANT</summary>
<p>You must run this step when you start your lab or a new shell (terminal).</p>
</details>
<h3 id="prepare-dci-network-and-test-hosts">Prepare DCI Network and Test Hosts<a class="headerlink" href="#prepare-dci-network-and-test-hosts" title="Permanent link">&para;</a></h3>
<p>The last step in preparing your lab is to push pre-defined configurations to the DCI Network (cloud) and the four hosts used to test traffic. The border leafs from each site will connect to their specified peer with P2P links. The hosts (two per site) have port-channels to the leaf pairs and are pre-configured with an IP address and route to reach the other hosts.</p>
<p>Run the following to push the configs.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>make<span class="w"> </span>preplab
</code></pre></div>
<h2 id="step-2-build-and-deploy-dual-data-center-l3ls-network"><strong>Step 2 - Build and Deploy Dual Data Center L3LS Network</strong><a class="headerlink" href="#step-2-build-and-deploy-dual-data-center-l3ls-network" title="Permanent link">&para;</a></h2>
<p>This section will review and update the existing L3LS data model. We will add features to enable VLANs, SVIs, connected endpoints, and P2P links to the DCI Network. After the lab, you will have enabled an L3LS EVPN VXLAN dual data center network through automation with AVD. YAML data models and Ansible playbooks will be used to generate EOS CLI configurations and deploy them to each site. We will start by focusing on building out Site 1 and then repeat similar steps for Site 2. Then, we will enable connectivity to the DCI Network to allow traffic to pass between sites.  Finally, we will enable EVPN gateway functionality on the border leafs.</p>
<h3 id="summary-of-steps"><strong>Summary of Steps</strong><a class="headerlink" href="#summary-of-steps" title="Permanent link">&para;</a></h3>
<ol>
<li>Build and Deploy <code>Site 1</code></li>
<li>Build and Deploy <code>Site 2</code></li>
<li>Connect sites to DCI Network</li>
<li>Verify routing</li>
<li>Enable EVPN gateway functionality</li>
<li>Test traffic</li>
</ol>
<h2 id="step-3-site-1"><strong>Step 3 - Site 1</strong><a class="headerlink" href="#step-3-site-1" title="Permanent link">&para;</a></h2>
<h3 id="build-and-deploy-initial-fabric">Build and Deploy Initial Fabric<a class="headerlink" href="#build-and-deploy-initial-fabric" title="Permanent link">&para;</a></h3>
<p>The initial fabric data model key/value pairs have been pre-populated in the following group_vars files in the <code>sites/site_1/group_vars/</code> directory.</p>
<ul>
<li>SITE1_CONNECTED_ENDPOINTS.yml</li>
<li>SITE1_NETWORK_SERVICES.yml</li>
<li>SITE1_FABRIC.yml</li>
<li>SITE1_LEAFS.yml</li>
<li>SITE1_SPINES.yml</li>
</ul>
<p>Review these files to understand how they relate to the topology above.</p>
<p>At this point, we can build and deploy our initial configurations to the topology.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>make<span class="w"> </span>build-site-1
</code></pre></div>
<p>AVD creates a separate markdown and EOS configuration file per switch. In addition, you can review the files in the <code>documentation</code> and <code>intended</code> folders per site.</p>
<p><a class="glightbox" href="../../assets/images/docs-configs.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Docs and Configs" src="../../assets/images/docs-configs.png" style="width:300px" /></a></p>
<p>Now, deploy the configurations to Site 1 switches.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>make<span class="w"> </span>deploy-site-1
</code></pre></div>
<h4 id="verification">Verification<a class="headerlink" href="#verification" title="Permanent link">&para;</a></h4>
<p>Now, lets login to some switches to verify the current configs (<code>show run</code>) match the ones created in <code>intended/configs</code> folder. We can also check the current state for MLAG, interfaces, BGP peerings for IPv4 underlay, and BGP EVPN overlay peerings.</p>
<p>These outputs were taken from <code>s1-leaf1</code>:</p>
<ol>
<li>
<p>Check MLAG status.</p>
<p><ins>Command</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>show<span class="w"> </span>mlag
</code></pre></div>
<p><ins>Expected Output</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>s1-leaf1#sho mlag
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>MLAG Configuration:
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>domain-id                          :            S1_RACK1
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>local-interface                    :            Vlan4094
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>peer-address                       :          10.251.1.1
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>peer-link                          :       Port-Channel1
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>hb-peer-address                    :             0.0.0.0
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>peer-config                        :          consistent
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>MLAG Status:
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>state                              :              Active
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>negotiation status                 :           Connected
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>peer-link status                   :                  Up
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>local-int status                   :                  Up
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a>system-id                          :   02:1c:73:c0:c6:12
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>dual-primary detection             :            Disabled
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>dual-primary interface errdisabled :               False
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a>
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a>MLAG Ports:
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a>Disabled                           :                   0
<a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a>Configured                         :                   0
<a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a>Inactive                           :                   0
<a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a>Active-partial                     :                   0
<a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a>Active-full                        :                   0
</code></pre></div>
</li>
<li>
<p>Check routed interface configurations.</p>
<p><ins>Command</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>show<span class="w"> </span>ip<span class="w"> </span>interface<span class="w"> </span>brief
</code></pre></div>
<p><ins>Expected Output</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>s1-leaf1#show ip interface brief
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>                                                                                Address
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>Interface         IP Address            Status       Protocol            MTU    Owner
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>----------------- --------------------- ------------ -------------- ----------- -------
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>Ethernet2         172.16.1.1/31         up           up                 1500
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>Ethernet3         172.16.1.3/31         up           up                 1500
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>Loopback0         10.250.1.3/32         up           up                65535
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>Loopback1         10.255.1.3/32         up           up                65535
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>Management0       192.168.0.12/24       up           up                 1500
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>Vlan4093          10.252.1.0/31         up           up                 1500
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>Vlan4094          10.251.1.0/31         up           up                 1500
</code></pre></div>
</li>
<li>
<p>Check eBGP/iBGP peerings for IPv4 underlay routing.</p>
<p><ins>Commands</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>show<span class="w"> </span>ip<span class="w"> </span>bgp<span class="w"> </span>summary
</code></pre></div>
<p><ins>Expected Output</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>s1-leaf1#show ip bgp summary
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>BGP summary information for VRF default
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>Router identifier 10.250.1.3, local AS number 65101
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>Neighbor Status Codes: m - Under maintenance
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>  Description              Neighbor   V AS           MsgRcvd   MsgSent  InQ OutQ  Up/Down State   PfxRcd PfxAcc
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>  s1-leaf2                 10.252.1.1 4 65101             15        14    0    0 00:02:29 Estab   10     10
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>  s1-spine1_Ethernet2      172.16.1.0 4 65100             13        18    0    0 00:02:30 Estab   7      7
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>  s1-spine2_Ethernet2      172.16.1.2 4 65100             15        14    0    0 00:02:29 Estab   7      7
</code></pre></div>
</li>
<li>
<p>Check eBGP/iBGP peerings for the EVPN overlay.</p>
<p><ins>Commands</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>show<span class="w"> </span>bgp<span class="w"> </span>evpn<span class="w"> </span>summary
</code></pre></div>
<p><ins>Expected Output</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>s1-leaf1#show ip bgp summary
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>BGP summary information for VRF default
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>Router identifier 10.250.1.3, local AS number 65101
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>Neighbor Status Codes: m - Under maintenance
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>  Description              Neighbor   V AS           MsgRcvd   MsgSent  InQ OutQ  Up/Down State   PfxRcd PfxAcc
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>  s1-leaf2                 10.252.1.1 4 65101             15        14    0    0 00:02:29 Estab   10     10
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>  s1-spine1_Ethernet2      172.16.1.0 4 65100             13        18    0    0 00:02:30 Estab   7      7
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>  s1-spine2_Ethernet2      172.16.1.2 4 65100             15        14    0    0 00:02:29 Estab   7      7
</code></pre></div>
</li>
</ol>
<details class="success" open="open">
<summary>Base Fabric Built</summary>
<p>The basic fabric with MLAG peers, P2P routed links between leaf and spines, eBGP/iBGP IPv4 underlay peerings, and eBGP/iBGP EVPN overlay peerings is now created. Next up, we will add VLAN and SVI services to the fabric.</p>
</details>
<h3 id="add-services-to-the-fabric">Add Services to the Fabric<a class="headerlink" href="#add-services-to-the-fabric" title="Permanent link">&para;</a></h3>
<p>The next step is to add Vlans and SVIs to the fabric. The services data model file <code>SITE1_NETWORK_SERVICES.yml</code> is pre-populated with Vlans and SVIs <code>10</code> and <code>20</code> in the <strong>OVERLAY</strong> VRF.</p>
<p>Open <code>SITE1_NETWORK_SERVICES.yml</code> and uncomment lines 1-16, then run the build &amp; deploy process again.</p>
<details class="tip" open="open">
<summary>Tip</summary>
<p><img alt="✍" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/270d.svg" title=":writing_hand:" /> In VS Code, you can toggle comments on/off by selecting the text and pressing <strong><em>windows</em></strong> <span class="keys"><kbd class="key-control">Ctrl</kbd></span> + <span class="keys"><kbd class="key-slash">/</kbd></span> or <strong><em>mac</em></strong> <span class="keys"><kbd class="key-command">Cmd</kbd></span> + <span class="keys"><kbd class="key-slash">/</kbd></span>.</p>
</details>
<p><ins>Build the Configs</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>make build-site-1
</code></pre></div>
<p><ins>Deploy the Configs</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>make deploy-site-1
</code></pre></div>
<h4 id="verification_1">Verification<a class="headerlink" href="#verification_1" title="Permanent link">&para;</a></h4>
<p>Now lets go back to node <code>s1-leaf1</code> and verify the new SVIs exist, their IP addresses, any changes to the EVPN overlay and corresponding VXLAN configurations, as well as the EVPN control-plane now that we have some layer 3 data interfaces.</p>
<ol>
<li>
<p>Verify VLAN SVIs <strong>10</strong> and <strong>20</strong> exist.</p>
<p><ins>Command</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>show ip interface brief
</code></pre></div>
<p><ins>Expected Output</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>s1-leaf1#show ip interface brief
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>                                                                            Address
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>Interface         IP Address            Status       Protocol            MTU    Owner
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>----------------- --------------------- ------------ -------------- ----------- -------
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>Ethernet2         172.16.1.1/31         up           up                 1500
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>Ethernet3         172.16.1.3/31         up           up                 1500
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>Loopback0         10.250.1.3/32         up           up                65535
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>Loopback1         10.255.1.3/32         up           up                65535
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>Management0       192.168.0.12/24       up           up                 1500
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a>Vlan10            10.10.10.1/24         up           up                 1500
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a>Vlan20            10.20.20.1/24         up           up                 1500
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a>Vlan1199          unassigned            up           up                 9164
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a>Vlan3009          10.252.1.0/31         up           up                 1500
<a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a>Vlan4093          10.252.1.0/31         up           up                 1500
<a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a>Vlan4094          10.251.1.0/31         up           up                 1500
</code></pre></div>
<details class="abstract" open="open">
<summary>Where did those VLANs come from?</summary>
<p>You should notice some VLANs that we didn't define anywhere in the <code>_NETWORK_SERVICES.yml</code> data model which aren't related to <strong>MLAG</strong>.  Specifically, these will be VLAN SVIs <strong><em>Vlan1199</em></strong> and <strong><em>Vlan3009</em></strong>.</p>
<p><strong><em>Vlan1199</em></strong> is dynamically created and assigned for the <strong>OVERLAY</strong> vrf to VNI mapping under the VXLAN interface.  You can verify this by looking at the <strong>show interface vxlan 1</strong> output.  Remember, we defined <strong>VNI 10</strong> as the <code>vrf_vni</code> in our data model.
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>Dynamic VLAN to VNI mapping for &#39;evpn&#39; is
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>[1199, 10]
</code></pre></div></p>
<p><strong><em>Vlan3009</em></strong> was also auto-configured by AVD for an iBGP peering between <code>s1-leaf1</code> and <code>s1-leaf2</code> in the <strong>OVERLAY</strong> vrf.  You can verify this by looking at the interface configuration, and BGP peering for that vrf.</p>
<p><strong>Interface Configuration</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>s1-leaf1#show run interface vlan 3009
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>interface Vlan3009
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>  description MLAG_PEER_L3_iBGP: vrf OVERLAY
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>  mtu 1500
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>  vrf OVERLAY
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>  ip address 10.252.1.0/31
</code></pre></div></p>
<p><strong>Overlay vrf BGP Peering</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>s1-leaf1#show ip bgp summary vrf OVERLAY
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>BGP summary information for VRF OVERLAY
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>Router identifier 10.250.1.3, local AS number 65101
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>Neighbor Status Codes: m - Under maintenance
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>  Description              Neighbor   V AS           MsgRcvd   MsgSent  InQ OutQ  Up/Down State   PfxRcd PfxAcc
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>  s1-leaf2                 10.252.1.1 4 65101             19        20    0    0 00:11:30 Estab   5      5
</code></pre></div></p>
</details>
</li>
<li>
<p>Verify VLANs <strong>10</strong> and <strong>20</strong>, and vrf <strong>OVERLAY</strong> are now mapped to the appropriate VNIs under the <code>vxlan1</code> interface.</p>
<p><ins>Command</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>show run interface vxlan 1
</code></pre></div>
<p><ins>Expected Output</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>s1-leaf1#sho run int vxlan 1
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>interface Vxlan1
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>  description s1-leaf1_VTEP
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>  vxlan source-interface Loopback1
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>  vxlan virtual-router encapsulation mac-address mlag-system-id
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>  vxlan udp-port 4789
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="hll">  vxlan vlan 10 vni 10010
</span><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="hll">  vxlan vlan 20 vni 10020
</span><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="hll">  vxlan vrf OVERLAY vni 10
</span></code></pre></div>
</li>
<li>
<p>Verify we are flooding to the correct remote VTEPs based on what we have learned across the EVPN overlay.</p>
<p><ins>Command</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>show interface vxlan1
</code></pre></div>
<p><ins>Expected Output</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>s1-leaf1#sho int vxlan 1
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>Vxlan1 is up, line protocol is up (connected)
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>  Hardware is Vxlan
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>  Description: s1-leaf1_VTEP
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>  Source interface is Loopback1 and is active with 10.255.1.3
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>  Listening on UDP port 4789
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>  Replication/Flood Mode is headend with Flood List Source: EVPN
<a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>  Remote MAC learning via EVPN
<a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>  VNI mapping to VLANs
<a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a>  Static VLAN to VNI mapping is
<a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a>    [10, 10010]       [20, 10020]
<a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a>  Dynamic VLAN to VNI mapping for &#39;evpn&#39; is
<a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a>    [1199, 10]
<a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a>  Note: All Dynamic VLANs used by VCS are internal VLANs.
<a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a>        Use &#39;show vxlan vni&#39; for details.
<a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a>  Static VRF to VNI mapping is
<a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a>  [OVERLAY, 10]
<a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a>  Headend replication flood vtep list is:
<a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a><span class="hll">    10 10.255.1.5      10.255.1.7
</span><a id="__codelineno-30-20" name="__codelineno-30-20" href="#__codelineno-30-20"></a><span class="hll">    20 10.255.1.5      10.255.1.7
</span><a id="__codelineno-30-21" name="__codelineno-30-21" href="#__codelineno-30-21"></a>  MLAG Shared Router MAC is 021c.73c0.c612
</code></pre></div>
</li>
<li>
<p class="annotate">Finally, lets verify we have <strong>IMET</strong> (1) routes for each VLAN and VTEP in the EVPN overlay.</p>
<ol>
<li>IMET, or Type-3 routes are required for Broadcast, Unknown Unicast and Multicast (BUM) traffic delivery across EVPN networks.</li>
</ol>
<p><ins>Command</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>show bgp evpn route-type imet
</code></pre></div>
<p><ins>Expected Output</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>s1-leaf1#show bgp evpn route-type imet
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>BGP routing table information for VRF default
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>Router identifier 10.250.1.3, local AS number 65101
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>Route status codes: * - valid, &gt; - active, S - Stale, E - ECMP head, e - ECMP
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>                    c - Contributing to ECMP, % - Pending best path selection
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>Origin codes: i - IGP, e - EGP, ? - incomplete
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a>AS Path Attributes: Or-ID - Originator ID, C-LST - Cluster List, LL Nexthop - Link Local Nexthop
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a>
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a>          Network                Next Hop              Metric  LocPref Weight  Path
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a>* &gt;      RD: 10.250.1.3:10010 imet 10.255.1.3
<a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a>                                -                     -       -       0       i
<a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a>* &gt;      RD: 10.250.1.3:10020 imet 10.255.1.3
<a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a>                                -                     -       -       0       i
<a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a>* &gt;Ec    RD: 10.250.1.5:10010 imet 10.255.1.5
<a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-32-16" name="__codelineno-32-16" href="#__codelineno-32-16"></a>*  ec    RD: 10.250.1.5:10010 imet 10.255.1.5
<a id="__codelineno-32-17" name="__codelineno-32-17" href="#__codelineno-32-17"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-32-18" name="__codelineno-32-18" href="#__codelineno-32-18"></a>* &gt;Ec    RD: 10.250.1.5:10020 imet 10.255.1.5
<a id="__codelineno-32-19" name="__codelineno-32-19" href="#__codelineno-32-19"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-32-20" name="__codelineno-32-20" href="#__codelineno-32-20"></a>*  ec    RD: 10.250.1.5:10020 imet 10.255.1.5
<a id="__codelineno-32-21" name="__codelineno-32-21" href="#__codelineno-32-21"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-32-22" name="__codelineno-32-22" href="#__codelineno-32-22"></a>* &gt;Ec    RD: 10.250.1.6:10010 imet 10.255.1.5
<a id="__codelineno-32-23" name="__codelineno-32-23" href="#__codelineno-32-23"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-32-24" name="__codelineno-32-24" href="#__codelineno-32-24"></a>*  ec    RD: 10.250.1.6:10010 imet 10.255.1.5
<a id="__codelineno-32-25" name="__codelineno-32-25" href="#__codelineno-32-25"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-32-26" name="__codelineno-32-26" href="#__codelineno-32-26"></a>* &gt;Ec    RD: 10.250.1.6:10020 imet 10.255.1.5
<a id="__codelineno-32-27" name="__codelineno-32-27" href="#__codelineno-32-27"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-32-28" name="__codelineno-32-28" href="#__codelineno-32-28"></a>*  ec    RD: 10.250.1.6:10020 imet 10.255.1.5
<a id="__codelineno-32-29" name="__codelineno-32-29" href="#__codelineno-32-29"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-32-30" name="__codelineno-32-30" href="#__codelineno-32-30"></a>* &gt;Ec    RD: 10.250.1.7:10010 imet 10.255.1.7
<a id="__codelineno-32-31" name="__codelineno-32-31" href="#__codelineno-32-31"></a>                                10.255.1.7            -       100     0       65100 65103 i
<a id="__codelineno-32-32" name="__codelineno-32-32" href="#__codelineno-32-32"></a>*  ec    RD: 10.250.1.7:10010 imet 10.255.1.7
<a id="__codelineno-32-33" name="__codelineno-32-33" href="#__codelineno-32-33"></a>                                10.255.1.7            -       100     0       65100 65103 i
<a id="__codelineno-32-34" name="__codelineno-32-34" href="#__codelineno-32-34"></a>* &gt;Ec    RD: 10.250.1.7:10020 imet 10.255.1.7
<a id="__codelineno-32-35" name="__codelineno-32-35" href="#__codelineno-32-35"></a>                                10.255.1.7            -       100     0       65100 65103 i
<a id="__codelineno-32-36" name="__codelineno-32-36" href="#__codelineno-32-36"></a>*  ec    RD: 10.250.1.7:10020 imet 10.255.1.7
<a id="__codelineno-32-37" name="__codelineno-32-37" href="#__codelineno-32-37"></a>                                10.255.1.7            -       100     0       65100 65103 i
<a id="__codelineno-32-38" name="__codelineno-32-38" href="#__codelineno-32-38"></a>* &gt;Ec    RD: 10.250.1.8:10010 imet 10.255.1.7
<a id="__codelineno-32-39" name="__codelineno-32-39" href="#__codelineno-32-39"></a>                                10.255.1.7            -       100     0       65100 65103 i
<a id="__codelineno-32-40" name="__codelineno-32-40" href="#__codelineno-32-40"></a>*  ec    RD: 10.250.1.8:10010 imet 10.255.1.7
<a id="__codelineno-32-41" name="__codelineno-32-41" href="#__codelineno-32-41"></a>                                10.255.1.7            -       100     0       65100 65103 i
<a id="__codelineno-32-42" name="__codelineno-32-42" href="#__codelineno-32-42"></a>* &gt;Ec    RD: 10.250.1.8:10020 imet 10.255.1.7
<a id="__codelineno-32-43" name="__codelineno-32-43" href="#__codelineno-32-43"></a>                                10.255.1.7            -       100     0       65100 65103 i
<a id="__codelineno-32-44" name="__codelineno-32-44" href="#__codelineno-32-44"></a>*  ec    RD: 10.250.1.8:10020 imet 10.255.1.7
<a id="__codelineno-32-45" name="__codelineno-32-45" href="#__codelineno-32-45"></a>                                10.255.1.7            -       100     0       65100 65103 i
</code></pre></div>
</li>
</ol>
<p>You can verify the recent configuration session was created.</p>
<details class="info" open="open">
<summary>Info</summary>
<p>When the configuration is applied via a configuration session, EOS will create a "checkpoint" of the configuration. This checkpoint is a snapshot
of the device's running configuration as it was <strong>prior</strong> to the configuration session being committed.</p>
</details>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>show<span class="w"> </span>clock
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>show<span class="w"> </span>configuration<span class="w"> </span>sessions<span class="w"> </span>detail
</code></pre></div>
<p>List the recent checkpoints.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>show<span class="w"> </span>config<span class="w"> </span>checkpoints
</code></pre></div>
<p>View the contents of the latest checkpoint file.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>more<span class="w"> </span>checkpoint:&lt;<span class="w"> </span>filename<span class="w"> </span>&gt;
</code></pre></div>
<p>See the difference between the running config and the latest checkpoint file.</p>
<details class="tip" open="open">
<summary>Tip</summary>
<p>This will show the differences between the current device configuration
and the configuration before we did our <code>make deploy</code> command.</p>
</details>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>diff<span class="w"> </span>checkpoint:&lt;<span class="w"> </span>filename<span class="w"> </span>&gt;<span class="w"> </span>running-config
</code></pre></div>
<h3 id="add-ports-for-hosts">Add Ports for Hosts<a class="headerlink" href="#add-ports-for-hosts" title="Permanent link">&para;</a></h3>
<p>Let's configure port-channels to our hosts (<code>s1-host1</code> and <code>s1-host2</code>).</p>
<p>Open <code>SITE1_CONNECTED_ENDPOINTS.yml</code> and uncomment lines 17-45, then run the build &amp; deploy process again.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>make<span class="w"> </span>build-site-1
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>make<span class="w"> </span>deploy-site-1
</code></pre></div>
<p>At this point, hosts should be able to ping each other across the fabric.</p>
<p>From <code>s1-host1</code>, run a ping to <code>s1-host2</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>ping<span class="w"> </span><span class="m">10</span>.20.20.100
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>PING 10.20.20.100 (10.20.20.100) 72(100) bytes of data.
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>80 bytes from 10.20.20.100: icmp_seq=1 ttl=63 time=30.2 ms
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a>80 bytes from 10.20.20.100: icmp_seq=2 ttl=63 time=29.5 ms
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a>80 bytes from 10.20.20.100: icmp_seq=3 ttl=63 time=28.8 ms
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a>80 bytes from 10.20.20.100: icmp_seq=4 ttl=63 time=24.8 ms
<a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a>80 bytes from 10.20.20.100: icmp_seq=5 ttl=63 time=26.2 ms
</code></pre></div>
<details class="success" open="open">
<summary>Success</summary>
<p>Site 1 fabric is now complete.</p>
</details>
<h2 id="step-4-site-2"><strong>Step 4 - Site 2</strong><a class="headerlink" href="#step-4-site-2" title="Permanent link">&para;</a></h2>
<p>Repeat the previous three steps for Site 2.</p>
<ul>
<li>Add Services</li>
<li>Add Ports</li>
<li>Build and Deploy Configs</li>
<li>Verify ping traffic between hosts <code>s2-host1</code> and <code>s2-host2</code></li>
</ul>
<p>At this point, you should be able to ping between hosts within a site but not between sites. For this, we need to build connectivity to the <code>DCI Network</code>. This is covered in the next section.</p>
<h2 id="step-5-connect-sites-to-dci-network"><strong>Step 5 - Connect Sites to DCI Network</strong><a class="headerlink" href="#step-5-connect-sites-to-dci-network" title="Permanent link">&para;</a></h2>
<p>The DCI Network is defined by the <code>l3_edge</code> data model. Full data model documentation is located <strong><a href="https://avd.arista.com/4.10/roles/eos_designs/docs/input-variables.html#l3-edge-and-dci-settings">here</a></strong>.</p>
<p>The data model defines P2P links (<code>/31s</code>) on the border leafs by using a combination of the ipv4_pool and the node id in the p2p_links section. See details in the graphic below. Each border leaf has a single link to its peer on interface <code>Ethernet4</code>.  In the data model, you will notice the parameter for <strong>include_in_underlay_protocol</strong>, which is set to <strong><em>true</em></strong>.  This tells AVD to render the appropriate BGP configurations for route peering.</p>
<p><a class="glightbox" href="../../assets/images/l3ls_dci.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Core Interfaces" src="../../assets/images/l3ls_dci.png" /></a></p>
<h3 id="add-p2p-links-for-dci-connectivity-for-site-1-and-2"><strong>Add P2P Links for DCI connectivity for Site 1 and 2</strong><a class="headerlink" href="#add-p2p-links-for-dci-connectivity-for-site-1-and-2" title="Permanent link">&para;</a></h3>
<p>Enable the <code>l3_edge</code> dictionary (shown below) by uncommenting it from the <code>global_vars/global_dc_vars.yml</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="c1"># L3 Edge port definitions. This can be any port in the entire Fabric, where IP interfaces are defined.</span>
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="nt">l3_edge</span><span class="p">:</span>
<a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="w">  </span><span class="c1"># Define a new IP pool that will be used to assign IP addresses to L3 Edge interfaces.</span>
<a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a><span class="w">  </span><span class="nt">p2p_links_ip_pools</span><span class="p">:</span>
<a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">S1_to_S2_IP_pool</span>
<a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a><span class="w">      </span><span class="nt">ipv4_pool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">172.16.255.0/24</span>
<a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a><span class="w">  </span><span class="c1"># Define a new link profile which will match the IP pool, the used ASNs and include the defined interface into underlay routing</span>
<a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a><span class="w">  </span><span class="nt">p2p_links_profiles</span><span class="p">:</span>
<a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">S1_to_S2_profile</span>
<a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a><span class="w">      </span><span class="nt">ip_pool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">S1_to_S2_IP_pool</span>
<a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a><span class="w">      </span><span class="nt">as</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">65103</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">65203</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-42-12" name="__codelineno-42-12" href="#__codelineno-42-12"></a><span class="w">      </span><span class="nt">include_in_underlay_protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-42-13" name="__codelineno-42-13" href="#__codelineno-42-13"></a><span class="w">  </span><span class="c1"># Define each P2P L3 link and link the nodes, the interfaces and the profile used.</span>
<a id="__codelineno-42-14" name="__codelineno-42-14" href="#__codelineno-42-14"></a><span class="w">  </span><span class="nt">p2p_links</span><span class="p">:</span>
<a id="__codelineno-42-15" name="__codelineno-42-15" href="#__codelineno-42-15"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<a id="__codelineno-42-16" name="__codelineno-42-16" href="#__codelineno-42-16"></a><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">s1-brdr1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">s2-brdr1</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-42-17" name="__codelineno-42-17" href="#__codelineno-42-17"></a><span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet4</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet4</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-42-18" name="__codelineno-42-18" href="#__codelineno-42-18"></a><span class="w">      </span><span class="nt">profile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">S1_to_S2_profile</span>
<a id="__codelineno-42-19" name="__codelineno-42-19" href="#__codelineno-42-19"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<a id="__codelineno-42-20" name="__codelineno-42-20" href="#__codelineno-42-20"></a><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">s1-brdr2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">s2-brdr2</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-42-21" name="__codelineno-42-21" href="#__codelineno-42-21"></a><span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet5</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet5</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-42-22" name="__codelineno-42-22" href="#__codelineno-42-22"></a><span class="w">      </span><span class="nt">profile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">S1_to_S2_profile</span>
</code></pre></div>
<h3 id="build-and-deploy-dci-network-connectivity"><strong>Build and Deploy DCI Network connectivity</strong><a class="headerlink" href="#build-and-deploy-dci-network-connectivity" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>make<span class="w"> </span>build-site-1<span class="w"> </span>build-site-2<span class="w"> </span>deploy-site-1<span class="w"> </span>deploy-site-2
</code></pre></div>
<details class="tip" open="open">
<summary>Tip</summary>
<p>Daisy chaining "Makesies" is a great way to run a series of tasks with a single CLI command <img alt="😀" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f600.svg" title=":grinning:" /></p>
</details>
<h4 id="verification_2">Verification<a class="headerlink" href="#verification_2" title="Permanent link">&para;</a></h4>
<p>Now that we have built and deployed our configurations for our DCI IPv4 underlay connectivity, lets see what was done.  Looking at the data model above, we see we only defined a pool of IP addresses with a <strong>/24</strong> mask which AVD will use to auto-alllocated a subnet per connection.  Additionally, we can see that <code>s1-brdr1</code> connects to its peer <code>s2-brdr1</code> via interface <code>Ethernet4</code>, and <code>s1-brdr2</code> connects to its peer <code>s2-brdr2</code> via interface <code>Ethernet5</code>.  Using that data model, here is what we expect to see configured.  You can verify this by logging into each border leaf and checking with <strong>show ip interface brief</strong>.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Host</th>
<th style="text-align: center;">Interface</th>
<th style="text-align: center;">IP Address</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">s1-brdr1</td>
<td style="text-align: center;">Ethernet4</td>
<td style="text-align: center;">172.16.255.0/31</td>
</tr>
<tr>
<td style="text-align: center;">s2-brdr1</td>
<td style="text-align: center;">Ethernet4</td>
<td style="text-align: center;">172.16.255.1/31</td>
</tr>
<tr>
<td style="text-align: center;">s1-brdr2</td>
<td style="text-align: center;">Ethernet5</td>
<td style="text-align: center;">172.16.255.2/31</td>
</tr>
<tr>
<td style="text-align: center;">s2-brdr2</td>
<td style="text-align: center;">Ethernet5</td>
<td style="text-align: center;">172.16.255.3/31</td>
</tr>
</tbody>
</table>
<p>Now lets verify the underlay connectivity and routing across the DCI network.</p>
<ol>
<li>
<p>From <code>s1-brdr1</code>, check the IPv4 underlay peering to its neighbor at Site 2, <code>s2-brdr1</code>.</p>
<p><ins>Command</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>show ip bgp summary
</code></pre></div>
<p><ins>Expected Output</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>s1-brdr1#sho ip bgp summary
<a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>BGP summary information for VRF default
<a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>Router identifier 10.250.1.7, local AS number 65103
<a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a>Neighbor Status Codes: m - Under maintenance
<a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a>  Description              Neighbor     V AS           MsgRcvd   MsgSent  InQ OutQ  Up/Down State   PfxRcd PfxAcc
<a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a>  s1-brdr2                 10.252.1.9   4 65103            103       100    0    0 01:13:03 Estab   21     21
<a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a>  s1-spine1_Ethernet7      172.16.1.16  4 65100             98        99    0    0 01:13:03 Estab   7      7
<a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a>  s1-spine2_Ethernet7      172.16.1.18  4 65100             96        97    0    0 01:13:04 Estab   7      7
<a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a><span class="hll">  s2-brdr1                 172.16.255.1 4 65203             27        26    0    0 00:14:19 Estab   11     11
</span></code></pre></div>
</li>
<li>
<p>From <code>s1-brdr1</code>, check its routing table in the default VRF and look for any prefixes learned from peer <code>172.16.255.1</code> via interface <code>Ethernet4</code>.  We will be looking for anything with a third octet of <strong>.2</strong> which signifies Site 2.</p>
<p><ins>Command</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>show ip route
</code></pre></div>
<p><ins>Expected Output</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>s1-brdr1#show ip route
<a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a>
<a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a>VRF: default
<a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a>Source Codes:
<a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a>      C - connected, S - static, K - kernel,
<a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a>      O - OSPF, IA - OSPF inter area, E1 - OSPF external type 1,
<a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a>      E2 - OSPF external type 2, N1 - OSPF NSSA external type 1,
<a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a>      N2 - OSPF NSSA external type2, B - Other BGP Routes,
<a id="__codelineno-47-9" name="__codelineno-47-9" href="#__codelineno-47-9"></a>      B I - iBGP, B E - eBGP, R - RIP, I L1 - IS-IS level 1,
<a id="__codelineno-47-10" name="__codelineno-47-10" href="#__codelineno-47-10"></a>      I L2 - IS-IS level 2, O3 - OSPFv3, A B - BGP Aggregate,
<a id="__codelineno-47-11" name="__codelineno-47-11" href="#__codelineno-47-11"></a>      A O - OSPF Summary, NG - Nexthop Group Static Route,
<a id="__codelineno-47-12" name="__codelineno-47-12" href="#__codelineno-47-12"></a>      V - VXLAN Control Service, M - Martian,
<a id="__codelineno-47-13" name="__codelineno-47-13" href="#__codelineno-47-13"></a>      DH - DHCP client installed default route,
<a id="__codelineno-47-14" name="__codelineno-47-14" href="#__codelineno-47-14"></a>      DP - Dynamic Policy Route, L - VRF Leaked,
<a id="__codelineno-47-15" name="__codelineno-47-15" href="#__codelineno-47-15"></a>      G  - gRIBI, RC - Route Cache Route,
<a id="__codelineno-47-16" name="__codelineno-47-16" href="#__codelineno-47-16"></a>      CL - CBF Leaked Route
<a id="__codelineno-47-17" name="__codelineno-47-17" href="#__codelineno-47-17"></a>
<a id="__codelineno-47-18" name="__codelineno-47-18" href="#__codelineno-47-18"></a>Gateway of last resort:
<a id="__codelineno-47-19" name="__codelineno-47-19" href="#__codelineno-47-19"></a>S        0.0.0.0/0 [1/0]
<a id="__codelineno-47-20" name="__codelineno-47-20" href="#__codelineno-47-20"></a>          via 192.168.0.1, Management0
<a id="__codelineno-47-21" name="__codelineno-47-21" href="#__codelineno-47-21"></a>
<a id="__codelineno-47-22" name="__codelineno-47-22" href="#__codelineno-47-22"></a>B E      10.250.1.1/32 [200/0]
<a id="__codelineno-47-23" name="__codelineno-47-23" href="#__codelineno-47-23"></a>          via 172.16.1.16, Ethernet2
<a id="__codelineno-47-24" name="__codelineno-47-24" href="#__codelineno-47-24"></a>B E      10.250.1.2/32 [200/0]
<a id="__codelineno-47-25" name="__codelineno-47-25" href="#__codelineno-47-25"></a>          via 172.16.1.18, Ethernet3
<a id="__codelineno-47-26" name="__codelineno-47-26" href="#__codelineno-47-26"></a>B E      10.250.1.3/32 [200/0]
<a id="__codelineno-47-27" name="__codelineno-47-27" href="#__codelineno-47-27"></a>          via 172.16.1.16, Ethernet2
<a id="__codelineno-47-28" name="__codelineno-47-28" href="#__codelineno-47-28"></a>          via 172.16.1.18, Ethernet3
<a id="__codelineno-47-29" name="__codelineno-47-29" href="#__codelineno-47-29"></a>B E      10.250.1.4/32 [200/0]
<a id="__codelineno-47-30" name="__codelineno-47-30" href="#__codelineno-47-30"></a>          via 172.16.1.16, Ethernet2
<a id="__codelineno-47-31" name="__codelineno-47-31" href="#__codelineno-47-31"></a>          via 172.16.1.18, Ethernet3
<a id="__codelineno-47-32" name="__codelineno-47-32" href="#__codelineno-47-32"></a>B E      10.250.1.5/32 [200/0]
<a id="__codelineno-47-33" name="__codelineno-47-33" href="#__codelineno-47-33"></a>          via 172.16.1.16, Ethernet2
<a id="__codelineno-47-34" name="__codelineno-47-34" href="#__codelineno-47-34"></a>          via 172.16.1.18, Ethernet3
<a id="__codelineno-47-35" name="__codelineno-47-35" href="#__codelineno-47-35"></a>B E      10.250.1.6/32 [200/0]
<a id="__codelineno-47-36" name="__codelineno-47-36" href="#__codelineno-47-36"></a>          via 172.16.1.16, Ethernet2
<a id="__codelineno-47-37" name="__codelineno-47-37" href="#__codelineno-47-37"></a>          via 172.16.1.18, Ethernet3
<a id="__codelineno-47-38" name="__codelineno-47-38" href="#__codelineno-47-38"></a>C        10.250.1.7/32
<a id="__codelineno-47-39" name="__codelineno-47-39" href="#__codelineno-47-39"></a>          directly connected, Loopback0
<a id="__codelineno-47-40" name="__codelineno-47-40" href="#__codelineno-47-40"></a>B I      10.250.1.8/32 [200/0]
<a id="__codelineno-47-41" name="__codelineno-47-41" href="#__codelineno-47-41"></a>          via 10.252.1.9, Vlan4093
<a id="__codelineno-47-42" name="__codelineno-47-42" href="#__codelineno-47-42"></a><span class="hll">B E      10.250.2.1/32 [200/0]
</span><a id="__codelineno-47-43" name="__codelineno-47-43" href="#__codelineno-47-43"></a><span class="hll">          via 172.16.255.1, Ethernet4
</span><a id="__codelineno-47-44" name="__codelineno-47-44" href="#__codelineno-47-44"></a><span class="hll">B E      10.250.2.2/32 [200/0]
</span><a id="__codelineno-47-45" name="__codelineno-47-45" href="#__codelineno-47-45"></a><span class="hll">          via 172.16.255.1, Ethernet4
</span><a id="__codelineno-47-46" name="__codelineno-47-46" href="#__codelineno-47-46"></a><span class="hll">B E      10.250.2.3/32 [200/0]
</span><a id="__codelineno-47-47" name="__codelineno-47-47" href="#__codelineno-47-47"></a><span class="hll">          via 172.16.255.1, Ethernet4
</span><a id="__codelineno-47-48" name="__codelineno-47-48" href="#__codelineno-47-48"></a><span class="hll">B E      10.250.2.4/32 [200/0]
</span><a id="__codelineno-47-49" name="__codelineno-47-49" href="#__codelineno-47-49"></a><span class="hll">          via 172.16.255.1, Ethernet4
</span><a id="__codelineno-47-50" name="__codelineno-47-50" href="#__codelineno-47-50"></a><span class="hll">B E      10.250.2.5/32 [200/0]
</span><a id="__codelineno-47-51" name="__codelineno-47-51" href="#__codelineno-47-51"></a><span class="hll">          via 172.16.255.1, Ethernet4
</span><a id="__codelineno-47-52" name="__codelineno-47-52" href="#__codelineno-47-52"></a><span class="hll">B E      10.250.2.6/32 [200/0]
</span><a id="__codelineno-47-53" name="__codelineno-47-53" href="#__codelineno-47-53"></a><span class="hll">          via 172.16.255.1, Ethernet4
</span><a id="__codelineno-47-54" name="__codelineno-47-54" href="#__codelineno-47-54"></a><span class="hll">B E      10.250.2.7/32 [200/0]
</span><a id="__codelineno-47-55" name="__codelineno-47-55" href="#__codelineno-47-55"></a><span class="hll">          via 172.16.255.1, Ethernet4
</span><a id="__codelineno-47-56" name="__codelineno-47-56" href="#__codelineno-47-56"></a><span class="hll">B E      10.250.2.8/32 [200/0]
</span><a id="__codelineno-47-57" name="__codelineno-47-57" href="#__codelineno-47-57"></a><span class="hll">          via 172.16.255.1, Ethernet4
</span><a id="__codelineno-47-58" name="__codelineno-47-58" href="#__codelineno-47-58"></a>C        10.251.1.8/31
<a id="__codelineno-47-59" name="__codelineno-47-59" href="#__codelineno-47-59"></a>          directly connected, Vlan4094
<a id="__codelineno-47-60" name="__codelineno-47-60" href="#__codelineno-47-60"></a>C        10.252.1.8/31
<a id="__codelineno-47-61" name="__codelineno-47-61" href="#__codelineno-47-61"></a>          directly connected, Vlan4093
<a id="__codelineno-47-62" name="__codelineno-47-62" href="#__codelineno-47-62"></a>B E      10.255.1.3/32 [200/0]
<a id="__codelineno-47-63" name="__codelineno-47-63" href="#__codelineno-47-63"></a>          via 172.16.1.16, Ethernet2
<a id="__codelineno-47-64" name="__codelineno-47-64" href="#__codelineno-47-64"></a>          via 172.16.1.18, Ethernet3
<a id="__codelineno-47-65" name="__codelineno-47-65" href="#__codelineno-47-65"></a>B E      10.255.1.5/32 [200/0]
<a id="__codelineno-47-66" name="__codelineno-47-66" href="#__codelineno-47-66"></a>          via 172.16.1.16, Ethernet2
<a id="__codelineno-47-67" name="__codelineno-47-67" href="#__codelineno-47-67"></a>          via 172.16.1.18, Ethernet3
<a id="__codelineno-47-68" name="__codelineno-47-68" href="#__codelineno-47-68"></a>C        10.255.1.7/32
<a id="__codelineno-47-69" name="__codelineno-47-69" href="#__codelineno-47-69"></a>          directly connected, Loopback1
<a id="__codelineno-47-70" name="__codelineno-47-70" href="#__codelineno-47-70"></a><span class="hll">B E      10.255.2.3/32 [200/0]
</span><a id="__codelineno-47-71" name="__codelineno-47-71" href="#__codelineno-47-71"></a><span class="hll">          via 172.16.255.1, Ethernet4
</span><a id="__codelineno-47-72" name="__codelineno-47-72" href="#__codelineno-47-72"></a><span class="hll">B E      10.255.2.5/32 [200/0]
</span><a id="__codelineno-47-73" name="__codelineno-47-73" href="#__codelineno-47-73"></a><span class="hll">          via 172.16.255.1, Ethernet4
</span><a id="__codelineno-47-74" name="__codelineno-47-74" href="#__codelineno-47-74"></a><span class="hll">B E      10.255.2.7/32 [200/0]
</span><a id="__codelineno-47-75" name="__codelineno-47-75" href="#__codelineno-47-75"></a><span class="hll">          via 172.16.255.1, Ethernet4
</span><a id="__codelineno-47-76" name="__codelineno-47-76" href="#__codelineno-47-76"></a>C        172.16.1.16/31
<a id="__codelineno-47-77" name="__codelineno-47-77" href="#__codelineno-47-77"></a>          directly connected, Ethernet2
<a id="__codelineno-47-78" name="__codelineno-47-78" href="#__codelineno-47-78"></a>C        172.16.1.18/31
<a id="__codelineno-47-79" name="__codelineno-47-79" href="#__codelineno-47-79"></a>          directly connected, Ethernet3
<a id="__codelineno-47-80" name="__codelineno-47-80" href="#__codelineno-47-80"></a>C        172.16.255.0/31
<a id="__codelineno-47-81" name="__codelineno-47-81" href="#__codelineno-47-81"></a>          directly connected, Ethernet4
<a id="__codelineno-47-82" name="__codelineno-47-82" href="#__codelineno-47-82"></a>C        192.168.0.0/24
<a id="__codelineno-47-83" name="__codelineno-47-83" href="#__codelineno-47-83"></a>          directly connected, Management0
</code></pre></div>
</li>
<li>
<p>From <code>s1-brdr2</code>, check the IPv4 underlay peering to its neighbor at Site 2, <code>s2-brdr2</code>.</p>
<p><ins>Command</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>show ip bgp summary
</code></pre></div>
<p><ins>Expected Output</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a>s1-brdr2#show ip bgp summary
<a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a>BGP summary information for VRF default
<a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a>Router identifier 10.250.1.8, local AS number 65103
<a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a>Neighbor Status Codes: m - Under maintenance
<a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a>  Description              Neighbor     V AS           MsgRcvd   MsgSent  InQ OutQ  Up/Down State   PfxRcd PfxAcc
<a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a>  s1-brdr1                 10.252.1.8   4 65103            110       113    0    0 01:21:29 Estab   21     21
<a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a>  s1-spine1_Ethernet8      172.16.1.20  4 65100            107       112    0    0 01:21:30 Estab   7      7
<a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a>  s1-spine2_Ethernet8      172.16.1.22  4 65100            112       108    0    0 01:21:29 Estab   7      7
<a id="__codelineno-49-9" name="__codelineno-49-9" href="#__codelineno-49-9"></a><span class="hll">  s2-brdr2                 172.16.255.3 4 65203             36        36    0    0 00:22:45 Estab   11     11
</span></code></pre></div>
</li>
</ol>
<details class="success" open="open">
<summary>DCI Underlay Complete</summary>
<p>If your BGP peerings match above and you have the correct routes in your routing table, the DCI network is successfully connected!</p>
</details>
<h2 id="step-6-enable-evpn-gateway-functionality"><strong>Step 6 - Enable EVPN Gateway Functionality</strong><a class="headerlink" href="#step-6-enable-evpn-gateway-functionality" title="Permanent link">&para;</a></h2>
<p>Now that we have built and deployed our fabrics for both data centers, Site 1 and Site 2, we will need to enable EVPN gateway functionality on our border leafs so layer 2 and layer 3 traffic can move between the data centers across the EVPN overlay.</p>
<p>In order to do this, we will need to uncomment the necessary data model to enable EVPN gateway for the border leafs.</p>
<p>Below you will see the data model snippets from <code>sites/site_1/group_vars/SITE1_FABRIC.yml</code> and <code>sites/site_2/group_vars/SITE2_FABRIC.yml</code>, for the <code>S1_BRDR</code> and <code>S2_BRDR</code> node groups.  To enable EVPN gateway functionality you will need to modify the <code>SITE1_FABRIC.yml</code> vars file, and uncomment the below highlighted sections.  Uncomment the same sections from the <code>SITE2_FABRIC.yml</code> vars file.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">SITE1_FABRIC.yml</label><label for="__tabbed_1_2">SITE2_FABRIC.yml</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">S1_BRDR</span>
<a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="w">  </span><span class="nt">bgp_as</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65103</span>
<a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a><span class="hll"><span class="w">  </span><span class="c1"># evpn_gateway:</span>
</span><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a><span class="hll"><span class="w">  </span><span class="c1">#   evpn_l2:</span>
</span><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a><span class="hll"><span class="w">  </span><span class="c1">#     enabled: true</span>
</span><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a><span class="hll"><span class="w">  </span><span class="c1">#   evpn_l3:</span>
</span><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a><span class="hll"><span class="w">  </span><span class="c1">#     enabled: true</span>
</span><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a><span class="hll"><span class="w">  </span><span class="c1">#     inter_domain: true</span>
</span><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a><span class="w">  </span><span class="nt">nodes</span><span class="p">:</span>
<a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-brdr1</span>
<a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a><span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<a id="__codelineno-50-12" name="__codelineno-50-12" href="#__codelineno-50-12"></a><span class="w">      </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.100/24</span>
<a id="__codelineno-50-13" name="__codelineno-50-13" href="#__codelineno-50-13"></a><span class="w">      </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet7</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet7</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-50-14" name="__codelineno-50-14" href="#__codelineno-50-14"></a><span class="hll"><span class="w">      </span><span class="c1"># evpn_gateway:</span>
</span><a id="__codelineno-50-15" name="__codelineno-50-15" href="#__codelineno-50-15"></a><span class="hll"><span class="w">      </span><span class="c1">#   remote_peers:</span>
</span><a id="__codelineno-50-16" name="__codelineno-50-16" href="#__codelineno-50-16"></a><span class="hll"><span class="w">      </span><span class="c1">#     - hostname: s2-brdr1</span>
</span><a id="__codelineno-50-17" name="__codelineno-50-17" href="#__codelineno-50-17"></a><span class="hll"><span class="w">      </span><span class="c1">#       bgp_as: 65203</span>
</span><a id="__codelineno-50-18" name="__codelineno-50-18" href="#__codelineno-50-18"></a><span class="hll"><span class="w">      </span><span class="c1">#       ip_address: 10.255.2.7</span>
</span><a id="__codelineno-50-19" name="__codelineno-50-19" href="#__codelineno-50-19"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-brdr2</span>
<a id="__codelineno-50-20" name="__codelineno-50-20" href="#__codelineno-50-20"></a><span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6</span>
<a id="__codelineno-50-21" name="__codelineno-50-21" href="#__codelineno-50-21"></a><span class="w">      </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.101/24</span>
<a id="__codelineno-50-22" name="__codelineno-50-22" href="#__codelineno-50-22"></a><span class="w">      </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet8</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-50-23" name="__codelineno-50-23" href="#__codelineno-50-23"></a><span class="hll"><span class="w">      </span><span class="c1"># evpn_gateway:</span>
</span><a id="__codelineno-50-24" name="__codelineno-50-24" href="#__codelineno-50-24"></a><span class="hll"><span class="w">      </span><span class="c1">#   remote_peers:</span>
</span><a id="__codelineno-50-25" name="__codelineno-50-25" href="#__codelineno-50-25"></a><span class="hll"><span class="w">      </span><span class="c1">#     - hostname: s2-brdr2</span>
</span><a id="__codelineno-50-26" name="__codelineno-50-26" href="#__codelineno-50-26"></a><span class="hll"><span class="w">      </span><span class="c1">#       bgp_as: 65203</span>
</span><a id="__codelineno-50-27" name="__codelineno-50-27" href="#__codelineno-50-27"></a><span class="hll"><span class="w">      </span><span class="c1">#       ip_address: 10.255.2.8</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">S2_BRDR</span>
<a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a><span class="w">  </span><span class="nt">bgp_as</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65203</span>
<a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a><span class="hll"><span class="w">  </span><span class="c1"># evpn_gateway:</span>
</span><a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a><span class="hll"><span class="w">  </span><span class="c1">#   evpn_l2:</span>
</span><a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a><span class="hll"><span class="w">  </span><span class="c1">#     enabled: true</span>
</span><a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a><span class="hll"><span class="w">  </span><span class="c1">#   evpn_l3:</span>
</span><a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a><span class="hll"><span class="w">  </span><span class="c1">#     enabled: true</span>
</span><a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a><span class="hll"><span class="w">  </span><span class="c1">#     inter_domain: true</span>
</span><a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a><span class="w">  </span><span class="nt">nodes</span><span class="p">:</span>
<a id="__codelineno-51-10" name="__codelineno-51-10" href="#__codelineno-51-10"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s2-brdr1</span>
<a id="__codelineno-51-11" name="__codelineno-51-11" href="#__codelineno-51-11"></a><span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<a id="__codelineno-51-12" name="__codelineno-51-12" href="#__codelineno-51-12"></a><span class="w">      </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.200/24</span>
<a id="__codelineno-51-13" name="__codelineno-51-13" href="#__codelineno-51-13"></a><span class="w">      </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet7</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet7</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-14" name="__codelineno-51-14" href="#__codelineno-51-14"></a><span class="hll"><span class="w">      </span><span class="c1"># evpn_gateway:</span>
</span><a id="__codelineno-51-15" name="__codelineno-51-15" href="#__codelineno-51-15"></a><span class="hll"><span class="w">      </span><span class="c1">#   remote_peers:</span>
</span><a id="__codelineno-51-16" name="__codelineno-51-16" href="#__codelineno-51-16"></a><span class="hll"><span class="w">      </span><span class="c1">#     - hostname: s1-brdr1</span>
</span><a id="__codelineno-51-17" name="__codelineno-51-17" href="#__codelineno-51-17"></a><span class="hll"><span class="w">      </span><span class="c1">#       bgp_as: 65103</span>
</span><a id="__codelineno-51-18" name="__codelineno-51-18" href="#__codelineno-51-18"></a><span class="hll"><span class="w">      </span><span class="c1">#       ip_address: 10.255.1.7</span>
</span><a id="__codelineno-51-19" name="__codelineno-51-19" href="#__codelineno-51-19"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s2-brdr2</span>
<a id="__codelineno-51-20" name="__codelineno-51-20" href="#__codelineno-51-20"></a><span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6</span>
<a id="__codelineno-51-21" name="__codelineno-51-21" href="#__codelineno-51-21"></a><span class="w">      </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.201/24</span>
<a id="__codelineno-51-22" name="__codelineno-51-22" href="#__codelineno-51-22"></a><span class="w">      </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet8</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-23" name="__codelineno-51-23" href="#__codelineno-51-23"></a><span class="hll"><span class="w">      </span><span class="c1"># evpn_gateway:</span>
</span><a id="__codelineno-51-24" name="__codelineno-51-24" href="#__codelineno-51-24"></a><span class="hll"><span class="w">      </span><span class="c1">#   remote_peers:</span>
</span><a id="__codelineno-51-25" name="__codelineno-51-25" href="#__codelineno-51-25"></a><span class="hll"><span class="w">      </span><span class="c1">#     - hostname: s1-brdr2</span>
</span><a id="__codelineno-51-26" name="__codelineno-51-26" href="#__codelineno-51-26"></a><span class="hll"><span class="w">      </span><span class="c1">#       bgp_as: 65103</span>
</span><a id="__codelineno-51-27" name="__codelineno-51-27" href="#__codelineno-51-27"></a><span class="hll"><span class="w">      </span><span class="c1">#       ip_address: 10.255.1.8</span>
</span></code></pre></div>
</div>
</div>
</div>
<details class="note" open="open">
<summary>Unified Fabric</summary>
<p>If deploying a multi-site fabric with AVD, and using a single inventory file to contain all sites, the <strong>evpn_gateway/remote_peers</strong> vars for <code>bgp_as</code> and <code>ip_address</code> do <strong>NOT</strong> need to be populated.  Since AVD will know about all these nodes from the single inventory file, it will know those variables and be able to use them to render the configuration.  Since we have split the sites for complexity sake, we do have to define them here.</p>
</details>
<h3 id="build-and-deploy-changes-for-evpn-gateway-functionality"><strong>Build and Deploy Changes for EVPN Gateway Functionality</strong><a class="headerlink" href="#build-and-deploy-changes-for-evpn-gateway-functionality" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>make<span class="w"> </span>build-site-1<span class="w"> </span>build-site-2<span class="w"> </span>deploy-site-1<span class="w"> </span>deploy-site-2
</code></pre></div>
<h4 id="verification_3">Verification<a class="headerlink" href="#verification_3" title="Permanent link">&para;</a></h4>
<p>Now lets check and make sure the correct configurations were build and applied, and the EVPN gateways are functioning.</p>
<p>From nodes <code>s1-brdr1</code> and <code>s1-brdr2</code>, we can check the following show commands.</p>
<ol>
<li>
<p>Verify the new BGP configurations were rendered and applied for the remote gateways.</p>
<p><ins>Command</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a>show run section bgp
</code></pre></div>
<p>Look for the below new configurations relevant to the EVPN gateways.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">s1-brdr1</label><label for="__tabbed_2_2">s1-brdr2</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>router bgp 65103
<a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a>  ...
<a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a>  neighbor EVPN-OVERLAY-CORE peer group
<a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a>  neighbor EVPN-OVERLAY-CORE update-source Loopback0
<a id="__codelineno-54-5" name="__codelineno-54-5" href="#__codelineno-54-5"></a>  neighbor EVPN-OVERLAY-CORE bfd
<a id="__codelineno-54-6" name="__codelineno-54-6" href="#__codelineno-54-6"></a>  neighbor EVPN-OVERLAY-CORE ebgp-multihop 15
<a id="__codelineno-54-7" name="__codelineno-54-7" href="#__codelineno-54-7"></a>  neighbor EVPN-OVERLAY-CORE send-community
<a id="__codelineno-54-8" name="__codelineno-54-8" href="#__codelineno-54-8"></a>  neighbor EVPN-OVERLAY-CORE maximum-routes 0
<a id="__codelineno-54-9" name="__codelineno-54-9" href="#__codelineno-54-9"></a>  ...
<a id="__codelineno-54-10" name="__codelineno-54-10" href="#__codelineno-54-10"></a>  neighbor 10.255.2.7 peer group EVPN-OVERLAY-CORE
<a id="__codelineno-54-11" name="__codelineno-54-11" href="#__codelineno-54-11"></a>  neighbor 10.255.2.7 remote-as 65203
<a id="__codelineno-54-12" name="__codelineno-54-12" href="#__codelineno-54-12"></a>  neighbor 10.255.2.7 description s2-brdr1
<a id="__codelineno-54-13" name="__codelineno-54-13" href="#__codelineno-54-13"></a>  ...
<a id="__codelineno-54-14" name="__codelineno-54-14" href="#__codelineno-54-14"></a>  vlan 10
<a id="__codelineno-54-15" name="__codelineno-54-15" href="#__codelineno-54-15"></a>      ...
<a id="__codelineno-54-16" name="__codelineno-54-16" href="#__codelineno-54-16"></a>      route-target import export evpn domain remote 10010:10010
<a id="__codelineno-54-17" name="__codelineno-54-17" href="#__codelineno-54-17"></a>      ...
<a id="__codelineno-54-18" name="__codelineno-54-18" href="#__codelineno-54-18"></a>  !
<a id="__codelineno-54-19" name="__codelineno-54-19" href="#__codelineno-54-19"></a>  vlan 20
<a id="__codelineno-54-20" name="__codelineno-54-20" href="#__codelineno-54-20"></a>      ...
<a id="__codelineno-54-21" name="__codelineno-54-21" href="#__codelineno-54-21"></a>      route-target import export evpn domain remote 10020:10020
<a id="__codelineno-54-22" name="__codelineno-54-22" href="#__codelineno-54-22"></a>      ...
<a id="__codelineno-54-23" name="__codelineno-54-23" href="#__codelineno-54-23"></a>  !
<a id="__codelineno-54-24" name="__codelineno-54-24" href="#__codelineno-54-24"></a>  address-family evpn
<a id="__codelineno-54-25" name="__codelineno-54-25" href="#__codelineno-54-25"></a>      neighbor EVPN-OVERLAY-CORE activate
<a id="__codelineno-54-26" name="__codelineno-54-26" href="#__codelineno-54-26"></a>      neighbor EVPN-OVERLAY-CORE domain remote
<a id="__codelineno-54-27" name="__codelineno-54-27" href="#__codelineno-54-27"></a>      ...
<a id="__codelineno-54-28" name="__codelineno-54-28" href="#__codelineno-54-28"></a>      neighbor default next-hop-self received-evpn-routes route-type ip-prefix inter-domain
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>router bgp 65103
<a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a>  ...
<a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a>  neighbor EVPN-OVERLAY-CORE peer group
<a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a>  neighbor EVPN-OVERLAY-CORE update-source Loopback0
<a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a>  neighbor EVPN-OVERLAY-CORE bfd
<a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a>  neighbor EVPN-OVERLAY-CORE ebgp-multihop 15
<a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a>  neighbor EVPN-OVERLAY-CORE send-community
<a id="__codelineno-55-8" name="__codelineno-55-8" href="#__codelineno-55-8"></a>  neighbor EVPN-OVERLAY-CORE maximum-routes 0
<a id="__codelineno-55-9" name="__codelineno-55-9" href="#__codelineno-55-9"></a>  ...
<a id="__codelineno-55-10" name="__codelineno-55-10" href="#__codelineno-55-10"></a>  neighbor 10.255.2.8 peer group EVPN-OVERLAY-CORE
<a id="__codelineno-55-11" name="__codelineno-55-11" href="#__codelineno-55-11"></a>  neighbor 10.255.2.8 remote-as 65203
<a id="__codelineno-55-12" name="__codelineno-55-12" href="#__codelineno-55-12"></a>  neighbor 10.255.2.8 description s2-brdr2
<a id="__codelineno-55-13" name="__codelineno-55-13" href="#__codelineno-55-13"></a>  ...
<a id="__codelineno-55-14" name="__codelineno-55-14" href="#__codelineno-55-14"></a>  vlan 10
<a id="__codelineno-55-15" name="__codelineno-55-15" href="#__codelineno-55-15"></a>      ...
<a id="__codelineno-55-16" name="__codelineno-55-16" href="#__codelineno-55-16"></a>      route-target import export evpn domain remote 10010:10010
<a id="__codelineno-55-17" name="__codelineno-55-17" href="#__codelineno-55-17"></a>      ...
<a id="__codelineno-55-18" name="__codelineno-55-18" href="#__codelineno-55-18"></a>  !
<a id="__codelineno-55-19" name="__codelineno-55-19" href="#__codelineno-55-19"></a>  vlan 20
<a id="__codelineno-55-20" name="__codelineno-55-20" href="#__codelineno-55-20"></a>      ...
<a id="__codelineno-55-21" name="__codelineno-55-21" href="#__codelineno-55-21"></a>      route-target import export evpn domain remote 10020:10020
<a id="__codelineno-55-22" name="__codelineno-55-22" href="#__codelineno-55-22"></a>      ...
<a id="__codelineno-55-23" name="__codelineno-55-23" href="#__codelineno-55-23"></a>  !
<a id="__codelineno-55-24" name="__codelineno-55-24" href="#__codelineno-55-24"></a>  address-family evpn
<a id="__codelineno-55-25" name="__codelineno-55-25" href="#__codelineno-55-25"></a>      neighbor EVPN-OVERLAY-CORE activate
<a id="__codelineno-55-26" name="__codelineno-55-26" href="#__codelineno-55-26"></a>      neighbor EVPN-OVERLAY-CORE domain remote
<a id="__codelineno-55-27" name="__codelineno-55-27" href="#__codelineno-55-27"></a>      ...
<a id="__codelineno-55-28" name="__codelineno-55-28" href="#__codelineno-55-28"></a>      neighbor default next-hop-self received-evpn-routes route-type ip-prefix inter-domain
</code></pre></div>
</div>
</div>
</div>
</li>
<li>
<p>Verify the EVPN overlay peerings to Site 2.</p>
<p><ins>Command</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a>show bgp evpn summary
</code></pre></div>
<p>Look for the peerings to the corresponding Site 2 node.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">s1-brdr1</label><label for="__tabbed_3_2">s1-brdr2</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a>s1-brdr1#sho bgp evpn summ
<a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a>BGP summary information for VRF default
<a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a>Router identifier 10.250.1.7, local AS number 65103
<a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a>Neighbor Status Codes: m - Under maintenance
<a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a>  Description              Neighbor   V AS           MsgRcvd   MsgSent  InQ OutQ  Up/Down State   PfxRcd PfxAcc
<a id="__codelineno-57-6" name="__codelineno-57-6" href="#__codelineno-57-6"></a>  s1-spine1                10.250.1.1 4 65100            151       150    0    0 01:37:10 Estab   20     20
<a id="__codelineno-57-7" name="__codelineno-57-7" href="#__codelineno-57-7"></a>  s1-spine2                10.250.1.2 4 65100            152       151    0    0 01:37:11 Estab   20     20
<a id="__codelineno-57-8" name="__codelineno-57-8" href="#__codelineno-57-8"></a><span class="hll">  s2-brdr1                 10.250.2.7 4 65203             14        14    0    0 00:00:08 Estab   19     19
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a>s1-brdr2#show bgp evpn summary
<a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a>BGP summary information for VRF default
<a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a>Router identifier 10.250.1.8, local AS number 65103
<a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a>Neighbor Status Codes: m - Under maintenance
<a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a>  Description              Neighbor   V AS           MsgRcvd   MsgSent  InQ OutQ  Up/Down State   PfxRcd PfxAcc
<a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a>  s1-spine1                10.250.1.1 4 65100            158       152    0    0 01:38:37 Estab   20     20
<a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a>  s1-spine2                10.250.1.2 4 65100            156       147    0    0 01:38:37 Estab   20     20
<a id="__codelineno-58-8" name="__codelineno-58-8" href="#__codelineno-58-8"></a><span class="hll">  s2-brdr2                 10.250.2.8 4 65203             15        15    0    0 00:01:35 Estab   19     19
</span></code></pre></div>
</div>
</div>
</div>
</li>
<li>
<p>Finally, lets verify which routes we are seeing in the EVPN table from Site 2.  If you recall when we checked this within each site, we had an <strong>IMET</strong> route per VLAN, from each VTEP.  In this instance, since we are using EVPN gateway functionality to summarize the routes from the other site, we should only see 1 <strong>IMET</strong> route per VLAN to the remote EVPN gateway.</p>
<p><ins>Command</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a>show bgp evpn route-type imet
</code></pre></div>
<p><ins>Expected Output</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a>s1-brdr1#sho bgp evpn route-type imet
<a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a>BGP routing table information for VRF default
<a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a>Router identifier 10.250.1.7, local AS number 65103
<a id="__codelineno-60-4" name="__codelineno-60-4" href="#__codelineno-60-4"></a>Route status codes: * - valid, &gt; - active, S - Stale, E - ECMP head, e - ECMP
<a id="__codelineno-60-5" name="__codelineno-60-5" href="#__codelineno-60-5"></a>                    c - Contributing to ECMP, % - Pending best path selection
<a id="__codelineno-60-6" name="__codelineno-60-6" href="#__codelineno-60-6"></a>Origin codes: i - IGP, e - EGP, ? - incomplete
<a id="__codelineno-60-7" name="__codelineno-60-7" href="#__codelineno-60-7"></a>AS Path Attributes: Or-ID - Originator ID, C-LST - Cluster List, LL Nexthop - Link Local Nexthop
<a id="__codelineno-60-8" name="__codelineno-60-8" href="#__codelineno-60-8"></a>
<a id="__codelineno-60-9" name="__codelineno-60-9" href="#__codelineno-60-9"></a>          Network                Next Hop              Metric  LocPref Weight  Path
<a id="__codelineno-60-10" name="__codelineno-60-10" href="#__codelineno-60-10"></a>* &gt;Ec    RD: 10.250.1.3:10010 imet 10.255.1.3
<a id="__codelineno-60-11" name="__codelineno-60-11" href="#__codelineno-60-11"></a>                                10.255.1.3            -       100     0       65100 65101 i
<a id="__codelineno-60-12" name="__codelineno-60-12" href="#__codelineno-60-12"></a>*  ec    RD: 10.250.1.3:10010 imet 10.255.1.3
<a id="__codelineno-60-13" name="__codelineno-60-13" href="#__codelineno-60-13"></a>                                10.255.1.3            -       100     0       65100 65101 i
<a id="__codelineno-60-14" name="__codelineno-60-14" href="#__codelineno-60-14"></a>* &gt;Ec    RD: 10.250.1.3:10020 imet 10.255.1.3
<a id="__codelineno-60-15" name="__codelineno-60-15" href="#__codelineno-60-15"></a>                                10.255.1.3            -       100     0       65100 65101 i
<a id="__codelineno-60-16" name="__codelineno-60-16" href="#__codelineno-60-16"></a>*  ec    RD: 10.250.1.3:10020 imet 10.255.1.3
<a id="__codelineno-60-17" name="__codelineno-60-17" href="#__codelineno-60-17"></a>                                10.255.1.3            -       100     0       65100 65101 i
<a id="__codelineno-60-18" name="__codelineno-60-18" href="#__codelineno-60-18"></a>* &gt;Ec    RD: 10.250.1.4:10010 imet 10.255.1.3
<a id="__codelineno-60-19" name="__codelineno-60-19" href="#__codelineno-60-19"></a>                                10.255.1.3            -       100     0       65100 65101 i
<a id="__codelineno-60-20" name="__codelineno-60-20" href="#__codelineno-60-20"></a>*  ec    RD: 10.250.1.4:10010 imet 10.255.1.3
<a id="__codelineno-60-21" name="__codelineno-60-21" href="#__codelineno-60-21"></a>                                10.255.1.3            -       100     0       65100 65101 i
<a id="__codelineno-60-22" name="__codelineno-60-22" href="#__codelineno-60-22"></a>* &gt;Ec    RD: 10.250.1.4:10020 imet 10.255.1.3
<a id="__codelineno-60-23" name="__codelineno-60-23" href="#__codelineno-60-23"></a>                                10.255.1.3            -       100     0       65100 65101 i
<a id="__codelineno-60-24" name="__codelineno-60-24" href="#__codelineno-60-24"></a>*  ec    RD: 10.250.1.4:10020 imet 10.255.1.3
<a id="__codelineno-60-25" name="__codelineno-60-25" href="#__codelineno-60-25"></a>                                10.255.1.3            -       100     0       65100 65101 i
<a id="__codelineno-60-26" name="__codelineno-60-26" href="#__codelineno-60-26"></a>* &gt;Ec    RD: 10.250.1.5:10010 imet 10.255.1.5
<a id="__codelineno-60-27" name="__codelineno-60-27" href="#__codelineno-60-27"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-60-28" name="__codelineno-60-28" href="#__codelineno-60-28"></a>*  ec    RD: 10.250.1.5:10010 imet 10.255.1.5
<a id="__codelineno-60-29" name="__codelineno-60-29" href="#__codelineno-60-29"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-60-30" name="__codelineno-60-30" href="#__codelineno-60-30"></a>* &gt;Ec    RD: 10.250.1.5:10020 imet 10.255.1.5
<a id="__codelineno-60-31" name="__codelineno-60-31" href="#__codelineno-60-31"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-60-32" name="__codelineno-60-32" href="#__codelineno-60-32"></a>*  ec    RD: 10.250.1.5:10020 imet 10.255.1.5
<a id="__codelineno-60-33" name="__codelineno-60-33" href="#__codelineno-60-33"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-60-34" name="__codelineno-60-34" href="#__codelineno-60-34"></a>* &gt;Ec    RD: 10.250.1.6:10010 imet 10.255.1.5
<a id="__codelineno-60-35" name="__codelineno-60-35" href="#__codelineno-60-35"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-60-36" name="__codelineno-60-36" href="#__codelineno-60-36"></a>*  ec    RD: 10.250.1.6:10010 imet 10.255.1.5
<a id="__codelineno-60-37" name="__codelineno-60-37" href="#__codelineno-60-37"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-60-38" name="__codelineno-60-38" href="#__codelineno-60-38"></a>* &gt;Ec    RD: 10.250.1.6:10020 imet 10.255.1.5
<a id="__codelineno-60-39" name="__codelineno-60-39" href="#__codelineno-60-39"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-60-40" name="__codelineno-60-40" href="#__codelineno-60-40"></a>*  ec    RD: 10.250.1.6:10020 imet 10.255.1.5
<a id="__codelineno-60-41" name="__codelineno-60-41" href="#__codelineno-60-41"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-60-42" name="__codelineno-60-42" href="#__codelineno-60-42"></a>* &gt;      RD: 10.250.1.7:10010 imet 10.255.1.7
<a id="__codelineno-60-43" name="__codelineno-60-43" href="#__codelineno-60-43"></a>                                -                     -       -       0       i
<a id="__codelineno-60-44" name="__codelineno-60-44" href="#__codelineno-60-44"></a>* &gt;      RD: 10.250.1.7:10020 imet 10.255.1.7
<a id="__codelineno-60-45" name="__codelineno-60-45" href="#__codelineno-60-45"></a>                                -                     -       -       0       i
<a id="__codelineno-60-46" name="__codelineno-60-46" href="#__codelineno-60-46"></a>* &gt;      RD: 10.250.1.7:10010 imet 10.255.1.7 remote
<a id="__codelineno-60-47" name="__codelineno-60-47" href="#__codelineno-60-47"></a>                                -                     -       -       0       i
<a id="__codelineno-60-48" name="__codelineno-60-48" href="#__codelineno-60-48"></a>* &gt;      RD: 10.250.1.7:10020 imet 10.255.1.7 remote
<a id="__codelineno-60-49" name="__codelineno-60-49" href="#__codelineno-60-49"></a>                                -                     -       -       0       i
<a id="__codelineno-60-50" name="__codelineno-60-50" href="#__codelineno-60-50"></a><span class="hll">* &gt;      RD: 10.250.2.7:10010 imet 10.255.2.7 remote
</span><a id="__codelineno-60-51" name="__codelineno-60-51" href="#__codelineno-60-51"></a><span class="hll">                                10.255.2.7            -       100     0       65203 i
</span><a id="__codelineno-60-52" name="__codelineno-60-52" href="#__codelineno-60-52"></a><span class="hll">* &gt;      RD: 10.250.2.7:10020 imet 10.255.2.7 remote
</span><a id="__codelineno-60-53" name="__codelineno-60-53" href="#__codelineno-60-53"></a><span class="hll">                                10.255.2.7            -       100     0       65203 i
</span></code></pre></div>
</li>
</ol>
<details class="success" open="open">
<summary>EVPN Gateways Active</summary>
<p>If all your peerings are established and you have the correct IMET routes in the EVPN table, then your EVPN gateways are functioning!  Lets move on to a final connectivity test.</p>
</details>
<h2 id="final-fabric-test"><strong>Final Fabric Test</strong><a class="headerlink" href="#final-fabric-test" title="Permanent link">&para;</a></h2>
<p>At this point your full Layer 3 Leaf Spine with EVPN VXLAN and EVPN gateway functionality should be ready to go. Lets perform some final tests to verify everything is working.</p>
<p>From <code>s1-host1</code> ping both <code>s2-host1</code> &amp; <code>s2-host2</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="c1"># s2-host1</span>
<a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a>ping<span class="w"> </span><span class="m">10</span>.10.10.200
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a><span class="c1"># s2-host2</span>
<a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a>ping<span class="w"> </span><span class="m">10</span>.20.20.200
</code></pre></div>
<details class="success" open="open">
<summary>Great Success!</summary>
<p>You have built a multi-site L3LS network with an EVPN/VXLAN overlay and EVPN Gateway functionality without touching the CLI on a single switch!</p>
</details>
<h1 id="day-2-operations"><strong>Day 2 Operations</strong><a class="headerlink" href="#day-2-operations" title="Permanent link">&para;</a></h1>
<p>Our multi-site L3LS EVPN/VXLAN network is working great. But, before too long, it will be time to change
our configurations. Lucky for us, that time is today!</p>
<h2 id="cleaning-up"><strong>Cleaning Up</strong><a class="headerlink" href="#cleaning-up" title="Permanent link">&para;</a></h2>
<p>Before going any further, let's ensure we have a clean repo by committing the changes we've made
up to this point. The CLI commands below can accomplish this, but the VS Code Source Control GUI
can be used as well.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a>git<span class="w"> </span>add<span class="w"> </span>.
<a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;Your message here&#39;</span>
</code></pre></div>
<p>Next, we'll want to push these changes to our forked repository on GitHub.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a>git<span class="w"> </span>push
</code></pre></div>
<p>If this is our first time pushing to our forked repository, then VS Code will provide us with the following
sign-in prompt:</p>
<p><a class="glightbox" href="../../assets/images/git_login_request.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="VS Code GitHub Sign in Prompt" src="../../assets/images/git_login_request.png" style="width:400px" /></a></p>
<p>Choose <strong>Allow</strong>, and another prompt will come up, showing your unique login code:</p>
<p><a class="glightbox" href="../../assets/images/git_login_code.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="VS Code GitHub Login Code Prompt" src="../../assets/images/git_login_code.png" style="width:400px" /></a></p>
<p>Choose <strong>Copy &amp; Continue to GitHub</strong>, and <em>another</em> prompt will come up asking if it's ok to open an external website (GitHub).</p>
<p><a class="glightbox" href="../../assets/images/git_login_external_site.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="VS Code External Site Prompt" src="../../assets/images/git_login_external_site.png" style="width:400px" /></a></p>
<p>Choose <strong>Open</strong> and then an external site (GitHub) will open, asking for your login code.</p>
<p><a class="glightbox" href="../../assets/images/git_login_code_entry.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="GitHub Login Code Entry" src="../../assets/images/git_login_code_entry.png" style="width:400px" /></a></p>
<p>Paste in your login code and choose <strong>Continue</strong>. You will then be prompted to Authorize VS Code.</p>
<p><a class="glightbox" href="../../assets/images/git_login_authorize_vscode.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="GitHub Authorize VS Code" src="../../assets/images/git_login_authorize_vscode.png" style="width:400px" /></a></p>
<p>Choose <strong>Authorize Visual-Studio-Code</strong>, and you should be presented with the coveted Green Check Mark!</p>
<p><a class="glightbox" href="../../assets/images/git_login_complete.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="VS Code Git Login Complete" src="../../assets/images/git_login_complete.png" style="width:400px" /></a></p>
<p>Whew! Alright. Now that we have that complete, let's keep moving...</p>
<h2 id="branching-out"><strong>Branching Out</strong><a class="headerlink" href="#branching-out" title="Permanent link">&para;</a></h2>
<p>Before jumping in and modifying our files, we'll create a branch named <strong>banner-syslog</strong> in our
forked repository to work on our changes. We can create our branch in multiple ways, but we'll use
the <code>git switch</code> command with the <code>-c</code> parameter to create our new branch.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a>git<span class="w"> </span>switch<span class="w"> </span>-c<span class="w"> </span>banner-syslog
</code></pre></div>
<p>After entering this command, we should see our new branch name reflected in the terminal. It will also be
reflected in the status bar in the lower left-hand corner of our VS Code window (you may need to click the refresh icon
before this is shown).</p>
<p>Now we're ready to start working on our changes <img alt="😎" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f60e.svg" title=":sunglasses:" />.</p>
<h2 id="login-banner"><strong>Login Banner</strong><a class="headerlink" href="#login-banner" title="Permanent link">&para;</a></h2>
<p>When we initially deployed our multi-site topology, we should have included a login banner on all our switches.
Let's take a look at the <strong><a href="https://avd.arista.com/4.1/roles/eos_cli_config_gen/docs/tables/banners.html?h=banners">AVD documentation site</a></strong> to see what the
data model is for this configuration.</p>
<p>The banner on all of our switches will be the same. After reviewing the AVD documentation, we know we can accomplish this by defining the <code>banners</code> input variable
in our <code>global_vars/global_dc_vars.yml</code> file.</p>
<p>Add the code block below to <code>global_vars/global_dc_vars.yml</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a><span class="c1"># Login Banner</span>
<a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a><span class="nt">banners</span><span class="p">:</span>
<a id="__codelineno-66-3" name="__codelineno-66-3" href="#__codelineno-66-3"></a><span class="w">  </span><span class="nt">motd</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-66-4" name="__codelineno-66-4" href="#__codelineno-66-4"></a><span class="w">    </span><span class="no">You shall not pass. Unless you are authorized. Then you shall pass.</span>
<a id="__codelineno-66-5" name="__codelineno-66-5" href="#__codelineno-66-5"></a><span class="w">    </span><span class="no">EOF</span>
</code></pre></div>
<details class="danger" open="open">
<summary>Yes, that "EOF" is important!</summary>
<p>Ensure the entire code snippet above is copied; including the <code>EOF</code>. This must be present for the configuration to be
considered valid</p>
</details>
<p>Next, let's build out the configurations and documentation associated with this change.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a>make<span class="w"> </span>build-site-1<span class="w"> </span>build-site-2
</code></pre></div>
<p>Please take a minute to review the results of our five lines of YAML. When finished reviewing the changes, let's commit them.</p>
<p>As usual, there are a few ways of doing this, but the CLI commands below will get the job done:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a>git<span class="w"> </span>add<span class="w"> </span>.
<a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;add banner&#39;</span>
</code></pre></div>
<p>So far, so good! Before we publish our branch and create a Pull Request though, we have some more work to do...</p>
<h2 id="syslog-server"><strong>Syslog Server</strong><a class="headerlink" href="#syslog-server" title="Permanent link">&para;</a></h2>
<p>Our next Day 2 change is adding a syslog server configuration to all our switches. Once again, we'll take
a look at the <strong><a href="https://avd.arista.com/4.1/roles/eos_cli_config_gen/docs/tables/logging.html?h=logging">AVD documentation site</a></strong> to see the
data model associated with the <code>logging</code> input variable.</p>
<p>Like our banner operation, the syslog server configuration will be consistent on all our switches. Because of this, we can also put this into
our <code>global_vars/global_dc_vars.yml</code> file.</p>
<p>Add the code block below to <code>global_vars/global_dc_vars.yml</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="c1"># Syslog</span>
<a id="__codelineno-69-2" name="__codelineno-69-2" href="#__codelineno-69-2"></a><span class="nt">logging</span><span class="p">:</span>
<a id="__codelineno-69-3" name="__codelineno-69-3" href="#__codelineno-69-3"></a><span class="w">  </span><span class="nt">vrfs</span><span class="p">:</span>
<a id="__codelineno-69-4" name="__codelineno-69-4" href="#__codelineno-69-4"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<a id="__codelineno-69-5" name="__codelineno-69-5" href="#__codelineno-69-5"></a><span class="w">      </span><span class="nt">source_interface</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Management0</span>
<a id="__codelineno-69-6" name="__codelineno-69-6" href="#__codelineno-69-6"></a><span class="w">      </span><span class="nt">hosts</span><span class="p">:</span>
<a id="__codelineno-69-7" name="__codelineno-69-7" href="#__codelineno-69-7"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.200.0.108</span>
<a id="__codelineno-69-8" name="__codelineno-69-8" href="#__codelineno-69-8"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.200.1.108</span>
</code></pre></div>
<p>Finally, let's build out our configurations.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a>make<span class="w"> </span>build-site-1<span class="w"> </span>build-site-2
</code></pre></div>
<p>Take a minute, using the source control feature in VS Code, to review what has changed as a result
of our work.</p>
<p>At this point, we have our Banner and Syslog configurations in place. The configurations look good,
and we're ready to share this with our team for review. In other words, <strong>it's time to publish our branch
to the remote origin</strong> (our forked repo on GitHub) and create the Pull Request (PR)!</p>
<p>There are a few ways to publish the <code>banner-syslog</code> branch to our forked repository. The commands below will
accomplish this via the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a>git<span class="w"> </span>add<span class="w"> </span>.
<a id="__codelineno-71-2" name="__codelineno-71-2" href="#__codelineno-71-2"></a>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;add syslog&#39;</span>
<a id="__codelineno-71-3" name="__codelineno-71-3" href="#__codelineno-71-3"></a>git<span class="w"> </span>push<span class="w"> </span>--set-upstream<span class="w"> </span>origin<span class="w"> </span>banner-syslog
</code></pre></div>
<p>On our forked repository, let's create the Pull Request.</p>
<p>When creating the PR, ensure that the <code>base repository</code> is the <strong>main</strong> branch of <strong>your fork</strong>. This can
be selected via the dropdown as shown below:</p>
<p><a class="glightbox" href="../../assets/images/pr_open_request.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="PR Base Repository Selection" src="../../assets/images/pr_open_request.png" style="width:800px" /></a></p>
<p>Take a minute to review the contents of the PR. Assuming all looks good, let's earn the <strong>YOLO</strong> GitHub badge
by approving and merging your PR!</p>
<details class="tip" open="open">
<summary>Tip</summary>
<p>Remember to delete the <strong>banner-syslog</strong> branch after performing the merge - Keep that repo clean!</p>
</details>
<p>Once merged, let's switch back to our <code>main</code> branch and pull down our merged changes.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a>git<span class="w"> </span>switch<span class="w"> </span>main
<a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a>git<span class="w"> </span>pull
</code></pre></div>
<p>Then, let's delete our now defunct <strong>banner-syslog</strong> branch.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a>git<span class="w"> </span>branch<span class="w"> </span>-D<span class="w"> </span>banner-syslog
</code></pre></div>
<p>Finally, let's deploy our changes.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a>make<span class="w"> </span>deploy-site-1<span class="w"> </span>deploy-site-2
</code></pre></div>
<p>Once completed, we should see our banner when logging into any switch. The output of the <code>show logging</code> command
should also have our newly defined syslog servers.</p>
<h2 id="adding-additional-vlans"><strong>Adding additional VLANs</strong><a class="headerlink" href="#adding-additional-vlans" title="Permanent link">&para;</a></h2>
<p>One of the many benefits of AVD is the ability to deploy new services very quickly and efficiently by modifying a small amount of data model. Lets add some new VLANs to our fabric.</p>
<p>For this we will need to modify the two <code>_NETWORK_SERVICES.yml</code> data model vars files. To keep things simple we will add two new VLANs, <strong>30</strong> and <strong>40</strong>.</p>
<p>Copy the following pieces of data model, and paste right below the last VLAN entry, in both <code>SITE1_NETWORK_SERVICES.yml</code> and <code>SITE2_NETWORK_SERVICES.yml</code>.  Ensure the <code>-id:</code> entries all line up.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Thirty&#39;</span>
<a id="__codelineno-75-3" name="__codelineno-75-3" href="#__codelineno-75-3"></a><span class="w">  </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-75-4" name="__codelineno-75-4" href="#__codelineno-75-4"></a><span class="w">  </span><span class="nt">ip_address_virtual</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.30.30.1/24</span>
<a id="__codelineno-75-5" name="__codelineno-75-5" href="#__codelineno-75-5"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">40</span>
<a id="__codelineno-75-6" name="__codelineno-75-6" href="#__codelineno-75-6"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Forty&#39;</span>
<a id="__codelineno-75-7" name="__codelineno-75-7" href="#__codelineno-75-7"></a><span class="w">  </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-75-8" name="__codelineno-75-8" href="#__codelineno-75-8"></a><span class="w">  </span><span class="nt">ip_address_virtual</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.40.40.1/24</span>
</code></pre></div>
<p>When complete, your vars file should look like this.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a><span class="nn">---</span>
<a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a><span class="nt">tenants</span><span class="p">:</span>
<a id="__codelineno-76-3" name="__codelineno-76-3" href="#__codelineno-76-3"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">S2_FABRIC</span>
<a id="__codelineno-76-4" name="__codelineno-76-4" href="#__codelineno-76-4"></a><span class="w">    </span><span class="nt">mac_vrf_vni_base</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10000</span>
<a id="__codelineno-76-5" name="__codelineno-76-5" href="#__codelineno-76-5"></a><span class="w">    </span><span class="nt">vrfs</span><span class="p">:</span>
<a id="__codelineno-76-6" name="__codelineno-76-6" href="#__codelineno-76-6"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">OVERLAY</span>
<a id="__codelineno-76-7" name="__codelineno-76-7" href="#__codelineno-76-7"></a><span class="w">        </span><span class="nt">vrf_vni</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<a id="__codelineno-76-8" name="__codelineno-76-8" href="#__codelineno-76-8"></a><span class="w">        </span><span class="nt">svis</span><span class="p">:</span>
<a id="__codelineno-76-9" name="__codelineno-76-9" href="#__codelineno-76-9"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<a id="__codelineno-76-10" name="__codelineno-76-10" href="#__codelineno-76-10"></a><span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Ten&#39;</span>
<a id="__codelineno-76-11" name="__codelineno-76-11" href="#__codelineno-76-11"></a><span class="w">            </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-76-12" name="__codelineno-76-12" href="#__codelineno-76-12"></a><span class="w">            </span><span class="nt">ip_address_virtual</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.10.10.1/24</span>
<a id="__codelineno-76-13" name="__codelineno-76-13" href="#__codelineno-76-13"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span>
<a id="__codelineno-76-14" name="__codelineno-76-14" href="#__codelineno-76-14"></a><span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Twenty&#39;</span>
<a id="__codelineno-76-15" name="__codelineno-76-15" href="#__codelineno-76-15"></a><span class="w">            </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-76-16" name="__codelineno-76-16" href="#__codelineno-76-16"></a><span class="w">            </span><span class="nt">ip_address_virtual</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.20.1/24</span>
<a id="__codelineno-76-17" name="__codelineno-76-17" href="#__codelineno-76-17"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<a id="__codelineno-76-18" name="__codelineno-76-18" href="#__codelineno-76-18"></a><span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Thirty&#39;</span>
<a id="__codelineno-76-19" name="__codelineno-76-19" href="#__codelineno-76-19"></a><span class="w">            </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-76-20" name="__codelineno-76-20" href="#__codelineno-76-20"></a><span class="w">            </span><span class="nt">ip_address_virtual</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.30.30.1/24</span>
<a id="__codelineno-76-21" name="__codelineno-76-21" href="#__codelineno-76-21"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">40</span>
<a id="__codelineno-76-22" name="__codelineno-76-22" href="#__codelineno-76-22"></a><span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Forty&#39;</span>
<a id="__codelineno-76-23" name="__codelineno-76-23" href="#__codelineno-76-23"></a><span class="w">            </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-76-24" name="__codelineno-76-24" href="#__codelineno-76-24"></a><span class="w">            </span><span class="nt">ip_address_virtual</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.40.40.1/24</span>
</code></pre></div>
<p>Finally, let's build out and deploy our configurations.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a>make<span class="w"> </span>build-site-1<span class="w"> </span>build-site-2<span class="w"> </span>deploy-site-1<span class="w"> </span>deploy-site-2
</code></pre></div>
<h3 id="verification_4">Verification<a class="headerlink" href="#verification_4" title="Permanent link">&para;</a></h3>
<p>Now lets jump into one of the nodes, <code>s1-leaf1</code>, and check that our new VLAN SVIs were configured, as well as what we see in the VXLAN interface and EVPN table for both local and remote VTEPs.</p>
<ol>
<li>
<p>Check that the VLAN SVIs were configured.</p>
<p><ins>Command</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a>show ip interface brief
</code></pre></div>
<p><ins>Expected Output</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a>s1-leaf1#show ip interface brief
<a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a>                                                                                Address
<a id="__codelineno-79-3" name="__codelineno-79-3" href="#__codelineno-79-3"></a>Interface         IP Address            Status       Protocol            MTU    Owner
<a id="__codelineno-79-4" name="__codelineno-79-4" href="#__codelineno-79-4"></a>----------------- --------------------- ------------ -------------- ----------- -------
<a id="__codelineno-79-5" name="__codelineno-79-5" href="#__codelineno-79-5"></a>Ethernet2         172.16.1.1/31         up           up                 1500
<a id="__codelineno-79-6" name="__codelineno-79-6" href="#__codelineno-79-6"></a>Ethernet3         172.16.1.3/31         up           up                 1500
<a id="__codelineno-79-7" name="__codelineno-79-7" href="#__codelineno-79-7"></a>Loopback0         10.250.1.3/32         up           up                65535
<a id="__codelineno-79-8" name="__codelineno-79-8" href="#__codelineno-79-8"></a>Loopback1         10.255.1.3/32         up           up                65535
<a id="__codelineno-79-9" name="__codelineno-79-9" href="#__codelineno-79-9"></a>Management0       192.168.0.12/24       up           up                 1500
<a id="__codelineno-79-10" name="__codelineno-79-10" href="#__codelineno-79-10"></a>Vlan10            10.10.10.1/24         up           up                 1500
<a id="__codelineno-79-11" name="__codelineno-79-11" href="#__codelineno-79-11"></a>Vlan20            10.20.20.1/24         up           up                 1500
<a id="__codelineno-79-12" name="__codelineno-79-12" href="#__codelineno-79-12"></a><span class="hll">Vlan30            10.30.30.1/24         up           up                 1500
</span><a id="__codelineno-79-13" name="__codelineno-79-13" href="#__codelineno-79-13"></a><span class="hll">Vlan40            10.40.40.1/24         up           up                 1500
</span><a id="__codelineno-79-14" name="__codelineno-79-14" href="#__codelineno-79-14"></a>Vlan1199          unassigned            up           up                 9164
<a id="__codelineno-79-15" name="__codelineno-79-15" href="#__codelineno-79-15"></a>Vlan3009          10.252.1.0/31         up           up                 1500
<a id="__codelineno-79-16" name="__codelineno-79-16" href="#__codelineno-79-16"></a>Vlan4093          10.252.1.0/31         up           up                 1500
<a id="__codelineno-79-17" name="__codelineno-79-17" href="#__codelineno-79-17"></a>Vlan4094          10.251.1.0/31         up           up                 1500
</code></pre></div>
</li>
<li>
<p>Lets check the <code>VXLAN 1</code> interface and see what changes were made there.</p>
<p><ins>Command</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a>show run interface vxlan 1
</code></pre></div>
<p><ins>Expected Output</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a>s1-leaf1#show run interface vxlan 1
<a id="__codelineno-81-2" name="__codelineno-81-2" href="#__codelineno-81-2"></a>interface Vxlan1
<a id="__codelineno-81-3" name="__codelineno-81-3" href="#__codelineno-81-3"></a>  description s1-leaf1_VTEP
<a id="__codelineno-81-4" name="__codelineno-81-4" href="#__codelineno-81-4"></a>  vxlan source-interface Loopback1
<a id="__codelineno-81-5" name="__codelineno-81-5" href="#__codelineno-81-5"></a>  vxlan virtual-router encapsulation mac-address mlag-system-id
<a id="__codelineno-81-6" name="__codelineno-81-6" href="#__codelineno-81-6"></a>  vxlan udp-port 4789
<a id="__codelineno-81-7" name="__codelineno-81-7" href="#__codelineno-81-7"></a>  vxlan vlan 10 vni 10010
<a id="__codelineno-81-8" name="__codelineno-81-8" href="#__codelineno-81-8"></a>  vxlan vlan 20 vni 10020
<a id="__codelineno-81-9" name="__codelineno-81-9" href="#__codelineno-81-9"></a><span class="hll">  vxlan vlan 30 vni 10030
</span><a id="__codelineno-81-10" name="__codelineno-81-10" href="#__codelineno-81-10"></a><span class="hll">  vxlan vlan 40 vni 10040
</span><a id="__codelineno-81-11" name="__codelineno-81-11" href="#__codelineno-81-11"></a>  vxlan vrf OVERLAY vni 10
</code></pre></div>
<p><ins>Command</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a>show interface vxlan 1
</code></pre></div>
<p><ins>Expected Output</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a>s1-leaf1#show interface vxlan 1
<a id="__codelineno-83-2" name="__codelineno-83-2" href="#__codelineno-83-2"></a>Vxlan1 is up, line protocol is up (connected)
<a id="__codelineno-83-3" name="__codelineno-83-3" href="#__codelineno-83-3"></a>  Hardware is Vxlan
<a id="__codelineno-83-4" name="__codelineno-83-4" href="#__codelineno-83-4"></a>  Description: s1-leaf1_VTEP
<a id="__codelineno-83-5" name="__codelineno-83-5" href="#__codelineno-83-5"></a>  Source interface is Loopback1 and is active with 10.255.1.3
<a id="__codelineno-83-6" name="__codelineno-83-6" href="#__codelineno-83-6"></a>  Listening on UDP port 4789
<a id="__codelineno-83-7" name="__codelineno-83-7" href="#__codelineno-83-7"></a>  Replication/Flood Mode is headend with Flood List Source: EVPN
<a id="__codelineno-83-8" name="__codelineno-83-8" href="#__codelineno-83-8"></a>  Remote MAC learning via EVPN
<a id="__codelineno-83-9" name="__codelineno-83-9" href="#__codelineno-83-9"></a>  VNI mapping to VLANs
<a id="__codelineno-83-10" name="__codelineno-83-10" href="#__codelineno-83-10"></a>  Static VLAN to VNI mapping is
<a id="__codelineno-83-11" name="__codelineno-83-11" href="#__codelineno-83-11"></a><span class="hll">    [10, 10010]       [20, 10020]       [30, 10030]       [40, 10040]
</span><a id="__codelineno-83-12" name="__codelineno-83-12" href="#__codelineno-83-12"></a>
<a id="__codelineno-83-13" name="__codelineno-83-13" href="#__codelineno-83-13"></a>  Dynamic VLAN to VNI mapping for &#39;evpn&#39; is
<a id="__codelineno-83-14" name="__codelineno-83-14" href="#__codelineno-83-14"></a>    [1199, 10]
<a id="__codelineno-83-15" name="__codelineno-83-15" href="#__codelineno-83-15"></a>  Note: All Dynamic VLANs used by VCS are internal VLANs.
<a id="__codelineno-83-16" name="__codelineno-83-16" href="#__codelineno-83-16"></a>        Use &#39;show vxlan vni&#39; for details.
<a id="__codelineno-83-17" name="__codelineno-83-17" href="#__codelineno-83-17"></a>  Static VRF to VNI mapping is
<a id="__codelineno-83-18" name="__codelineno-83-18" href="#__codelineno-83-18"></a>  [OVERLAY, 10]
<a id="__codelineno-83-19" name="__codelineno-83-19" href="#__codelineno-83-19"></a>  Headend replication flood vtep list is:
<a id="__codelineno-83-20" name="__codelineno-83-20" href="#__codelineno-83-20"></a>    10 10.255.1.5      10.255.1.7
<a id="__codelineno-83-21" name="__codelineno-83-21" href="#__codelineno-83-21"></a>    20 10.255.1.5      10.255.1.7
<a id="__codelineno-83-22" name="__codelineno-83-22" href="#__codelineno-83-22"></a><span class="hll">    30 10.255.1.5      10.255.1.7
</span><a id="__codelineno-83-23" name="__codelineno-83-23" href="#__codelineno-83-23"></a><span class="hll">    40 10.255.1.5      10.255.1.7
</span><a id="__codelineno-83-24" name="__codelineno-83-24" href="#__codelineno-83-24"></a>  MLAG Shared Router MAC is 021c.73c0.c612
</code></pre></div>
</li>
<li>
<p>Now, lets check the EVPN table. We can filter the routes to only the new VLANs by specifying the new VNIs, <strong>10030</strong> and <strong>10040</strong>.</p>
<p><ins>Command</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a>show bgp evpn vni 10030
</code></pre></div>
<p><ins>Expected Output</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a>s1-leaf1#sho bgp evpn vni 10030
<a id="__codelineno-85-2" name="__codelineno-85-2" href="#__codelineno-85-2"></a>BGP routing table information for VRF default
<a id="__codelineno-85-3" name="__codelineno-85-3" href="#__codelineno-85-3"></a>Router identifier 10.250.1.3, local AS number 65101
<a id="__codelineno-85-4" name="__codelineno-85-4" href="#__codelineno-85-4"></a>Route status codes: * - valid, &gt; - active, S - Stale, E - ECMP head, e - ECMP
<a id="__codelineno-85-5" name="__codelineno-85-5" href="#__codelineno-85-5"></a>                    c - Contributing to ECMP, % - Pending best path selection
<a id="__codelineno-85-6" name="__codelineno-85-6" href="#__codelineno-85-6"></a>Origin codes: i - IGP, e - EGP, ? - incomplete
<a id="__codelineno-85-7" name="__codelineno-85-7" href="#__codelineno-85-7"></a>AS Path Attributes: Or-ID - Originator ID, C-LST - Cluster List, LL Nexthop - Link Local Nexthop
<a id="__codelineno-85-8" name="__codelineno-85-8" href="#__codelineno-85-8"></a>
<a id="__codelineno-85-9" name="__codelineno-85-9" href="#__codelineno-85-9"></a>          Network                Next Hop              Metric  LocPref Weight  Path
<a id="__codelineno-85-10" name="__codelineno-85-10" href="#__codelineno-85-10"></a>* &gt;      RD: 10.250.1.3:10030 imet 10.255.1.3
<a id="__codelineno-85-11" name="__codelineno-85-11" href="#__codelineno-85-11"></a>                                -                     -       -       0       i
<a id="__codelineno-85-12" name="__codelineno-85-12" href="#__codelineno-85-12"></a>* &gt;Ec    RD: 10.250.1.5:10030 imet 10.255.1.5
<a id="__codelineno-85-13" name="__codelineno-85-13" href="#__codelineno-85-13"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-85-14" name="__codelineno-85-14" href="#__codelineno-85-14"></a>*  ec    RD: 10.250.1.5:10030 imet 10.255.1.5
<a id="__codelineno-85-15" name="__codelineno-85-15" href="#__codelineno-85-15"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-85-16" name="__codelineno-85-16" href="#__codelineno-85-16"></a>* &gt;Ec    RD: 10.250.1.6:10030 imet 10.255.1.5
<a id="__codelineno-85-17" name="__codelineno-85-17" href="#__codelineno-85-17"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-85-18" name="__codelineno-85-18" href="#__codelineno-85-18"></a>*  ec    RD: 10.250.1.6:10030 imet 10.255.1.5
<a id="__codelineno-85-19" name="__codelineno-85-19" href="#__codelineno-85-19"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-85-20" name="__codelineno-85-20" href="#__codelineno-85-20"></a>* &gt;Ec    RD: 10.250.1.7:10030 imet 10.255.1.7
<a id="__codelineno-85-21" name="__codelineno-85-21" href="#__codelineno-85-21"></a>                                10.255.1.7            -       100     0       65100 65103 i
<a id="__codelineno-85-22" name="__codelineno-85-22" href="#__codelineno-85-22"></a>*  ec    RD: 10.250.1.7:10030 imet 10.255.1.7
<a id="__codelineno-85-23" name="__codelineno-85-23" href="#__codelineno-85-23"></a>                                10.255.1.7            -       100     0       65100 65103 i
<a id="__codelineno-85-24" name="__codelineno-85-24" href="#__codelineno-85-24"></a>* &gt;Ec    RD: 10.250.1.8:10030 imet 10.255.1.7
<a id="__codelineno-85-25" name="__codelineno-85-25" href="#__codelineno-85-25"></a>                                10.255.1.7            -       100     0       65100 65103 i
<a id="__codelineno-85-26" name="__codelineno-85-26" href="#__codelineno-85-26"></a>*  ec    RD: 10.250.1.8:10030 imet 10.255.1.7
<a id="__codelineno-85-27" name="__codelineno-85-27" href="#__codelineno-85-27"></a>                                10.255.1.7            -       100     0       65100 65103 i
</code></pre></div>
<p><ins>Command</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a>show bgp evpn vni 10040
</code></pre></div>
<p><ins>Expected Output</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a>s1-leaf1#sho bgp evpn vni 10040
<a id="__codelineno-87-2" name="__codelineno-87-2" href="#__codelineno-87-2"></a>BGP routing table information for VRF default
<a id="__codelineno-87-3" name="__codelineno-87-3" href="#__codelineno-87-3"></a>Router identifier 10.250.1.3, local AS number 65101
<a id="__codelineno-87-4" name="__codelineno-87-4" href="#__codelineno-87-4"></a>Route status codes: * - valid, &gt; - active, S - Stale, E - ECMP head, e - ECMP
<a id="__codelineno-87-5" name="__codelineno-87-5" href="#__codelineno-87-5"></a>                    c - Contributing to ECMP, % - Pending best path selection
<a id="__codelineno-87-6" name="__codelineno-87-6" href="#__codelineno-87-6"></a>Origin codes: i - IGP, e - EGP, ? - incomplete
<a id="__codelineno-87-7" name="__codelineno-87-7" href="#__codelineno-87-7"></a>AS Path Attributes: Or-ID - Originator ID, C-LST - Cluster List, LL Nexthop - Link Local Nexthop
<a id="__codelineno-87-8" name="__codelineno-87-8" href="#__codelineno-87-8"></a>
<a id="__codelineno-87-9" name="__codelineno-87-9" href="#__codelineno-87-9"></a>          Network                Next Hop              Metric  LocPref Weight  Path
<a id="__codelineno-87-10" name="__codelineno-87-10" href="#__codelineno-87-10"></a>* &gt;      RD: 10.250.1.3:10040 imet 10.255.1.3
<a id="__codelineno-87-11" name="__codelineno-87-11" href="#__codelineno-87-11"></a>                                -                     -       -       0       i
<a id="__codelineno-87-12" name="__codelineno-87-12" href="#__codelineno-87-12"></a>* &gt;Ec    RD: 10.250.1.5:10040 imet 10.255.1.5
<a id="__codelineno-87-13" name="__codelineno-87-13" href="#__codelineno-87-13"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-87-14" name="__codelineno-87-14" href="#__codelineno-87-14"></a>*  ec    RD: 10.250.1.5:10040 imet 10.255.1.5
<a id="__codelineno-87-15" name="__codelineno-87-15" href="#__codelineno-87-15"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-87-16" name="__codelineno-87-16" href="#__codelineno-87-16"></a>* &gt;Ec    RD: 10.250.1.6:10040 imet 10.255.1.5
<a id="__codelineno-87-17" name="__codelineno-87-17" href="#__codelineno-87-17"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-87-18" name="__codelineno-87-18" href="#__codelineno-87-18"></a>*  ec    RD: 10.250.1.6:10040 imet 10.255.1.5
<a id="__codelineno-87-19" name="__codelineno-87-19" href="#__codelineno-87-19"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-87-20" name="__codelineno-87-20" href="#__codelineno-87-20"></a>* &gt;Ec    RD: 10.250.1.7:10040 imet 10.255.1.7
<a id="__codelineno-87-21" name="__codelineno-87-21" href="#__codelineno-87-21"></a>                                10.255.1.7            -       100     0       65100 65103 i
<a id="__codelineno-87-22" name="__codelineno-87-22" href="#__codelineno-87-22"></a>*  ec    RD: 10.250.1.7:10040 imet 10.255.1.7
<a id="__codelineno-87-23" name="__codelineno-87-23" href="#__codelineno-87-23"></a>                                10.255.1.7            -       100     0       65100 65103 i
<a id="__codelineno-87-24" name="__codelineno-87-24" href="#__codelineno-87-24"></a>* &gt;Ec    RD: 10.250.1.8:10040 imet 10.255.1.7
<a id="__codelineno-87-25" name="__codelineno-87-25" href="#__codelineno-87-25"></a>                                10.255.1.7            -       100     0       65100 65103 i
<a id="__codelineno-87-26" name="__codelineno-87-26" href="#__codelineno-87-26"></a>*  ec    RD: 10.250.1.8:10040 imet 10.255.1.7
<a id="__codelineno-87-27" name="__codelineno-87-27" href="#__codelineno-87-27"></a>                                10.255.1.7            -       100     0       65100 65103 i
</code></pre></div>
</li>
<li>
<p>Finally, lets check from <code>s1-brdr1</code> for the remote EVPN gateway.</p>
<p><ins>Command</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a>show bgp evpn vni 10030
</code></pre></div>
<p><ins>Expected Output</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a>s1-brdr1#  sho bgp evpn vni 10030
<a id="__codelineno-89-2" name="__codelineno-89-2" href="#__codelineno-89-2"></a>BGP routing table information for VRF default
<a id="__codelineno-89-3" name="__codelineno-89-3" href="#__codelineno-89-3"></a>Router identifier 10.250.1.7, local AS number 65103
<a id="__codelineno-89-4" name="__codelineno-89-4" href="#__codelineno-89-4"></a>Route status codes: * - valid, &gt; - active, S - Stale, E - ECMP head, e - ECMP
<a id="__codelineno-89-5" name="__codelineno-89-5" href="#__codelineno-89-5"></a>                    c - Contributing to ECMP, % - Pending best path selection
<a id="__codelineno-89-6" name="__codelineno-89-6" href="#__codelineno-89-6"></a>Origin codes: i - IGP, e - EGP, ? - incomplete
<a id="__codelineno-89-7" name="__codelineno-89-7" href="#__codelineno-89-7"></a>AS Path Attributes: Or-ID - Originator ID, C-LST - Cluster List, LL Nexthop - Link Local Nexthop
<a id="__codelineno-89-8" name="__codelineno-89-8" href="#__codelineno-89-8"></a>
<a id="__codelineno-89-9" name="__codelineno-89-9" href="#__codelineno-89-9"></a>          Network                Next Hop              Metric  LocPref Weight  Path
<a id="__codelineno-89-10" name="__codelineno-89-10" href="#__codelineno-89-10"></a>* &gt;Ec    RD: 10.250.1.3:10030 imet 10.255.1.3
<a id="__codelineno-89-11" name="__codelineno-89-11" href="#__codelineno-89-11"></a>                                10.255.1.3            -       100     0       65100 65101 i
<a id="__codelineno-89-12" name="__codelineno-89-12" href="#__codelineno-89-12"></a>*  ec    RD: 10.250.1.3:10030 imet 10.255.1.3
<a id="__codelineno-89-13" name="__codelineno-89-13" href="#__codelineno-89-13"></a>                                10.255.1.3            -       100     0       65100 65101 i
<a id="__codelineno-89-14" name="__codelineno-89-14" href="#__codelineno-89-14"></a>* &gt;Ec    RD: 10.250.1.4:10030 imet 10.255.1.3
<a id="__codelineno-89-15" name="__codelineno-89-15" href="#__codelineno-89-15"></a>                                10.255.1.3            -       100     0       65100 65101 i
<a id="__codelineno-89-16" name="__codelineno-89-16" href="#__codelineno-89-16"></a>*  ec    RD: 10.250.1.4:10030 imet 10.255.1.3
<a id="__codelineno-89-17" name="__codelineno-89-17" href="#__codelineno-89-17"></a>                                10.255.1.3            -       100     0       65100 65101 i
<a id="__codelineno-89-18" name="__codelineno-89-18" href="#__codelineno-89-18"></a>* &gt;Ec    RD: 10.250.1.5:10030 imet 10.255.1.5
<a id="__codelineno-89-19" name="__codelineno-89-19" href="#__codelineno-89-19"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-89-20" name="__codelineno-89-20" href="#__codelineno-89-20"></a>*  ec    RD: 10.250.1.5:10030 imet 10.255.1.5
<a id="__codelineno-89-21" name="__codelineno-89-21" href="#__codelineno-89-21"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-89-22" name="__codelineno-89-22" href="#__codelineno-89-22"></a>* &gt;Ec    RD: 10.250.1.6:10030 imet 10.255.1.5
<a id="__codelineno-89-23" name="__codelineno-89-23" href="#__codelineno-89-23"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-89-24" name="__codelineno-89-24" href="#__codelineno-89-24"></a>*  ec    RD: 10.250.1.6:10030 imet 10.255.1.5
<a id="__codelineno-89-25" name="__codelineno-89-25" href="#__codelineno-89-25"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-89-26" name="__codelineno-89-26" href="#__codelineno-89-26"></a>* &gt;      RD: 10.250.1.7:10030 imet 10.255.1.7
<a id="__codelineno-89-27" name="__codelineno-89-27" href="#__codelineno-89-27"></a>                                -                     -       -       0       i
<a id="__codelineno-89-28" name="__codelineno-89-28" href="#__codelineno-89-28"></a>* &gt;      RD: 10.250.1.7:10030 imet 10.255.1.7 remote
<a id="__codelineno-89-29" name="__codelineno-89-29" href="#__codelineno-89-29"></a>                                -                     -       -       0       i
<a id="__codelineno-89-30" name="__codelineno-89-30" href="#__codelineno-89-30"></a><span class="hll">* &gt;      RD: 10.250.2.7:10030 imet 10.255.2.7 remote
</span><a id="__codelineno-89-31" name="__codelineno-89-31" href="#__codelineno-89-31"></a><span class="hll">                                10.255.2.7            -       100     0       65203 i
</span></code></pre></div>
<p><ins>Command</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a>show bgp evpn vni 10040
</code></pre></div>
<p><ins>Expected Output</ins></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a>s1-brdr1#  sho bgp evpn vni 10040
<a id="__codelineno-91-2" name="__codelineno-91-2" href="#__codelineno-91-2"></a>BGP routing table information for VRF default
<a id="__codelineno-91-3" name="__codelineno-91-3" href="#__codelineno-91-3"></a>Router identifier 10.250.1.7, local AS number 65103
<a id="__codelineno-91-4" name="__codelineno-91-4" href="#__codelineno-91-4"></a>Route status codes: * - valid, &gt; - active, S - Stale, E - ECMP head, e - ECMP
<a id="__codelineno-91-5" name="__codelineno-91-5" href="#__codelineno-91-5"></a>                    c - Contributing to ECMP, % - Pending best path selection
<a id="__codelineno-91-6" name="__codelineno-91-6" href="#__codelineno-91-6"></a>Origin codes: i - IGP, e - EGP, ? - incomplete
<a id="__codelineno-91-7" name="__codelineno-91-7" href="#__codelineno-91-7"></a>AS Path Attributes: Or-ID - Originator ID, C-LST - Cluster List, LL Nexthop - Link Local Nexthop
<a id="__codelineno-91-8" name="__codelineno-91-8" href="#__codelineno-91-8"></a>
<a id="__codelineno-91-9" name="__codelineno-91-9" href="#__codelineno-91-9"></a>          Network                Next Hop              Metric  LocPref Weight  Path
<a id="__codelineno-91-10" name="__codelineno-91-10" href="#__codelineno-91-10"></a>* &gt;Ec    RD: 10.250.1.3:10040 imet 10.255.1.3
<a id="__codelineno-91-11" name="__codelineno-91-11" href="#__codelineno-91-11"></a>                                10.255.1.3            -       100     0       65100 65101 i
<a id="__codelineno-91-12" name="__codelineno-91-12" href="#__codelineno-91-12"></a>*  ec    RD: 10.250.1.3:10040 imet 10.255.1.3
<a id="__codelineno-91-13" name="__codelineno-91-13" href="#__codelineno-91-13"></a>                                10.255.1.3            -       100     0       65100 65101 i
<a id="__codelineno-91-14" name="__codelineno-91-14" href="#__codelineno-91-14"></a>* &gt;Ec    RD: 10.250.1.4:10040 imet 10.255.1.3
<a id="__codelineno-91-15" name="__codelineno-91-15" href="#__codelineno-91-15"></a>                                10.255.1.3            -       100     0       65100 65101 i
<a id="__codelineno-91-16" name="__codelineno-91-16" href="#__codelineno-91-16"></a>*  ec    RD: 10.250.1.4:10040 imet 10.255.1.3
<a id="__codelineno-91-17" name="__codelineno-91-17" href="#__codelineno-91-17"></a>                                10.255.1.3            -       100     0       65100 65101 i
<a id="__codelineno-91-18" name="__codelineno-91-18" href="#__codelineno-91-18"></a>* &gt;Ec    RD: 10.250.1.5:10040 imet 10.255.1.5
<a id="__codelineno-91-19" name="__codelineno-91-19" href="#__codelineno-91-19"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-91-20" name="__codelineno-91-20" href="#__codelineno-91-20"></a>*  ec    RD: 10.250.1.5:10040 imet 10.255.1.5
<a id="__codelineno-91-21" name="__codelineno-91-21" href="#__codelineno-91-21"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-91-22" name="__codelineno-91-22" href="#__codelineno-91-22"></a>* &gt;Ec    RD: 10.250.1.6:10040 imet 10.255.1.5
<a id="__codelineno-91-23" name="__codelineno-91-23" href="#__codelineno-91-23"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-91-24" name="__codelineno-91-24" href="#__codelineno-91-24"></a>*  ec    RD: 10.250.1.6:10040 imet 10.255.1.5
<a id="__codelineno-91-25" name="__codelineno-91-25" href="#__codelineno-91-25"></a>                                10.255.1.5            -       100     0       65100 65102 i
<a id="__codelineno-91-26" name="__codelineno-91-26" href="#__codelineno-91-26"></a>* &gt;      RD: 10.250.1.7:10040 imet 10.255.1.7
<a id="__codelineno-91-27" name="__codelineno-91-27" href="#__codelineno-91-27"></a>                                -                     -       -       0       i
<a id="__codelineno-91-28" name="__codelineno-91-28" href="#__codelineno-91-28"></a>* &gt;      RD: 10.250.1.7:10040 imet 10.255.1.7 remote
<a id="__codelineno-91-29" name="__codelineno-91-29" href="#__codelineno-91-29"></a>                                -                     -       -       0       i
<a id="__codelineno-91-30" name="__codelineno-91-30" href="#__codelineno-91-30"></a><span class="hll">* &gt;      RD: 10.250.2.7:10040 imet 10.255.2.7 remote
</span><a id="__codelineno-91-31" name="__codelineno-91-31" href="#__codelineno-91-31"></a><span class="hll">                                10.255.2.7            -       100     0       65203 i
</span></code></pre></div>
</li>
</ol>
<h2 id="provisioning-new-switches"><strong>Provisioning new Switches</strong><a class="headerlink" href="#provisioning-new-switches" title="Permanent link">&para;</a></h2>
<p>Our network is gaining popularity, and it's time to add a new Leaf pair into the environment! <strong>s1-leaf5</strong> and <strong>s1-leaf6</strong>
are ready to be provisioned, so let's get to it.</p>
<h3 id="branch-time"><strong>Branch Time</strong><a class="headerlink" href="#branch-time" title="Permanent link">&para;</a></h3>
<p>Before jumping in, let's create a new branch for our work. We'll call this branch <strong>add-leafs</strong>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-92-1" name="__codelineno-92-1" href="#__codelineno-92-1"></a>git<span class="w"> </span>switch<span class="w"> </span>-c<span class="w"> </span>add-leafs
</code></pre></div>
<p>Now that we have our branch created let's get to work!</p>
<h3 id="inventory-update"><strong>Inventory Update</strong><a class="headerlink" href="#inventory-update" title="Permanent link">&para;</a></h3>
<p>First, we'll want to add our new switches, named <strong>s1-leaf5</strong> and <strong>s1-leaf6</strong>, into our inventory file. We'll add them
as members of the <code>SITE1_LEAFS</code> group.</p>
<p>Add the following two lines under <code>s1-leaf4</code> in <code>sites/site_1/inventory.yml</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-93-1" name="__codelineno-93-1" href="#__codelineno-93-1"></a><span class="nt">s1-leaf5</span><span class="p">:</span>
<a id="__codelineno-93-2" name="__codelineno-93-2" href="#__codelineno-93-2"></a><span class="nt">s1-leaf6</span><span class="p">:</span>
</code></pre></div>
<p>The <code>sites/site_1/inventory.yml</code> file should now look like the example below:</p>
<details class="eos-config annotate">
<summary>sites/site_1/inventory.yml</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-94-1" name="__codelineno-94-1" href="#__codelineno-94-1"></a><span class="nn">---</span>
<a id="__codelineno-94-2" name="__codelineno-94-2" href="#__codelineno-94-2"></a><span class="nt">SITE1</span><span class="p">:</span>
<a id="__codelineno-94-3" name="__codelineno-94-3" href="#__codelineno-94-3"></a><span class="w">  </span><span class="nt">children</span><span class="p">:</span>
<a id="__codelineno-94-4" name="__codelineno-94-4" href="#__codelineno-94-4"></a><span class="w">    </span><span class="nt">CVP</span><span class="p">:</span>
<a id="__codelineno-94-5" name="__codelineno-94-5" href="#__codelineno-94-5"></a><span class="w">      </span><span class="nt">hosts</span><span class="p">:</span>
<a id="__codelineno-94-6" name="__codelineno-94-6" href="#__codelineno-94-6"></a><span class="w">        </span><span class="nt">cvp</span><span class="p">:</span>
<a id="__codelineno-94-7" name="__codelineno-94-7" href="#__codelineno-94-7"></a><span class="w">    </span><span class="nt">SITE1_FABRIC</span><span class="p">:</span>
<a id="__codelineno-94-8" name="__codelineno-94-8" href="#__codelineno-94-8"></a><span class="w">      </span><span class="nt">children</span><span class="p">:</span>
<a id="__codelineno-94-9" name="__codelineno-94-9" href="#__codelineno-94-9"></a><span class="w">        </span><span class="nt">SITE1_SPINES</span><span class="p">:</span>
<a id="__codelineno-94-10" name="__codelineno-94-10" href="#__codelineno-94-10"></a><span class="w">          </span><span class="nt">hosts</span><span class="p">:</span>
<a id="__codelineno-94-11" name="__codelineno-94-11" href="#__codelineno-94-11"></a><span class="w">            </span><span class="nt">s1-spine1</span><span class="p">:</span>
<a id="__codelineno-94-12" name="__codelineno-94-12" href="#__codelineno-94-12"></a><span class="w">            </span><span class="nt">s1-spine2</span><span class="p">:</span>
<a id="__codelineno-94-13" name="__codelineno-94-13" href="#__codelineno-94-13"></a><span class="w">        </span><span class="nt">SITE1_LEAFS</span><span class="p">:</span>
<a id="__codelineno-94-14" name="__codelineno-94-14" href="#__codelineno-94-14"></a><span class="w">          </span><span class="nt">hosts</span><span class="p">:</span>
<a id="__codelineno-94-15" name="__codelineno-94-15" href="#__codelineno-94-15"></a><span class="w">            </span><span class="nt">s1-leaf1</span><span class="p">:</span>
<a id="__codelineno-94-16" name="__codelineno-94-16" href="#__codelineno-94-16"></a><span class="w">            </span><span class="nt">s1-leaf2</span><span class="p">:</span>
<a id="__codelineno-94-17" name="__codelineno-94-17" href="#__codelineno-94-17"></a><span class="w">            </span><span class="nt">s1-leaf3</span><span class="p">:</span>
<a id="__codelineno-94-18" name="__codelineno-94-18" href="#__codelineno-94-18"></a><span class="w">            </span><span class="nt">s1-leaf4</span><span class="p">:</span>
<a id="__codelineno-94-19" name="__codelineno-94-19" href="#__codelineno-94-19"></a><span class="w">            </span><span class="nt">s1-brdr1</span><span class="p">:</span>
<a id="__codelineno-94-20" name="__codelineno-94-20" href="#__codelineno-94-20"></a><span class="w">            </span><span class="nt">s1-brdr2</span><span class="p">:</span>
<a id="__codelineno-94-21" name="__codelineno-94-21" href="#__codelineno-94-21"></a><span class="hll"><span class="w">            </span><span class="nt">s1-leaf5</span><span class="p">:</span>
</span><a id="__codelineno-94-22" name="__codelineno-94-22" href="#__codelineno-94-22"></a><span class="hll"><span class="w">            </span><span class="nt">s1-leaf6</span><span class="p">:</span>
</span><a id="__codelineno-94-23" name="__codelineno-94-23" href="#__codelineno-94-23"></a><span class="w">    </span><span class="nt">SITE1_NETWORK_SERVICES</span><span class="p">:</span>
<a id="__codelineno-94-24" name="__codelineno-94-24" href="#__codelineno-94-24"></a><span class="w">      </span><span class="nt">children</span><span class="p">:</span>
<a id="__codelineno-94-25" name="__codelineno-94-25" href="#__codelineno-94-25"></a><span class="w">        </span><span class="nt">SITE1_SPINES</span><span class="p">:</span>
<a id="__codelineno-94-26" name="__codelineno-94-26" href="#__codelineno-94-26"></a><span class="w">        </span><span class="nt">SITE1_LEAFS</span><span class="p">:</span>
<a id="__codelineno-94-27" name="__codelineno-94-27" href="#__codelineno-94-27"></a><span class="w">    </span><span class="nt">SITE1_CONNECTED_ENDPOINTS</span><span class="p">:</span>
<a id="__codelineno-94-28" name="__codelineno-94-28" href="#__codelineno-94-28"></a><span class="w">      </span><span class="nt">children</span><span class="p">:</span>
<a id="__codelineno-94-29" name="__codelineno-94-29" href="#__codelineno-94-29"></a><span class="w">        </span><span class="nt">SITE1_SPINES</span><span class="p">:</span>
<a id="__codelineno-94-30" name="__codelineno-94-30" href="#__codelineno-94-30"></a><span class="w">        </span><span class="nt">SITE1_LEAFS</span><span class="p">:</span>
</code></pre></div>
</details>
<p>Next, let's add our new Leaf switches into <code>sites/site_1/group_vars/SITE1_FABRIC.yml</code>.</p>
<p>These new switches will go into <strong>S1_RACK4</strong>, leverage MLAG for multi-homing and use BGP ASN# <strong>65104</strong>.</p>
<p>Just like the other Leaf switches, interfaces <code>Ethernet2</code> and <code>Ethernet3</code> will be used to connect
to the spines.</p>
<p>On the spines, interface <code>Ethernet9</code> will be used to connect to <code>s1-leaf5</code>, while <code>Ethernet10</code>
will be used to connect to <code>s1-leaf6</code>.</p>
<p>Starting at line 64, add the following code block into <code>sites/site_1/group_vars/SITE1_FABRIC.yml</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-95-1" name="__codelineno-95-1" href="#__codelineno-95-1"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">S1_RACK4</span>
<a id="__codelineno-95-2" name="__codelineno-95-2" href="#__codelineno-95-2"></a><span class="w">  </span><span class="nt">bgp_as</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65104</span>
<a id="__codelineno-95-3" name="__codelineno-95-3" href="#__codelineno-95-3"></a><span class="w">  </span><span class="nt">nodes</span><span class="p">:</span>
<a id="__codelineno-95-4" name="__codelineno-95-4" href="#__codelineno-95-4"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-leaf5</span>
<a id="__codelineno-95-5" name="__codelineno-95-5" href="#__codelineno-95-5"></a><span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<a id="__codelineno-95-6" name="__codelineno-95-6" href="#__codelineno-95-6"></a><span class="w">      </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.28/24</span>
<a id="__codelineno-95-7" name="__codelineno-95-7" href="#__codelineno-95-7"></a><span class="w">      </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet9</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet9</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-95-8" name="__codelineno-95-8" href="#__codelineno-95-8"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-leaf6</span>
<a id="__codelineno-95-9" name="__codelineno-95-9" href="#__codelineno-95-9"></a><span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6</span>
<a id="__codelineno-95-10" name="__codelineno-95-10" href="#__codelineno-95-10"></a><span class="w">      </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.29/24</span>
<a id="__codelineno-95-11" name="__codelineno-95-11" href="#__codelineno-95-11"></a><span class="w">      </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet10</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet10</span><span class="w"> </span><span class="p p-Indicator">]</span>
</code></pre></div>
<details class="warning" open="open">
<summary>Warning</summary>
<p>Make sure the indentation of <code>RACK4</code> is the same as <code>RACK3</code>, which can be found on line 52</p>
</details>
<p>The <code>sites/site_1/group_vars/SITE1_FABRIC.yml</code> file should now look like the example below:</p>
<details class="eos-config annotate">
<summary>sites/site_1/group_vars/SITE1_FABRIC.yml</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-96-1" name="__codelineno-96-1" href="#__codelineno-96-1"></a><span class="nn">---</span>
<a id="__codelineno-96-2" name="__codelineno-96-2" href="#__codelineno-96-2"></a><span class="nt">fabric_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SITE1_FABRIC</span>
<a id="__codelineno-96-3" name="__codelineno-96-3" href="#__codelineno-96-3"></a>
<a id="__codelineno-96-4" name="__codelineno-96-4" href="#__codelineno-96-4"></a><span class="c1"># Set Design Type to L2ls</span>
<a id="__codelineno-96-5" name="__codelineno-96-5" href="#__codelineno-96-5"></a><span class="nt">design</span><span class="p">:</span>
<a id="__codelineno-96-6" name="__codelineno-96-6" href="#__codelineno-96-6"></a><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">l3ls-evpn</span>
<a id="__codelineno-96-7" name="__codelineno-96-7" href="#__codelineno-96-7"></a>
<a id="__codelineno-96-8" name="__codelineno-96-8" href="#__codelineno-96-8"></a><span class="c1"># Spine Switches</span>
<a id="__codelineno-96-9" name="__codelineno-96-9" href="#__codelineno-96-9"></a><span class="nt">spine</span><span class="p">:</span>
<a id="__codelineno-96-10" name="__codelineno-96-10" href="#__codelineno-96-10"></a><span class="w">  </span><span class="nt">defaults</span><span class="p">:</span>
<a id="__codelineno-96-11" name="__codelineno-96-11" href="#__codelineno-96-11"></a><span class="w">    </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cEOS</span>
<a id="__codelineno-96-12" name="__codelineno-96-12" href="#__codelineno-96-12"></a><span class="w">    </span><span class="nt">loopback_ipv4_pool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.250.1.0/24</span>
<a id="__codelineno-96-13" name="__codelineno-96-13" href="#__codelineno-96-13"></a><span class="w">    </span><span class="nt">bgp_as</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65100</span>
<a id="__codelineno-96-14" name="__codelineno-96-14" href="#__codelineno-96-14"></a><span class="w">  </span><span class="nt">nodes</span><span class="p">:</span>
<a id="__codelineno-96-15" name="__codelineno-96-15" href="#__codelineno-96-15"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-spine1</span>
<a id="__codelineno-96-16" name="__codelineno-96-16" href="#__codelineno-96-16"></a><span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<a id="__codelineno-96-17" name="__codelineno-96-17" href="#__codelineno-96-17"></a><span class="w">      </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.10/24</span>
<a id="__codelineno-96-18" name="__codelineno-96-18" href="#__codelineno-96-18"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-spine2</span>
<a id="__codelineno-96-19" name="__codelineno-96-19" href="#__codelineno-96-19"></a><span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<a id="__codelineno-96-20" name="__codelineno-96-20" href="#__codelineno-96-20"></a><span class="w">      </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.11/24</span>
<a id="__codelineno-96-21" name="__codelineno-96-21" href="#__codelineno-96-21"></a>
<a id="__codelineno-96-22" name="__codelineno-96-22" href="#__codelineno-96-22"></a><span class="c1"># Leaf Switches</span>
<a id="__codelineno-96-23" name="__codelineno-96-23" href="#__codelineno-96-23"></a><span class="nt">l3leaf</span><span class="p">:</span>
<a id="__codelineno-96-24" name="__codelineno-96-24" href="#__codelineno-96-24"></a><span class="w">  </span><span class="nt">defaults</span><span class="p">:</span>
<a id="__codelineno-96-25" name="__codelineno-96-25" href="#__codelineno-96-25"></a><span class="w">    </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cEOS</span>
<a id="__codelineno-96-26" name="__codelineno-96-26" href="#__codelineno-96-26"></a><span class="w">    </span><span class="nt">spanning_tree_priority</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4096</span>
<a id="__codelineno-96-27" name="__codelineno-96-27" href="#__codelineno-96-27"></a><span class="w">    </span><span class="nt">spanning_tree_mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mstp</span>
<a id="__codelineno-96-28" name="__codelineno-96-28" href="#__codelineno-96-28"></a><span class="w">    </span><span class="nt">loopback_ipv4_pool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.250.1.0/24</span>
<a id="__codelineno-96-29" name="__codelineno-96-29" href="#__codelineno-96-29"></a><span class="w">    </span><span class="nt">loopback_ipv4_offset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<a id="__codelineno-96-30" name="__codelineno-96-30" href="#__codelineno-96-30"></a><span class="w">    </span><span class="nt">vtep_loopback_ipv4_pool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.1.0/24</span>
<a id="__codelineno-96-31" name="__codelineno-96-31" href="#__codelineno-96-31"></a><span class="w">    </span><span class="nt">uplink_switches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">s1-spine1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">s1-spine2</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-96-32" name="__codelineno-96-32" href="#__codelineno-96-32"></a><span class="w">    </span><span class="nt">uplink_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet3</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-96-33" name="__codelineno-96-33" href="#__codelineno-96-33"></a><span class="w">    </span><span class="nt">uplink_ipv4_pool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">172.16.1.0/24</span>
<a id="__codelineno-96-34" name="__codelineno-96-34" href="#__codelineno-96-34"></a><span class="w">    </span><span class="nt">mlag_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet6</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-96-35" name="__codelineno-96-35" href="#__codelineno-96-35"></a><span class="w">    </span><span class="nt">mlag_peer_ipv4_pool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.251.1.0/24</span>
<a id="__codelineno-96-36" name="__codelineno-96-36" href="#__codelineno-96-36"></a><span class="w">    </span><span class="nt">mlag_peer_l3_ipv4_pool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.252.1.0/24</span>
<a id="__codelineno-96-37" name="__codelineno-96-37" href="#__codelineno-96-37"></a><span class="w">    </span><span class="nt">virtual_router_mac_address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">00:1c:73:00:00:99</span>
<a id="__codelineno-96-38" name="__codelineno-96-38" href="#__codelineno-96-38"></a><span class="w">  </span><span class="nt">node_groups</span><span class="p">:</span>
<a id="__codelineno-96-39" name="__codelineno-96-39" href="#__codelineno-96-39"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">S1_RACK1</span>
<a id="__codelineno-96-40" name="__codelineno-96-40" href="#__codelineno-96-40"></a><span class="w">      </span><span class="nt">bgp_as</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65101</span>
<a id="__codelineno-96-41" name="__codelineno-96-41" href="#__codelineno-96-41"></a><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span>
<a id="__codelineno-96-42" name="__codelineno-96-42" href="#__codelineno-96-42"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-leaf1</span>
<a id="__codelineno-96-43" name="__codelineno-96-43" href="#__codelineno-96-43"></a><span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<a id="__codelineno-96-44" name="__codelineno-96-44" href="#__codelineno-96-44"></a><span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.12/24</span>
<a id="__codelineno-96-45" name="__codelineno-96-45" href="#__codelineno-96-45"></a><span class="w">          </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-96-46" name="__codelineno-96-46" href="#__codelineno-96-46"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-leaf2</span>
<a id="__codelineno-96-47" name="__codelineno-96-47" href="#__codelineno-96-47"></a><span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<a id="__codelineno-96-48" name="__codelineno-96-48" href="#__codelineno-96-48"></a><span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.13/24</span>
<a id="__codelineno-96-49" name="__codelineno-96-49" href="#__codelineno-96-49"></a><span class="w">          </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet3</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-96-50" name="__codelineno-96-50" href="#__codelineno-96-50"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">S1_RACK2</span>
<a id="__codelineno-96-51" name="__codelineno-96-51" href="#__codelineno-96-51"></a><span class="w">      </span><span class="nt">bgp_as</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65102</span>
<a id="__codelineno-96-52" name="__codelineno-96-52" href="#__codelineno-96-52"></a><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span>
<a id="__codelineno-96-53" name="__codelineno-96-53" href="#__codelineno-96-53"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-leaf3</span>
<a id="__codelineno-96-54" name="__codelineno-96-54" href="#__codelineno-96-54"></a><span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<a id="__codelineno-96-55" name="__codelineno-96-55" href="#__codelineno-96-55"></a><span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.14/24</span>
<a id="__codelineno-96-56" name="__codelineno-96-56" href="#__codelineno-96-56"></a><span class="w">          </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet4</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet4</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-96-57" name="__codelineno-96-57" href="#__codelineno-96-57"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-leaf4</span>
<a id="__codelineno-96-58" name="__codelineno-96-58" href="#__codelineno-96-58"></a><span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<a id="__codelineno-96-59" name="__codelineno-96-59" href="#__codelineno-96-59"></a><span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.15/24</span>
<a id="__codelineno-96-60" name="__codelineno-96-60" href="#__codelineno-96-60"></a><span class="w">          </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet5</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet5</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-96-61" name="__codelineno-96-61" href="#__codelineno-96-61"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">S1_BRDR</span>
<a id="__codelineno-96-62" name="__codelineno-96-62" href="#__codelineno-96-62"></a><span class="w">      </span><span class="nt">bgp_as</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65103</span>
<a id="__codelineno-96-63" name="__codelineno-96-63" href="#__codelineno-96-63"></a><span class="w">      </span><span class="nt">evpn_gateway</span><span class="p">:</span>
<a id="__codelineno-96-64" name="__codelineno-96-64" href="#__codelineno-96-64"></a><span class="w">        </span><span class="nt">evpn_l2</span><span class="p">:</span>
<a id="__codelineno-96-65" name="__codelineno-96-65" href="#__codelineno-96-65"></a><span class="w">          </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-96-66" name="__codelineno-96-66" href="#__codelineno-96-66"></a><span class="w">        </span><span class="nt">evpn_l3</span><span class="p">:</span>
<a id="__codelineno-96-67" name="__codelineno-96-67" href="#__codelineno-96-67"></a><span class="w">          </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-96-68" name="__codelineno-96-68" href="#__codelineno-96-68"></a><span class="w">          </span><span class="nt">inter_domain</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-96-69" name="__codelineno-96-69" href="#__codelineno-96-69"></a><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span>
<a id="__codelineno-96-70" name="__codelineno-96-70" href="#__codelineno-96-70"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-brdr1</span>
<a id="__codelineno-96-71" name="__codelineno-96-71" href="#__codelineno-96-71"></a><span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<a id="__codelineno-96-72" name="__codelineno-96-72" href="#__codelineno-96-72"></a><span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.100/24</span>
<a id="__codelineno-96-73" name="__codelineno-96-73" href="#__codelineno-96-73"></a><span class="w">          </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet7</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet7</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-96-74" name="__codelineno-96-74" href="#__codelineno-96-74"></a><span class="w">          </span><span class="nt">evpn_gateway</span><span class="p">:</span>
<a id="__codelineno-96-75" name="__codelineno-96-75" href="#__codelineno-96-75"></a><span class="w">            </span><span class="nt">remote_peers</span><span class="p">:</span>
<a id="__codelineno-96-76" name="__codelineno-96-76" href="#__codelineno-96-76"></a><span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s2-brdr1</span>
<a id="__codelineno-96-77" name="__codelineno-96-77" href="#__codelineno-96-77"></a><span class="w">                </span><span class="nt">bgp_as</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65203</span>
<a id="__codelineno-96-78" name="__codelineno-96-78" href="#__codelineno-96-78"></a><span class="w">                </span><span class="nt">ip_address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.2.7</span>
<a id="__codelineno-96-79" name="__codelineno-96-79" href="#__codelineno-96-79"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-brdr2</span>
<a id="__codelineno-96-80" name="__codelineno-96-80" href="#__codelineno-96-80"></a><span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6</span>
<a id="__codelineno-96-81" name="__codelineno-96-81" href="#__codelineno-96-81"></a><span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.101/24</span>
<a id="__codelineno-96-82" name="__codelineno-96-82" href="#__codelineno-96-82"></a><span class="w">          </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet8</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-96-83" name="__codelineno-96-83" href="#__codelineno-96-83"></a><span class="w">          </span><span class="nt">evpn_gateway</span><span class="p">:</span>
<a id="__codelineno-96-84" name="__codelineno-96-84" href="#__codelineno-96-84"></a><span class="w">            </span><span class="nt">remote_peers</span><span class="p">:</span>
<a id="__codelineno-96-85" name="__codelineno-96-85" href="#__codelineno-96-85"></a><span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s2-brdr2</span>
<a id="__codelineno-96-86" name="__codelineno-96-86" href="#__codelineno-96-86"></a><span class="w">                </span><span class="nt">bgp_as</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65203</span>
<a id="__codelineno-96-87" name="__codelineno-96-87" href="#__codelineno-96-87"></a><span class="w">                </span><span class="nt">ip_address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.2.8</span>
<a id="__codelineno-96-88" name="__codelineno-96-88" href="#__codelineno-96-88"></a><span class="hll"><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">S1_RACK4</span>
</span><a id="__codelineno-96-89" name="__codelineno-96-89" href="#__codelineno-96-89"></a><span class="hll"><span class="w">      </span><span class="nt">bgp_as</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65104</span>
</span><a id="__codelineno-96-90" name="__codelineno-96-90" href="#__codelineno-96-90"></a><span class="hll"><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span>
</span><a id="__codelineno-96-91" name="__codelineno-96-91" href="#__codelineno-96-91"></a><span class="hll"><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-leaf5</span>
</span><a id="__codelineno-96-92" name="__codelineno-96-92" href="#__codelineno-96-92"></a><span class="hll"><span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</span><a id="__codelineno-96-93" name="__codelineno-96-93" href="#__codelineno-96-93"></a><span class="hll"><span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.28/24</span>
</span><a id="__codelineno-96-94" name="__codelineno-96-94" href="#__codelineno-96-94"></a><span class="hll"><span class="w">          </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet9</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet9</span><span class="w"> </span><span class="p p-Indicator">]</span>
</span><a id="__codelineno-96-95" name="__codelineno-96-95" href="#__codelineno-96-95"></a><span class="hll"><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-leaf6</span>
</span><a id="__codelineno-96-96" name="__codelineno-96-96" href="#__codelineno-96-96"></a><span class="hll"><span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6</span>
</span><a id="__codelineno-96-97" name="__codelineno-96-97" href="#__codelineno-96-97"></a><span class="hll"><span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.29/24</span>
</span><a id="__codelineno-96-98" name="__codelineno-96-98" href="#__codelineno-96-98"></a><span class="hll"><span class="w">          </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet10</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet10</span><span class="w"> </span><span class="p p-Indicator">]</span>
</span></code></pre></div>
</details>
<p>Next - Let's build the configuration!</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-97-1" name="__codelineno-97-1" href="#__codelineno-97-1"></a>make<span class="w"> </span>build-site-1
</code></pre></div>
<details class="danger" open="open">
<summary>Important</summary>
<p>Interfaces <code>Ethernet9</code> and <code>Ethernet10</code> do not exist on the Spines. Because of this, we
will <strong>not</strong> run a deploy command since it would fail.</p>
</details>
<p>Please take a moment and review the results of our changes via the source control functionality in VS Code.</p>
<p>Finally, we'll commit our changes and publish our branch. Again, we can use the VS Code Source Control GUI for this,
or via the CLI using the commands below:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-98-1" name="__codelineno-98-1" href="#__codelineno-98-1"></a>git<span class="w"> </span>add<span class="w"> </span>.
<a id="__codelineno-98-2" name="__codelineno-98-2" href="#__codelineno-98-2"></a>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;add leafs&#39;</span>
<a id="__codelineno-98-3" name="__codelineno-98-3" href="#__codelineno-98-3"></a>git<span class="w"> </span>push<span class="w"> </span>--set-upstream<span class="w"> </span>origin<span class="w"> </span>add-leafs
</code></pre></div>
<h2 id="backing-out-changes"><strong>Backing out changes</strong><a class="headerlink" href="#backing-out-changes" title="Permanent link">&para;</a></h2>
<p>Ruh Roh. As it turns out, we should have added these leaf switches to an entirely new site. Oops! No worries, because
we used our <strong>add-leafs</strong> branch, we can switch back to our main branch and then delete our local copy of the <strong>add-leafs</strong>
branch. No harm or confusion related to this change ever hit the main branch!</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-99-1" name="__codelineno-99-1" href="#__codelineno-99-1"></a>git<span class="w"> </span>switch<span class="w"> </span>main
<a id="__codelineno-99-2" name="__codelineno-99-2" href="#__codelineno-99-2"></a>git<span class="w"> </span>branch<span class="w"> </span>-D<span class="w"> </span>add-leafs
</code></pre></div>
<p>Finally, we can go out to our forked copy of the repository and delete the <strong>add-leafs</strong> branch.</p>
<details class="success" open="open">
<summary>Great Success!</summary>
<p>Congratulations. You have now successfully completed initial fabric builds and day 2 operational changes without interacting with any switch CLI!</p>
</details>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    2024-09-27
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Arista Networks
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs Insiders
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/aristanetworks/avd-workshops" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/AristaNetworks" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.arista.com" target="_blank" rel="noopener" title="www.arista.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M352 256c0 22.2-1.2 43.6-3.3 64H163.4c-2.2-20.4-3.3-41.8-3.3-64s1.2-43.6 3.3-64h185.3c2.2 20.4 3.3 41.8 3.3 64m28.8-64h123.1c5.3 20.5 8.1 41.9 8.1 64s-2.8 43.5-8.1 64H380.8c2.1-20.6 3.2-42 3.2-64s-1.1-43.4-3.2-64m112.6-32H376.7c-10-63.9-29.8-117.4-55.3-151.6 78.3 20.7 142 77.5 171.9 151.6zm-149.1 0H167.7c6.1-36.4 15.5-68.6 27-94.7 10.5-23.6 22.2-40.7 33.5-51.5C239.4 3.2 248.7 0 256 0s16.6 3.2 27.8 13.8c11.3 10.8 23 27.9 33.5 51.5 11.6 26 20.9 58.2 27 94.7m-209 0H18.6c30-74.1 93.6-130.9 172-151.6-25.5 34.2-45.3 87.7-55.3 151.6M8.1 192h123.1c-2.1 20.6-3.2 42-3.2 64s1.1 43.4 3.2 64H8.1C2.8 299.5 0 278.1 0 256s2.8-43.5 8.1-64m186.6 254.6c-11.6-26-20.9-58.2-27-94.6h176.6c-6.1 36.4-15.5 68.6-27 94.6-10.5 23.6-22.2 40.7-33.5 51.5-11.2 10.7-20.5 13.9-27.8 13.9s-16.6-3.2-27.8-13.8c-11.3-10.8-23-27.9-33.5-51.5zM135.3 352c10 63.9 29.8 117.4 55.3 151.6-78.4-20.7-142-77.5-172-151.6zm358.1 0c-30 74.1-93.6 130.9-171.9 151.6 25.5-34.2 45.2-87.7 55.3-151.6h116.7z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "content.code.annotate", "content.code.copy", "content.tooltips", "header.autohide", "navigation.top", "navigation.tracking"], "search": "../../assets/javascripts/workers/search.c7c1ca2c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c4a99efa.min.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../../stylesheets/tables.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>