
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../overview/">
      
      
        <link rel="next" href="../../l3ls/overview/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.38+insiders-4.53.13">
    
    
      
        <title>Lab Guide - Arista CI Workshops</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.fd1ad6e4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CFira+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Fira Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.material.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#avd-lab-guide" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Arista CI Workshops" class="md-header__button md-logo" aria-label="Arista CI Workshops" data-md-component="logo">
      
  <img src="../../assets/images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Arista CI Workshops
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab Guide
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/aristanetworks/avd-workshops" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Workshops on GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Arista CI Workshops" class="md-nav__button md-logo" aria-label="Arista CI Workshops" data-md-component="logo">
      
  <img src="../../assets/images/logo.png" alt="logo">

    </a>
    Arista CI Workshops
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aristanetworks/avd-workshops" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Workshops on GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Fundamentals
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Fundamentals
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Git
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vscode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    VS Code
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../jinja-yaml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Jinja/YAML
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ansible/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Ansible
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Arista CI
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Arista CI
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    AVD L2LS
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    AVD L2LS
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    
  
    Lab Guide
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    
  
    Lab Guide
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#avd-lab-guide-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        AVD Lab Guide Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-prepare-lab-environment" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1 - Prepare Lab Environment
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-build-and-deploy-dual-data-center-l2ls-network" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2 - Build and Deploy Dual Data Center L2LS Network
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-site-1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3 - Site 1
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-site-2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4 - Site 2
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-connect-sites-to-wan-ip-network" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 5 - Connect Sites to WAN IP Network
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#congratulations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Congratulations!
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-day-2-operations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 6 - Day 2 Operations
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-7-backing-out-changes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 7 - Backing out changes
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    AVD L3LS EVPN/VXLAN
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    AVD L3LS EVPN/VXLAN
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../l3ls/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../l3ls/l3ls-lab-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Lab Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cicd-basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    CI/CD Basics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Automated Network Validation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Automated Network Validation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../validation/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../validation/anta_validate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    ANTA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../validation/avd_validate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    AVD Validate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#avd-lab-guide-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        AVD Lab Guide Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-prepare-lab-environment" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1 - Prepare Lab Environment
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-build-and-deploy-dual-data-center-l2ls-network" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2 - Build and Deploy Dual Data Center L2LS Network
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-site-1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3 - Site 1
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-site-2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4 - Site 2
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-connect-sites-to-wan-ip-network" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 5 - Connect Sites to WAN IP Network
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#congratulations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Congratulations!
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-day-2-operations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 6 - Day 2 Operations
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-7-backing-out-changes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 7 - Backing out changes
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/aristanetworks/avd-workshops/blob/main/workshops/l2ls/l2ls-lab-guide.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="avd-lab-guide">AVD Lab Guide<a class="headerlink" href="#avd-lab-guide" title="Permanent link">&para;</a></h1>
<h2 id="avd-lab-guide-overview">AVD Lab Guide Overview<a class="headerlink" href="#avd-lab-guide-overview" title="Permanent link">&para;</a></h2>
<p>The AVD Lab Guide is a follow-along set of instructions to deploy a dual data center L2LS fabric design. The data model overview and details can be found <a href="../overview/">here</a>. In the following steps, we will explore updating the data models to add services, ports, and WAN links to our fabrics and test traffic between sites.</p>
<p>In this example, the ATD lab is used to create the L2LS Dual Data Center topology below. The IP Network cloud (orange area) is pre-provisioned and is comprised of the border and core nodes in the ATD topology. Our focus will be creating the L2LS AVD data models to build and deploy configurations for Site 1 and Site 2 (blue areas) and connect them to the IP Network.</p>
<p><a class="glightbox" href="../../assets/images/topologies.svg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Dual DC Topology" src="../../assets/images/topologies.svg" /></a></p>
<h3 id="host-addresses">Host Addresses<a class="headerlink" href="#host-addresses" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th style="text-align: center;">Host</th>
<th style="text-align: center;">IP Address</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">s1-host1</td>
<td style="text-align: center;">10.10.10.100</td>
</tr>
<tr>
<td style="text-align: center;">s1-host2</td>
<td style="text-align: center;">10.20.20.100</td>
</tr>
<tr>
<td style="text-align: center;">s2-host1</td>
<td style="text-align: center;">10.30.30.100</td>
</tr>
<tr>
<td style="text-align: center;">s2-host2</td>
<td style="text-align: center;">10.40.40.100</td>
</tr>
</tbody>
</table>
<h2 id="step-1-prepare-lab-environment"><strong>Step 1 - Prepare Lab Environment</strong><a class="headerlink" href="#step-1-prepare-lab-environment" title="Permanent link">&para;</a></h2>
<h3 id="access-the-atd-lab">Access the ATD Lab<a class="headerlink" href="#access-the-atd-lab" title="Permanent link">&para;</a></h3>
<p>Connect to your ATD Lab and start the Programmability IDE. Next, create a new Terminal.</p>
<h3 id="fork-and-clone-branch-to-atd-lab">Fork and Clone branch to ATD Lab<a class="headerlink" href="#fork-and-clone-branch-to-atd-lab" title="Permanent link">&para;</a></h3>
<p>An ATD Dual Data Center L2LS data model is posted on <a href="https://github.com/aristanetworks/ci-workshops-avd">GitHub</a>.</p>
<ul>
<li>Fork this <strong><a href="https://github.com/aristanetworks/ci-workshops-avd">repository</a></strong> to your own GitHub account.</li>
<li>Next, clone your forked repo to your ATD lab instance.</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">cd</span><span class="w"> </span>/home/coder/project/labfiles
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>git<span class="w"> </span>clone<span class="w"> </span>&lt;your<span class="w"> </span>copied<span class="w"> </span>URL&gt;
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nb">cd</span><span class="w"> </span>ci-workshops-avd
</code></pre></div>
<p>Configure your global Git settings.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>user.name<span class="w"> </span><span class="s2">&quot;FirstName LastName&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>user.email<span class="w"> </span><span class="s2">&quot;name@example.com&quot;</span>
</code></pre></div>
<h3 id="update-avd">Update AVD<a class="headerlink" href="#update-avd" title="Permanent link">&para;</a></h3>
<p>AVD has been pre-installed in your lab environment. However, it may be on an older (or newer) version than intended for the lab. The following steps will update AVD and modules to the valid versions for the lab.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>pip3<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>global.break-system-packages<span class="w"> </span><span class="nb">true</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>pip3<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>global.disable-pip-version-check<span class="w"> </span><span class="nb">true</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>pip3<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;pyavd[ansible-collection]==4.10.0&quot;</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>ansible-galaxy<span class="w"> </span>collection<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.yml
</code></pre></div>
<details class="warning" open="open">
<summary>Important</summary>
<p>You must run these commands when you start your lab or a new shell (terminal).</p>
</details>
<h3 id="change-to-lab-working-directory">Change To Lab Working Directory<a class="headerlink" href="#change-to-lab-working-directory" title="Permanent link">&para;</a></h3>
<p>Now that AVD is updated, lets move into the appropriate directory so we can access the files necessary for this L3LS Lab!</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nb">cd</span><span class="w"> </span>labs/L2LS
</code></pre></div>
<h3 id="setup-lab-password-environment-variable">Setup Lab Password Environment Variable<a class="headerlink" href="#setup-lab-password-environment-variable" title="Permanent link">&para;</a></h3>
<p>Each lab comes with a unique password. We set an environment variable called <code>LABPASSPHRASE</code> with the following command. The variable is later used to generate local user passwords and connect to our switches to push configs.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">LABPASSPHRASE</span><span class="o">=</span><span class="sb">`</span>awk<span class="w"> </span><span class="s1">&#39;/password:/{print $2}&#39;</span><span class="w"> </span>/home/coder/.config/code-server/config.yaml<span class="sb">`</span>
</code></pre></div>
<p>You can view the password is set. This is the same password displayed when you click the link to access your lab.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nb">echo</span><span class="w"> </span><span class="nv">$LABPASSPHRASE</span>
</code></pre></div>
<details class="warning" open="open">
<summary>IMPORTANT</summary>
<p>You must run this step when you start your lab or a new shell (terminal).</p>
</details>
<h3 id="prepare-wan-ip-network-and-test-hosts">Prepare WAN IP Network and Test Hosts<a class="headerlink" href="#prepare-wan-ip-network-and-test-hosts" title="Permanent link">&para;</a></h3>
<p>The last step in preparing your lab is to push pre-defined configurations to the WAN IP Network (cloud) and the four hosts used to test traffic. The spines from each site will connect to the WAN IP Network with P2P links. The hosts (two per site) have port-channels to the leaf pairs and are pre-configured with an IP address and route to reach the other hosts.</p>
<p>Run the following to push the configs.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>make<span class="w"> </span>preplab
</code></pre></div>
<h2 id="step-2-build-and-deploy-dual-data-center-l2ls-network"><strong>Step 2 - Build and Deploy Dual Data Center L2LS Network</strong><a class="headerlink" href="#step-2-build-and-deploy-dual-data-center-l2ls-network" title="Permanent link">&para;</a></h2>
<p>This section will review and update the existing L2LS data model. We will add features to enable VLANs, SVIs, connected endpoints, and P2P links to the WAN IP Network. After the lab, you will have enabled an L2LS dual data center network through automation with AVD. YAML data models and Ansible playbooks will be used to generate EOS CLI configurations and deploy them to each site. We will start by focusing on building out Site 1 and then repeat similar steps for Site 2. Finally, we will enable connectivity to the WAN IP Network to allow traffic to pass between sites.</p>
<h3 id="summary-of-steps"><strong>Summary of Steps</strong><a class="headerlink" href="#summary-of-steps" title="Permanent link">&para;</a></h3>
<ol>
<li>Build and Deploy <code>Site 1</code></li>
<li>Build and Deploy <code>Site 2</code></li>
<li>Connect sites to WAN IP Network</li>
<li>Verify routing</li>
<li>Test traffic</li>
</ol>
<h2 id="step-3-site-1"><strong>Step 3 - Site 1</strong><a class="headerlink" href="#step-3-site-1" title="Permanent link">&para;</a></h2>
<h3 id="build-and-deploy-initial-fabric">Build and Deploy Initial Fabric<a class="headerlink" href="#build-and-deploy-initial-fabric" title="Permanent link">&para;</a></h3>
<p>The initial fabric data model key/value pairs have been pre-populated in the following group_vars files in the <code>sites/site_1/group_vars/</code> directory.</p>
<ul>
<li>SITE1_FABRIC_PORTS.yml</li>
<li>SITE1_FABRIC_SERVICES.yml</li>
<li>SITE1_FABRIC.yml</li>
<li>SITE1_LEAFS.yml</li>
<li>SITE1_SPINES.yml</li>
</ul>
<p>Review these files to understand how they relate to the topology above.</p>
<p>At this point, we can build and deploy our initial configurations to the topology.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>make<span class="w"> </span>build-site-1
</code></pre></div>
<p>AVD creates a separate markdown and EOS configuration file per switch. In addition, you can review the files in the <code>documentation</code> and <code>intended</code> folders per site.</p>
<p><a class="glightbox" href="../../assets/images/docs-configs.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Docs and Configs" src="../../assets/images/docs-configs.png" style="width:300px" /></a></p>
<p>Now, deploy the configurations to Site 1 switches.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>make<span class="w"> </span>deploy-site-1
</code></pre></div>
<p>Log into your switches to verify the current configs (<code>show run</code>) match the ones created in <code>intended/configs</code> folder.</p>
<p>You can also check the current state for MLAG, VLANs, interfaces, and port-channels.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>show<span class="w"> </span>mlag
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>show<span class="w"> </span>vlan<span class="w"> </span>brief
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>show<span class="w"> </span>ip<span class="w"> </span>interface<span class="w"> </span>brief
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>show<span class="w"> </span>port-channel
</code></pre></div>
<p>The basic fabric with MLAG peers and port-channels between leaf and spines are now created. Next up, we will add VLAN and SVI services to the fabric.</p>
<h3 id="add-services-to-the-fabric">Add Services to the Fabric<a class="headerlink" href="#add-services-to-the-fabric" title="Permanent link">&para;</a></h3>
<p>The next step is to add Vlans and SVIs to the fabric. The services data model file <code>SITE1_FABRIC_SERVICES.yml</code> is pre-populated with Vlans and SVIs <code>10</code> and <code>20</code> in the default VRF.</p>
<p>Open <code>SITE1_FABRIC_SERVICES.yml</code> and uncomment lines 1-28, then run the build &amp; deploy process again.</p>
<details class="tip" open="open">
<summary>Tip</summary>
<p><img alt="âœ" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/270d.svg" title=":writing_hand:" /> In VS Code, you can toggle comments on/off by selecting the text and pressing <strong><em>windows</em></strong> <span class="keys"><kbd class="key-control">Ctrl</kbd></span> + <span class="keys"><kbd class="key-slash">/</kbd></span> or <strong><em>mac</em></strong> <span class="keys"><kbd class="key-command">Cmd</kbd></span> + <span class="keys"><kbd class="key-slash">/</kbd></span>.</p>
</details>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>make<span class="w"> </span>build-site-1
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>make<span class="w"> </span>deploy-site-1
</code></pre></div>
<p>Log into <code>s1-spine1</code> and <code>s1-spine2</code> and verify the SVIs <code>10</code> and <code>20</code> exist.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>show<span class="w"> </span>ip<span class="w"> </span>interface<span class="w"> </span>brief
</code></pre></div>
<p>It should look similar to the following:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>                                           Address
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>Interface         IP Address            Status       Protocol            MTU    Owner
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>----------------- --------------------- ------------ -------------- ----------- -------
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>Loopback0         10.1.252.1/32         up           up                65535
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>Management0       192.168.0.10/24       up           up                 1500
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>Vlan10            10.10.10.2/24         up           up                 1500
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>Vlan20            10.20.20.2/24         up           up                 1500
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>Vlan4093          10.1.254.0/31         up           up                 1500
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>Vlan4094          10.1.253.0/31         up           up                 1500
</code></pre></div>
<p>You can verify the recent configuration session was created.</p>
<details class="info" open="open">
<summary>Info</summary>
<p>When the configuration is applied via a configuration session, EOS will create a "checkpoint" of the configuration. This checkpoint is a snapshot
of the device's running configuration as it was <strong>prior</strong> to the configuration session being committed.</p>
</details>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>show<span class="w"> </span>clock
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>show<span class="w"> </span>configuration<span class="w"> </span>sessions<span class="w"> </span>detail
</code></pre></div>
<p>List the recent checkpoints.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>show<span class="w"> </span>config<span class="w"> </span>checkpoints
</code></pre></div>
<p>View the contents of the latest checkpoint file.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>more<span class="w"> </span>checkpoint:&lt;<span class="w"> </span>filename<span class="w"> </span>&gt;
</code></pre></div>
<p>See the difference between the running config and the latest checkpoint file.</p>
<details class="tip" open="open">
<summary>Tip</summary>
<p>This will show the differences between the current device configuration
and the configuration before we did our <code>make deploy</code> command.</p>
</details>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>diff<span class="w"> </span>checkpoint:&lt;<span class="w"> </span>filename<span class="w"> </span>&gt;<span class="w"> </span>running-config
</code></pre></div>
<h3 id="add-ports-for-hosts">Add Ports for Hosts<a class="headerlink" href="#add-ports-for-hosts" title="Permanent link">&para;</a></h3>
<p>Let's configure port-channels to our hosts (<code>s1-host1</code> and <code>s1-host2</code>).</p>
<p>Open <code>SITE1_FABRIC_PORTS.yml</code> and uncomment lines 17-45, then run the build &amp; deploy process again.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>make<span class="w"> </span>build-site-1
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>make<span class="w"> </span>deploy-site-1
</code></pre></div>
<p>At this point, hosts should be able to ping each other across the fabric.</p>
<p>From <code>s1-host1</code>, run a ping to <code>s1-host2</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>ping<span class="w"> </span><span class="m">10</span>.20.20.100
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>PING 10.20.20.100 (10.20.20.100) 72(100) bytes of data.
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>80 bytes from 10.20.20.100: icmp_seq=1 ttl=63 time=30.2 ms
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>80 bytes from 10.20.20.100: icmp_seq=2 ttl=63 time=29.5 ms
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>80 bytes from 10.20.20.100: icmp_seq=3 ttl=63 time=28.8 ms
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>80 bytes from 10.20.20.100: icmp_seq=4 ttl=63 time=24.8 ms
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>80 bytes from 10.20.20.100: icmp_seq=5 ttl=63 time=26.2 ms
</code></pre></div>
<p>Site 1 fabric is now complete.</p>
<h2 id="step-4-site-2"><strong>Step 4 - Site 2</strong><a class="headerlink" href="#step-4-site-2" title="Permanent link">&para;</a></h2>
<p>Repeat the previous three steps for Site 2.</p>
<ul>
<li>Add Services</li>
<li>Add Ports</li>
<li>Build and Deploy Configs</li>
<li>Verify ping traffic between hosts <code>s2-host1</code> and <code>s2-host2</code></li>
</ul>
<p>At this point, you should be able to ping between hosts within a site but not between sites. For this, we need to build connectivity to the <code>WAN IP Network</code>. This is covered in the next section.</p>
<h2 id="step-5-connect-sites-to-wan-ip-network"><strong>Step 5 - Connect Sites to WAN IP Network</strong><a class="headerlink" href="#step-5-connect-sites-to-wan-ip-network" title="Permanent link">&para;</a></h2>
<p>The WAN IP Network is defined by the <code>core_interfaces</code> data model. Full data model documentation is located <strong><a href="https://avd.arista.com/4.10/roles/eos_designs/docs/input-variables.html#core-interfaces-settings">here</a></strong>.</p>
<p>The data model defines P2P links (<code>/31s</code>) on the spines with a stanza per link. See details in the graphic below. Each spine has two links to the WAN IP Network configured on ports <code>Ethernet7</code> and <code>Ethernet8</code>. OSPF is added to these links as well.</p>
<p><a class="glightbox" href="../../assets/images/avd-core-interfaces.svg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Core Interfaces" src="../../assets/images/avd-core-interfaces.svg" /></a></p>
<h3 id="add-p2p-links-to-wan-ip-network-for-site-1-and-2"><strong>Add P2P Links to WAN IP Network for Site 1 and 2</strong><a class="headerlink" href="#add-p2p-links-to-wan-ip-network-for-site-1-and-2" title="Permanent link">&para;</a></h3>
<p>Add each site's <code>core_interfaces</code> dictionary (shown below) to the bottom of the following files <code>SITE1_FABRIC.yml</code> and <code>SITE2_FABRIC.yml</code></p>
<h3 id="site-1"><strong>Site #1</strong><a class="headerlink" href="#site-1" title="Permanent link">&para;</a></h3>
<p>Add the following code block to the bottom of <code>sites/site_1/group_vars/SITE1_FABRIC.yml</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="c1">##################################################################</span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="c1"># WAN/Core Edge Links</span>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="c1">##################################################################</span>
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="nt">core_interfaces</span><span class="p">:</span>
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a><span class="w">  </span><span class="nt">p2p_links</span><span class="p">:</span>
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>
<a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">10.0.0.29/31</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10.0.0.28/31</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">s1-spine1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">WANCORE</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a><span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet7</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a><span class="w">      </span><span class="nt">include_in_underlay_protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a>
<a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">10.0.0.33/31</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10.0.0.32/31</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-29-14" name="__codelineno-29-14" href="#__codelineno-29-14"></a><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">s1-spine1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">WANCORE</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-29-15" name="__codelineno-29-15" href="#__codelineno-29-15"></a><span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-29-16" name="__codelineno-29-16" href="#__codelineno-29-16"></a><span class="w">      </span><span class="nt">include_in_underlay_protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-29-17" name="__codelineno-29-17" href="#__codelineno-29-17"></a>
<a id="__codelineno-29-18" name="__codelineno-29-18" href="#__codelineno-29-18"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">10.0.0.31/31</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10.0.0.30/31</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-29-19" name="__codelineno-29-19" href="#__codelineno-29-19"></a><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">s1-spine2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">WANCORE</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-29-20" name="__codelineno-29-20" href="#__codelineno-29-20"></a><span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet7</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-29-21" name="__codelineno-29-21" href="#__codelineno-29-21"></a><span class="w">      </span><span class="nt">include_in_underlay_protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-29-22" name="__codelineno-29-22" href="#__codelineno-29-22"></a>
<a id="__codelineno-29-23" name="__codelineno-29-23" href="#__codelineno-29-23"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">10.0.0.35/31</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10.0.0.34/31</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-29-24" name="__codelineno-29-24" href="#__codelineno-29-24"></a><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">s1-spine2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">WANCORE</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-29-25" name="__codelineno-29-25" href="#__codelineno-29-25"></a><span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-29-26" name="__codelineno-29-26" href="#__codelineno-29-26"></a><span class="w">      </span><span class="nt">include_in_underlay_protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<h3 id="site-2"><strong>Site #2</strong><a class="headerlink" href="#site-2" title="Permanent link">&para;</a></h3>
<p>Add the following code block to the bottom of <code>sites/site_2/group_vars/SITE2_FABRIC.yml</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="c1">##################################################################</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="c1"># WAN/Core Edge Links</span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="c1">##################################################################</span>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="nt">core_interfaces</span><span class="p">:</span>
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="w">  </span><span class="nt">p2p_links</span><span class="p">:</span>
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>
<a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">10.0.0.37/31</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10.0.0.36/31</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">s2-spine1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">WANCORE</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a><span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet7</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a><span class="w">      </span><span class="nt">include_in_underlay_protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a>
<a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">10.0.0.41/31</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10.0.0.40/31</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">s2-spine1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">WANCORE</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a><span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a><span class="w">      </span><span class="nt">include_in_underlay_protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a>
<a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">10.0.0.39/31</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10.0.0.38/31</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">s2-spine2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">WANCORE</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-30-20" name="__codelineno-30-20" href="#__codelineno-30-20"></a><span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet7</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-30-21" name="__codelineno-30-21" href="#__codelineno-30-21"></a><span class="w">      </span><span class="nt">include_in_underlay_protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-30-22" name="__codelineno-30-22" href="#__codelineno-30-22"></a>
<a id="__codelineno-30-23" name="__codelineno-30-23" href="#__codelineno-30-23"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">10.0.0.43/31</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10.0.0.42/31</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-30-24" name="__codelineno-30-24" href="#__codelineno-30-24"></a><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">s2-spine2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">WANCORE</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-30-25" name="__codelineno-30-25" href="#__codelineno-30-25"></a><span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-30-26" name="__codelineno-30-26" href="#__codelineno-30-26"></a><span class="w">      </span><span class="nt">include_in_underlay_protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<h3 id="build-and-deploy-wan-ip-network-connectivity"><strong>Build and Deploy WAN IP Network connectivity</strong><a class="headerlink" href="#build-and-deploy-wan-ip-network-connectivity" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>make<span class="w"> </span>build-site-1<span class="w"> </span>build-site-2<span class="w"> </span>deploy-site-1<span class="w"> </span>deploy-site-2
</code></pre></div>
<details class="tip" open="open">
<summary>Tip</summary>
<p>Daisy chaining "Makesies" is a great way to run a series of tasks with a single CLI command <img alt="ðŸ˜€" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f600.svg" title=":grinning:" /></p>
</details>
<h3 id="check-routes-on-spine-nodes"><strong>Check routes on spine nodes</strong><a class="headerlink" href="#check-routes-on-spine-nodes" title="Permanent link">&para;</a></h3>
<p>From the spines, verify that they can see routes to the following networks where the hosts reside.</p>
<ul>
<li>10.10.10.0/24</li>
<li>10.20.20.0/24</li>
<li>10.30.30.0/24</li>
<li>10.40.40.0/24</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>show<span class="w"> </span>ip<span class="w"> </span>route
</code></pre></div>
<h3 id="test-traffic-between-sites"><strong>Test traffic between sites</strong><a class="headerlink" href="#test-traffic-between-sites" title="Permanent link">&para;</a></h3>
<p>From <code>s1-host1</code> ping both <code>s2-host1</code> &amp; <code>s2-host2</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="c1"># s2-host1</span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>ping<span class="w"> </span><span class="m">10</span>.30.30.100
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="c1"># s2-host2</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>ping<span class="w"> </span><span class="m">10</span>.40.40.100
</code></pre></div>
<h2 id="congratulations"><strong>Congratulations!</strong><a class="headerlink" href="#congratulations" title="Permanent link">&para;</a></h2>
<p>You have built a multi-site L2LS network without touching the CLI on a single switch.</p>
<h2 id="step-6-day-2-operations"><strong>Step 6 - Day 2 Operations</strong><a class="headerlink" href="#step-6-day-2-operations" title="Permanent link">&para;</a></h2>
<p>Our multi-site L2LS network is working great. But, before too long, it will be time to change
our configurations. Lucky for us, that time is today!</p>
<h3 id="cleaning-up"><strong>Cleaning Up</strong><a class="headerlink" href="#cleaning-up" title="Permanent link">&para;</a></h3>
<p>Before going any further, let's ensure we have a clean repo by committing the changes we've made
up to this point. The CLI commands below can accomplish this, but the VS Code Source Control GUI
can be used as well.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>git<span class="w"> </span>add<span class="w"> </span>.
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;Your message here&#39;</span>
</code></pre></div>
<p>Next, we'll want to push these changes to our forked repository on GitHub.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>git<span class="w"> </span>push
</code></pre></div>
<p>If this is our first time pushing to our forked repository, then VS Code will provide us with the following
sign-in prompt:</p>
<p><a class="glightbox" href="../../assets/images/git_login_request.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="VS Code GitHub Sign in Prompt" src="../../assets/images/git_login_request.png" style="width:400px" /></a></p>
<p>Choose <strong>Allow</strong>, and another prompt will come up, showing your unique login code:</p>
<p><a class="glightbox" href="../../assets/images/git_login_code.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="VS Code GitHub Login Code Prompt" src="../../assets/images/git_login_code.png" style="width:400px" /></a></p>
<p>Choose <strong>Copy &amp; Continue to GitHub</strong>, and <em>another</em> prompt will come up asking if it's ok to open an external website (GitHub).</p>
<p><a class="glightbox" href="../../assets/images/git_login_external_site.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="VS Code External Site Prompt" src="../../assets/images/git_login_external_site.png" style="width:400px" /></a></p>
<p>Choose <strong>Open</strong> and then an external site (GitHub) will open, asking for your login code.</p>
<p><a class="glightbox" href="../../assets/images/git_login_code_entry.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="GitHub Login Code Entry" src="../../assets/images/git_login_code_entry.png" style="width:400px" /></a></p>
<p>Paste in your login code and choose <strong>Continue</strong>. You will then be prompted to Authorize VS Code.</p>
<p><a class="glightbox" href="../../assets/images/git_login_authorize_vscode.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="GitHub Authorize VS Code" src="../../assets/images/git_login_authorize_vscode.png" style="width:400px" /></a></p>
<p>Choose <strong>Authorize Visual-Studio-Code</strong>, and you should be presented with the coveted Green Check Mark!</p>
<p><a class="glightbox" href="../../assets/images/git_login_complete.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="VS Code Git Login Complete" src="../../assets/images/git_login_complete.png" style="width:400px" /></a></p>
<p>Whew! Alright. Now that we have that complete, let's keep moving...</p>
<h3 id="branching-out"><strong>Branching Out</strong><a class="headerlink" href="#branching-out" title="Permanent link">&para;</a></h3>
<p>Before jumping in and modifying our files, we'll create a branch named <strong>banner-syslog</strong> in our
forked repository to work on our changes. We can create our branch in multiple ways, but we'll use
the <code>git switch</code> command with the <code>-c</code> parameter to create our new branch.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>git<span class="w"> </span>switch<span class="w"> </span>-c<span class="w"> </span>banner-syslog
</code></pre></div>
<p>After entering this command, we should see our new branch name reflected in the terminal. It will also be
reflected in the status bar in the lower left-hand corner of our VS Code window (you may need to click the refresh icon
before this is shown).</p>
<p>Now we're ready to start working on our changes <img alt="ðŸ˜Ž" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f60e.svg" title=":sunglasses:" />.</p>
<h3 id="login-banner"><strong>Login Banner</strong><a class="headerlink" href="#login-banner" title="Permanent link">&para;</a></h3>
<p>When we initially deployed our multi-site topology, we should have included a login banner on all our switches.
Let's take a look at the <strong><a href="https://avd.arista.com/4.10/roles/eos_cli_config_gen/docs/input-variables.html#banners">AVD documentation site</a></strong> to see what the
data model is for this configuration.</p>
<p>The banner on all of our switches will be the same. After reviewing the AVD documentation, we know we can accomplish this by defining the <code>banners</code> input variable
in our <code>global_vars/global_dc_vars.yml</code> file.</p>
<p>Add the code block below to <code>global_vars/global_dc_vars.yml</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="c1"># Login Banner</span>
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="nt">banners</span><span class="p">:</span>
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="w">  </span><span class="nt">motd</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a><span class="w">    </span><span class="no">You shall not pass. Unless you are authorized. Then you shall pass.</span>
<a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a><span class="w">    </span><span class="no">EOF</span>
</code></pre></div>
<details class="danger" open="open">
<summary>Yes, that "EOF" is important!</summary>
<p>Ensure the entire code snippet above is copied; including the <code>EOF</code>. This must be present for the configuration to be
considered valid</p>
</details>
<p>Next, let's build out the configurations and documentation associated with this change.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>make<span class="w"> </span>build-site-1<span class="w"> </span>build-site-2
</code></pre></div>
<p>Please take a minute to review the results of our five lines of YAML. When finished reviewing the changes, let's commit them.</p>
<p>As usual, there are a few ways of doing this, but the CLI commands below will get the job done:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>git<span class="w"> </span>add<span class="w"> </span>.
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;add banner&#39;</span>
</code></pre></div>
<p>So far, so good! Before we publish our branch and create a Pull Request though, we have some more work to do...</p>
<h3 id="syslog-server"><strong>Syslog Server</strong><a class="headerlink" href="#syslog-server" title="Permanent link">&para;</a></h3>
<p>Our next Day 2 change is adding a syslog server configuration to all our switches. Once again, we'll take
a look at the <strong><a href="https://avd.arista.com/4.10/roles/eos_cli_config_gen/docs/input-variables.html#logging">AVD documentation site</a></strong> to see the
data model associated with the <code>logging</code> input variable.</p>
<p>Like our banner operation, the syslog server configuration will be consistent on all our switches. Because of this, we can also put this into
our <code>global_vars/global_dc_vars.yml</code> file.</p>
<p>Add the code block below to <code>global_vars/global_dc_vars.yml</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="c1"># Syslog</span>
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="nt">logging</span><span class="p">:</span>
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="w">  </span><span class="nt">vrfs</span><span class="p">:</span>
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="w">      </span><span class="nt">source_interface</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Management0</span>
<a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a><span class="w">      </span><span class="nt">hosts</span><span class="p">:</span>
<a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.200.0.108</span>
<a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.200.1.108</span>
</code></pre></div>
<p>Finally, let's build out our configurations.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>make<span class="w"> </span>build-site-1<span class="w"> </span>build-site-2
</code></pre></div>
<p>Take a minute, using the source control feature in VS Code, to review what has changed as a result
of our work.</p>
<p>At this point, we have our Banner and Syslog configurations in place. The configurations look good,
and we're ready to share this with our team for review. In other words, <strong>it's time to publish our branch
to the remote origin</strong> (our forked repo on GitHub) and create the Pull Request (PR)!</p>
<p>There are a few ways to publish the <code>banner-syslog</code> branch to our forked repository. The commands below will
accomplish this via the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>git<span class="w"> </span>add<span class="w"> </span>.
<a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;add syslog&#39;</span>
<a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>git<span class="w"> </span>push<span class="w"> </span>--set-upstream<span class="w"> </span>origin<span class="w"> </span>banner-syslog
</code></pre></div>
<p>On our forked repository, let's create the Pull Request.</p>
<p>When creating the PR, ensure that the <code>base repository</code> is the <strong>main</strong> branch of <strong>your fork</strong>. This can
be selected via the dropdown as shown below:</p>
<p><a class="glightbox" href="../../assets/images/pr_open_request.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="PR Base Repository Selection" src="../../assets/images/pr_open_request.png" style="width:800px" /></a></p>
<p>Take a minute to review the contents of the PR. Assuming all looks good, let's earn the <strong>YOLO</strong> GitHub badge
by approving and merging your PR!</p>
<details class="tip" open="open">
<summary>Tip</summary>
<p>Remember to delete the <strong>banner-syslog</strong> branch after performing the merge - Keep that repo clean!</p>
</details>
<p>Once merged, let's switch back to our <code>main</code> branch and pull down our merged changes.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>git<span class="w"> </span>switch<span class="w"> </span>main
<a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>git<span class="w"> </span>pull
</code></pre></div>
<p>Then, let's delete our now defunct <strong>banner-syslog</strong> branch.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>git<span class="w"> </span>branch<span class="w"> </span>-D<span class="w"> </span>banner-syslog
</code></pre></div>
<p>Finally, let's deploy our changes.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>make<span class="w"> </span>deploy-site-1<span class="w"> </span>deploy-site-2
</code></pre></div>
<p>Once completed, we should see our banner when logging into any switch. The output of the <code>show logging</code> command
should also have our newly defined syslog servers.</p>
<h3 id="provisioning-new-switches"><strong>Provisioning new Switches</strong><a class="headerlink" href="#provisioning-new-switches" title="Permanent link">&para;</a></h3>
<p>Our network is gaining popularity, and it's time to add a new Leaf pair into the environment! <strong>s1-leaf5</strong> and <strong>s1-leaf6</strong>
are ready to be provisioned, so let's get to it.</p>
<h4 id="branch-time"><strong>Branch Time</strong><a class="headerlink" href="#branch-time" title="Permanent link">&para;</a></h4>
<p>Before jumping in, let's create a new branch for our work. We'll call this branch <strong>add-leafs</strong>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>git<span class="w"> </span>switch<span class="w"> </span>-c<span class="w"> </span>add-leafs
</code></pre></div>
<p>Now that we have our branch created let's get to work!</p>
<h4 id="inventory-update"><strong>Inventory Update</strong><a class="headerlink" href="#inventory-update" title="Permanent link">&para;</a></h4>
<p>First, we'll want to add our new switches, named <strong>s1-leaf5</strong> and <strong>s1-leaf6</strong>, into our inventory file. We'll add them
as members of the <code>SITE1_LEAFS</code> group.</p>
<p>Add the following two lines under <code>s1-leaf4</code> in <code>sites/site_1/inventory.yml</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="nt">s1-leaf5</span><span class="p">:</span>
<a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="nt">s1-leaf6</span><span class="p">:</span>
</code></pre></div>
<p>The <code>sites/site_1/inventory.yml</code> file should now look like the example below:</p>
<details class="eos-config annotate">
<summary>sites/site_1/inventory.yml</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="nn">---</span>
<a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a><span class="nt">SITE1</span><span class="p">:</span>
<a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a><span class="w">  </span><span class="nt">children</span><span class="p">:</span>
<a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a><span class="w">    </span><span class="nt">CVP</span><span class="p">:</span>
<a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a><span class="w">      </span><span class="nt">hosts</span><span class="p">:</span>
<a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a><span class="w">        </span><span class="nt">cvp</span><span class="p">:</span>
<a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a><span class="w">    </span><span class="nt">SITE1_FABRIC</span><span class="p">:</span>
<a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a><span class="w">      </span><span class="nt">children</span><span class="p">:</span>
<a id="__codelineno-49-9" name="__codelineno-49-9" href="#__codelineno-49-9"></a><span class="w">        </span><span class="nt">SITE1_SPINES</span><span class="p">:</span>
<a id="__codelineno-49-10" name="__codelineno-49-10" href="#__codelineno-49-10"></a><span class="w">          </span><span class="nt">hosts</span><span class="p">:</span>
<a id="__codelineno-49-11" name="__codelineno-49-11" href="#__codelineno-49-11"></a><span class="w">            </span><span class="nt">s1-spine1</span><span class="p">:</span>
<a id="__codelineno-49-12" name="__codelineno-49-12" href="#__codelineno-49-12"></a><span class="w">            </span><span class="nt">s1-spine2</span><span class="p">:</span>
<a id="__codelineno-49-13" name="__codelineno-49-13" href="#__codelineno-49-13"></a><span class="w">        </span><span class="nt">SITE1_LEAFS</span><span class="p">:</span>
<a id="__codelineno-49-14" name="__codelineno-49-14" href="#__codelineno-49-14"></a><span class="w">          </span><span class="nt">hosts</span><span class="p">:</span>
<a id="__codelineno-49-15" name="__codelineno-49-15" href="#__codelineno-49-15"></a><span class="w">            </span><span class="nt">s1-leaf1</span><span class="p">:</span>
<a id="__codelineno-49-16" name="__codelineno-49-16" href="#__codelineno-49-16"></a><span class="w">            </span><span class="nt">s1-leaf2</span><span class="p">:</span>
<a id="__codelineno-49-17" name="__codelineno-49-17" href="#__codelineno-49-17"></a><span class="w">            </span><span class="nt">s1-leaf3</span><span class="p">:</span>
<a id="__codelineno-49-18" name="__codelineno-49-18" href="#__codelineno-49-18"></a><span class="w">            </span><span class="nt">s1-leaf4</span><span class="p">:</span>
<a id="__codelineno-49-19" name="__codelineno-49-19" href="#__codelineno-49-19"></a><span class="hll"><span class="w">            </span><span class="nt">s1-leaf5</span><span class="p">:</span>
</span><a id="__codelineno-49-20" name="__codelineno-49-20" href="#__codelineno-49-20"></a><span class="hll"><span class="w">            </span><span class="nt">s1-leaf6</span><span class="p">:</span>
</span><a id="__codelineno-49-21" name="__codelineno-49-21" href="#__codelineno-49-21"></a><span class="w">    </span><span class="nt">SITE1_FABRIC_SERVICES</span><span class="p">:</span>
<a id="__codelineno-49-22" name="__codelineno-49-22" href="#__codelineno-49-22"></a><span class="w">      </span><span class="nt">children</span><span class="p">:</span>
<a id="__codelineno-49-23" name="__codelineno-49-23" href="#__codelineno-49-23"></a><span class="w">        </span><span class="nt">SITE1_SPINES</span><span class="p">:</span>
<a id="__codelineno-49-24" name="__codelineno-49-24" href="#__codelineno-49-24"></a><span class="w">        </span><span class="nt">SITE1_LEAFS</span><span class="p">:</span>
<a id="__codelineno-49-25" name="__codelineno-49-25" href="#__codelineno-49-25"></a><span class="w">    </span><span class="nt">SITE1_FABRIC_PORTS</span><span class="p">:</span>
<a id="__codelineno-49-26" name="__codelineno-49-26" href="#__codelineno-49-26"></a><span class="w">      </span><span class="nt">children</span><span class="p">:</span>
<a id="__codelineno-49-27" name="__codelineno-49-27" href="#__codelineno-49-27"></a><span class="w">        </span><span class="nt">SITE1_SPINES</span><span class="p">:</span>
<a id="__codelineno-49-28" name="__codelineno-49-28" href="#__codelineno-49-28"></a><span class="w">        </span><span class="nt">SITE1_LEAFS</span><span class="p">:</span>
</code></pre></div>
</details>
<p>Next, let's add our new Leaf switches into <code>sites/site_1/group_vars/SITE1_FABRIC.yml</code>.</p>
<p>These new switches will go into <strong>RACK3</strong>, leverage MLAG for multi-homing, and will have locally
connected endpoints in VLANs <code>10</code> and <code>20</code>.</p>
<p>Just like the other Leaf switches, interfaces <code>Ethernet2</code> and <code>Ethernet3</code> will be used to connect
to the spines.</p>
<p>On the spines, interface <code>Ethernet9</code> will be used to connect to s1-leaf5, while <code>Ethernet10</code>
will be used to connect to s1-leaf6.</p>
<p>Starting at line 69, add the following code block into <code>sites/site_1/group_vars/SITE1_FABRIC.yml</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RACK3</span>
<a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="w">  </span><span class="nt">nodes</span><span class="p">:</span>
<a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-leaf5</span>
<a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a><span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a><span class="w">      </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.28/24</span>
<a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a><span class="w">      </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet9</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet9</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-leaf6</span>
<a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a><span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6</span>
<a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a><span class="w">      </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.29/24</span>
<a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a><span class="w">      </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet10</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet10</span><span class="w"> </span><span class="p p-Indicator">]</span>
</code></pre></div>
<details class="warning" open="open">
<summary>Warning</summary>
<p>Make sure the indentation of <code>RACK3</code> is the same as <code>RACK2</code>, which can be found on line 57</p>
</details>
<p>The <code>sites/site_1/group_vars/SITE1_FABRIC.yml</code> file should now look like the example below:</p>
<details class="eos-config annotate">
<summary>sites/site_1/group_vars/SITE1_FABRIC.yml</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="nn">---</span>
<a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a><span class="nt">fabric_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SITE1_FABRIC</span>
<a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a>
<a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a><span class="c1"># Set Design Type to L2ls</span>
<a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a><span class="nt">design</span><span class="p">:</span>
<a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">l2ls</span>
<a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a>
<a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a><span class="c1"># Spine Switches</span>
<a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a><span class="nt">l3spine</span><span class="p">:</span>
<a id="__codelineno-51-10" name="__codelineno-51-10" href="#__codelineno-51-10"></a><span class="w">  </span><span class="nt">defaults</span><span class="p">:</span>
<a id="__codelineno-51-11" name="__codelineno-51-11" href="#__codelineno-51-11"></a><span class="w">    </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cEOS</span>
<a id="__codelineno-51-12" name="__codelineno-51-12" href="#__codelineno-51-12"></a><span class="w">    </span><span class="nt">spanning_tree_mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mstp</span>
<a id="__codelineno-51-13" name="__codelineno-51-13" href="#__codelineno-51-13"></a><span class="w">    </span><span class="nt">spanning_tree_priority</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4096</span>
<a id="__codelineno-51-14" name="__codelineno-51-14" href="#__codelineno-51-14"></a><span class="w">    </span><span class="nt">loopback_ipv4_pool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.1.252.0/24</span>
<a id="__codelineno-51-15" name="__codelineno-51-15" href="#__codelineno-51-15"></a><span class="w">    </span><span class="nt">mlag_peer_ipv4_pool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.1.253.0/24</span>
<a id="__codelineno-51-16" name="__codelineno-51-16" href="#__codelineno-51-16"></a><span class="w">    </span><span class="nt">mlag_peer_l3_ipv4_pool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.1.254.0/24</span>
<a id="__codelineno-51-17" name="__codelineno-51-17" href="#__codelineno-51-17"></a><span class="w">    </span><span class="nt">virtual_router_mac_address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">00:1c:73:00:dc:01</span>
<a id="__codelineno-51-18" name="__codelineno-51-18" href="#__codelineno-51-18"></a><span class="w">    </span><span class="nt">mlag_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet6</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-19" name="__codelineno-51-19" href="#__codelineno-51-19"></a><span class="w">  </span><span class="nt">node_groups</span><span class="p">:</span>
<a id="__codelineno-51-20" name="__codelineno-51-20" href="#__codelineno-51-20"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SPINES</span>
<a id="__codelineno-51-21" name="__codelineno-51-21" href="#__codelineno-51-21"></a><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span>
<a id="__codelineno-51-22" name="__codelineno-51-22" href="#__codelineno-51-22"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-spine1</span>
<a id="__codelineno-51-23" name="__codelineno-51-23" href="#__codelineno-51-23"></a><span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<a id="__codelineno-51-24" name="__codelineno-51-24" href="#__codelineno-51-24"></a><span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.10/24</span>
<a id="__codelineno-51-25" name="__codelineno-51-25" href="#__codelineno-51-25"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-spine2</span>
<a id="__codelineno-51-26" name="__codelineno-51-26" href="#__codelineno-51-26"></a><span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<a id="__codelineno-51-27" name="__codelineno-51-27" href="#__codelineno-51-27"></a><span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.11/24</span>
<a id="__codelineno-51-28" name="__codelineno-51-28" href="#__codelineno-51-28"></a>
<a id="__codelineno-51-29" name="__codelineno-51-29" href="#__codelineno-51-29"></a><span class="c1"># Leaf Switches</span>
<a id="__codelineno-51-30" name="__codelineno-51-30" href="#__codelineno-51-30"></a><span class="nt">leaf</span><span class="p">:</span>
<a id="__codelineno-51-31" name="__codelineno-51-31" href="#__codelineno-51-31"></a><span class="w">  </span><span class="nt">defaults</span><span class="p">:</span>
<a id="__codelineno-51-32" name="__codelineno-51-32" href="#__codelineno-51-32"></a><span class="w">    </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cEOS</span>
<a id="__codelineno-51-33" name="__codelineno-51-33" href="#__codelineno-51-33"></a><span class="w">    </span><span class="nt">mlag_peer_ipv4_pool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.1.253.0/24</span>
<a id="__codelineno-51-34" name="__codelineno-51-34" href="#__codelineno-51-34"></a><span class="w">    </span><span class="nt">spanning_tree_mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mstp</span>
<a id="__codelineno-51-35" name="__codelineno-51-35" href="#__codelineno-51-35"></a><span class="w">    </span><span class="nt">spanning_tree_priority</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16384</span>
<a id="__codelineno-51-36" name="__codelineno-51-36" href="#__codelineno-51-36"></a><span class="w">    </span><span class="nt">uplink_switches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">s1-spine1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">s1-spine2</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-37" name="__codelineno-51-37" href="#__codelineno-51-37"></a><span class="w">    </span><span class="nt">uplink_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet3</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-38" name="__codelineno-51-38" href="#__codelineno-51-38"></a><span class="w">    </span><span class="nt">mlag_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet6</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-39" name="__codelineno-51-39" href="#__codelineno-51-39"></a><span class="w">  </span><span class="nt">node_groups</span><span class="p">:</span>
<a id="__codelineno-51-40" name="__codelineno-51-40" href="#__codelineno-51-40"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RACK1</span>
<a id="__codelineno-51-41" name="__codelineno-51-41" href="#__codelineno-51-41"></a><span class="w">      </span><span class="nt">filter</span><span class="p">:</span>
<a id="__codelineno-51-42" name="__codelineno-51-42" href="#__codelineno-51-42"></a><span class="w">        </span><span class="nt">tags</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="s">&quot;Web&quot;</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-43" name="__codelineno-51-43" href="#__codelineno-51-43"></a><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span>
<a id="__codelineno-51-44" name="__codelineno-51-44" href="#__codelineno-51-44"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-leaf1</span>
<a id="__codelineno-51-45" name="__codelineno-51-45" href="#__codelineno-51-45"></a><span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<a id="__codelineno-51-46" name="__codelineno-51-46" href="#__codelineno-51-46"></a><span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.12/24</span>
<a id="__codelineno-51-47" name="__codelineno-51-47" href="#__codelineno-51-47"></a><span class="w">          </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-48" name="__codelineno-51-48" href="#__codelineno-51-48"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-leaf2</span>
<a id="__codelineno-51-49" name="__codelineno-51-49" href="#__codelineno-51-49"></a><span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<a id="__codelineno-51-50" name="__codelineno-51-50" href="#__codelineno-51-50"></a><span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.13/24</span>
<a id="__codelineno-51-51" name="__codelineno-51-51" href="#__codelineno-51-51"></a><span class="w">          </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet3</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-52" name="__codelineno-51-52" href="#__codelineno-51-52"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RACK2</span>
<a id="__codelineno-51-53" name="__codelineno-51-53" href="#__codelineno-51-53"></a><span class="w">      </span><span class="nt">filter</span><span class="p">:</span>
<a id="__codelineno-51-54" name="__codelineno-51-54" href="#__codelineno-51-54"></a><span class="w">        </span><span class="nt">tags</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="s">&quot;App&quot;</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-55" name="__codelineno-51-55" href="#__codelineno-51-55"></a><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span>
<a id="__codelineno-51-56" name="__codelineno-51-56" href="#__codelineno-51-56"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-leaf3</span>
<a id="__codelineno-51-57" name="__codelineno-51-57" href="#__codelineno-51-57"></a><span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<a id="__codelineno-51-58" name="__codelineno-51-58" href="#__codelineno-51-58"></a><span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.14/24</span>
<a id="__codelineno-51-59" name="__codelineno-51-59" href="#__codelineno-51-59"></a><span class="w">          </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet4</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet4</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-60" name="__codelineno-51-60" href="#__codelineno-51-60"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-leaf4</span>
<a id="__codelineno-51-61" name="__codelineno-51-61" href="#__codelineno-51-61"></a><span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<a id="__codelineno-51-62" name="__codelineno-51-62" href="#__codelineno-51-62"></a><span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.15/24</span>
<a id="__codelineno-51-63" name="__codelineno-51-63" href="#__codelineno-51-63"></a><span class="w">          </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet5</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet5</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-64" name="__codelineno-51-64" href="#__codelineno-51-64"></a><span class="hll"><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RACK3</span>
</span><a id="__codelineno-51-65" name="__codelineno-51-65" href="#__codelineno-51-65"></a><span class="hll"><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span>
</span><a id="__codelineno-51-66" name="__codelineno-51-66" href="#__codelineno-51-66"></a><span class="hll"><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-leaf5</span>
</span><a id="__codelineno-51-67" name="__codelineno-51-67" href="#__codelineno-51-67"></a><span class="hll"><span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</span><a id="__codelineno-51-68" name="__codelineno-51-68" href="#__codelineno-51-68"></a><span class="hll"><span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.28/24</span>
</span><a id="__codelineno-51-69" name="__codelineno-51-69" href="#__codelineno-51-69"></a><span class="hll"><span class="w">          </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet9</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet9</span><span class="w"> </span><span class="p p-Indicator">]</span>
</span><a id="__codelineno-51-70" name="__codelineno-51-70" href="#__codelineno-51-70"></a><span class="hll"><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s1-leaf6</span>
</span><a id="__codelineno-51-71" name="__codelineno-51-71" href="#__codelineno-51-71"></a><span class="hll"><span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6</span>
</span><a id="__codelineno-51-72" name="__codelineno-51-72" href="#__codelineno-51-72"></a><span class="hll"><span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.29/24</span>
</span><a id="__codelineno-51-73" name="__codelineno-51-73" href="#__codelineno-51-73"></a><span class="hll"><span class="w">          </span><span class="nt">uplink_switch_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet10</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet10</span><span class="w"> </span><span class="p p-Indicator">]</span>
</span><a id="__codelineno-51-74" name="__codelineno-51-74" href="#__codelineno-51-74"></a>
<a id="__codelineno-51-75" name="__codelineno-51-75" href="#__codelineno-51-75"></a>
<a id="__codelineno-51-76" name="__codelineno-51-76" href="#__codelineno-51-76"></a><span class="c1">##################################################################</span>
<a id="__codelineno-51-77" name="__codelineno-51-77" href="#__codelineno-51-77"></a><span class="c1"># Underlay Routing Protocol - ran on Spines</span>
<a id="__codelineno-51-78" name="__codelineno-51-78" href="#__codelineno-51-78"></a><span class="c1">##################################################################</span>
<a id="__codelineno-51-79" name="__codelineno-51-79" href="#__codelineno-51-79"></a>
<a id="__codelineno-51-80" name="__codelineno-51-80" href="#__codelineno-51-80"></a><span class="nt">underlay_routing_protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">OSPF</span>
<a id="__codelineno-51-81" name="__codelineno-51-81" href="#__codelineno-51-81"></a>
<a id="__codelineno-51-82" name="__codelineno-51-82" href="#__codelineno-51-82"></a><span class="c1">##################################################################</span>
<a id="__codelineno-51-83" name="__codelineno-51-83" href="#__codelineno-51-83"></a><span class="c1"># WAN/Core Edge Links</span>
<a id="__codelineno-51-84" name="__codelineno-51-84" href="#__codelineno-51-84"></a><span class="c1">##################################################################</span>
<a id="__codelineno-51-85" name="__codelineno-51-85" href="#__codelineno-51-85"></a>
<a id="__codelineno-51-86" name="__codelineno-51-86" href="#__codelineno-51-86"></a><span class="nt">core_interfaces</span><span class="p">:</span>
<a id="__codelineno-51-87" name="__codelineno-51-87" href="#__codelineno-51-87"></a><span class="w">  </span><span class="nt">p2p_links</span><span class="p">:</span>
<a id="__codelineno-51-88" name="__codelineno-51-88" href="#__codelineno-51-88"></a>
<a id="__codelineno-51-89" name="__codelineno-51-89" href="#__codelineno-51-89"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">10.0.0.29/31</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10.0.0.28/31</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-90" name="__codelineno-51-90" href="#__codelineno-51-90"></a><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">s1-spine1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">WANCORE</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-91" name="__codelineno-51-91" href="#__codelineno-51-91"></a><span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet7</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-92" name="__codelineno-51-92" href="#__codelineno-51-92"></a><span class="w">      </span><span class="nt">include_in_underlay_protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-51-93" name="__codelineno-51-93" href="#__codelineno-51-93"></a>
<a id="__codelineno-51-94" name="__codelineno-51-94" href="#__codelineno-51-94"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">10.0.0.33/31</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10.0.0.32/31</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-95" name="__codelineno-51-95" href="#__codelineno-51-95"></a><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">s1-spine1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">WANCORE</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-96" name="__codelineno-51-96" href="#__codelineno-51-96"></a><span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-97" name="__codelineno-51-97" href="#__codelineno-51-97"></a><span class="w">      </span><span class="nt">include_in_underlay_protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-51-98" name="__codelineno-51-98" href="#__codelineno-51-98"></a>
<a id="__codelineno-51-99" name="__codelineno-51-99" href="#__codelineno-51-99"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">10.0.0.31/31</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10.0.0.30/31</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-100" name="__codelineno-51-100" href="#__codelineno-51-100"></a><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">s1-spine2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">WANCORE</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-101" name="__codelineno-51-101" href="#__codelineno-51-101"></a><span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet7</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-102" name="__codelineno-51-102" href="#__codelineno-51-102"></a><span class="w">      </span><span class="nt">include_in_underlay_protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-51-103" name="__codelineno-51-103" href="#__codelineno-51-103"></a>
<a id="__codelineno-51-104" name="__codelineno-51-104" href="#__codelineno-51-104"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">10.0.0.35/31</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10.0.0.34/31</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-105" name="__codelineno-51-105" href="#__codelineno-51-105"></a><span class="w">      </span><span class="nt">nodes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">s1-spine2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">WANCORE</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-106" name="__codelineno-51-106" href="#__codelineno-51-106"></a><span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-51-107" name="__codelineno-51-107" href="#__codelineno-51-107"></a><span class="w">      </span><span class="nt">include_in_underlay_protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</details>
<details class="tip" open="open">
<summary>Tip</summary>
<p>Notice how we did not specify a <code>filter</code> or <code>tags</code> under <code>RACK3</code>. If the <code>filter</code>
parameter is not defined, all VLANs/SVIs/VRFs will be provisioned on the switch.
In our case, this means that VLANs <code>10</code> and <code>20</code> will both be created on our new
Leaf switches. However, since they are <code>leaf</code> node types, no SVIs will be created.</p>
</details>
<p>Next - Let's build the configuration!</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>make<span class="w"> </span>build-site-1
</code></pre></div>
<details class="danger" open="open">
<summary>Important</summary>
<p>Interfaces <code>Ethernet9</code> and <code>Ethernet10</code> do not exist on the Spines. Because of this, we
will <strong>not</strong> run a deploy command since it would fail.</p>
</details>
<p>Please take a moment and review the results of our changes via the source control functionality in VS Code.</p>
<p>Finally, we'll commit our changes and publish our branch. Again, we can use the VS Code Source Control GUI for this,
or via the CLI using the commands below:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a>git<span class="w"> </span>add<span class="w"> </span>.
<a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;add leafs&#39;</span>
<a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a>git<span class="w"> </span>push<span class="w"> </span>--set-upstream<span class="w"> </span>origin<span class="w"> </span>add-leafs
</code></pre></div>
<h2 id="step-7-backing-out-changes"><strong>Step 7 - Backing out changes</strong><a class="headerlink" href="#step-7-backing-out-changes" title="Permanent link">&para;</a></h2>
<p>Ruh Roh. As it turns out, we should have added these leaf switches to an entirely new site. Oops! No worries, because
we used our <strong>add-leafs</strong> branch, we can switch back to our main branch and then delete our local copy of the <strong>add-leafs</strong>
branch. No harm or confusion related to this change ever hit the main branch!</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>git<span class="w"> </span>switch<span class="w"> </span>main
<a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a>git<span class="w"> </span>branch<span class="w"> </span>-D<span class="w"> </span>add-leafs
</code></pre></div>
<p>Finally, we can go out to our forked copy of the repository and delete the <strong>add-leafs</strong> branch.</p>
<p>All set!</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    2024-09-27
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Arista Networks
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs Insiders
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/aristanetworks/avd-workshops" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/AristaNetworks" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.arista.com" target="_blank" rel="noopener" title="www.arista.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M352 256c0 22.2-1.2 43.6-3.3 64H163.4c-2.2-20.4-3.3-41.8-3.3-64s1.2-43.6 3.3-64h185.3c2.2 20.4 3.3 41.8 3.3 64m28.8-64h123.1c5.3 20.5 8.1 41.9 8.1 64s-2.8 43.5-8.1 64H380.8c2.1-20.6 3.2-42 3.2-64s-1.1-43.4-3.2-64m112.6-32H376.7c-10-63.9-29.8-117.4-55.3-151.6 78.3 20.7 142 77.5 171.9 151.6zm-149.1 0H167.7c6.1-36.4 15.5-68.6 27-94.7 10.5-23.6 22.2-40.7 33.5-51.5C239.4 3.2 248.7 0 256 0s16.6 3.2 27.8 13.8c11.3 10.8 23 27.9 33.5 51.5 11.6 26 20.9 58.2 27 94.7m-209 0H18.6c30-74.1 93.6-130.9 172-151.6-25.5 34.2-45.3 87.7-55.3 151.6M8.1 192h123.1c-2.1 20.6-3.2 42-3.2 64s1.1 43.4 3.2 64H8.1C2.8 299.5 0 278.1 0 256s2.8-43.5 8.1-64m186.6 254.6c-11.6-26-20.9-58.2-27-94.6h176.6c-6.1 36.4-15.5 68.6-27 94.6-10.5 23.6-22.2 40.7-33.5 51.5-11.2 10.7-20.5 13.9-27.8 13.9s-16.6-3.2-27.8-13.8c-11.3-10.8-23-27.9-33.5-51.5zM135.3 352c10 63.9 29.8 117.4 55.3 151.6-78.4-20.7-142-77.5-172-151.6zm358.1 0c-30 74.1-93.6 130.9-171.9 151.6 25.5-34.2 45.2-87.7 55.3-151.6h116.7z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "content.code.annotate", "content.code.copy", "content.tooltips", "header.autohide", "navigation.top", "navigation.tracking"], "search": "../../assets/javascripts/workers/search.c7c1ca2c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c4a99efa.min.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../../stylesheets/tables.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>